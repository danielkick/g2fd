<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.1.251">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>g2fd - Setup</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1.6em;
  vertical-align: middle;
}
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit"
  }
}</script>


<link rel="stylesheet" href="styles.css">
<meta property="og:title" content="g2fd - Setup">
<meta property="og:description" content="Goal: allow for reuse of methods on like data (e.g.&nbsp;metadata) while enabling year specific methods or data types. To accomplish this, each data type gets a class subclassed from the data_obj class.">
<meta property="og:site-name" content="g2fd">
<meta name="twitter:title" content="g2fd - Setup">
<meta name="twitter:description" content="Goal: allow for reuse of methods on like data (e.g.&nbsp;metadata) while enabling year specific methods or data types. To accomplish this, each data type gets a class subclassed from the data_obj class.">
<meta name="twitter:card" content="summary">
</head>

<body class="nav-sidebar floating nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg navbar-dark ">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container">
    <a class="navbar-brand" href="./index.html">
    <span class="navbar-title">g2fd</span>
    </a>
  </div>
          <div id="quarto-search" class="" title="Search"></div>
      </div> <!-- /container-fluid -->
    </nav>
  <nav class="quarto-secondary-nav" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
    <div class="container-fluid d-flex justify-content-between">
      <h1 class="quarto-secondary-nav-title">Setup</h1>
      <button type="button" class="quarto-btn-toggle btn" aria-label="Show secondary navigation">
        <i class="bi bi-chevron-right"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse sidebar-navigation floating overflow-auto">
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">g2fd</a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./core.html" class="sidebar-item-text sidebar-link"><code>g2fd</code> is the fast and easy way to access Genomes to Fields data.</a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./01_mk_settings_documents.html" class="sidebar-item-text sidebar-link">01_mk_settings_documents.html</a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./freshstart_0000.html" class="sidebar-item-text sidebar-link">Process Data from 2021 into a consistent format.</a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./freshstart_2020.html" class="sidebar-item-text sidebar-link">Process Data from 2020 into a consistent format.</a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./freshstart_2021.html" class="sidebar-item-text sidebar-link">Process Data from 2021 into a consistent format.</a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./standardize_deprecated.html" class="sidebar-item-text sidebar-link active">Setup</a>
  </div>
</li>
    </ul>
    </div>
</nav>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#custom-functions" id="toc-custom-functions" class="nav-link active" data-scroll-target="#custom-functions">Custom Functions</a></li>
  <li><a href="#remove-output-files" id="toc-remove-output-files" class="nav-link" data-scroll-target="#remove-output-files">Remove output files</a></li>
  <li><a href="#clean-up-logs-intermediate-files" id="toc-clean-up-logs-intermediate-files" class="nav-link" data-scroll-target="#clean-up-logs-intermediate-files">Clean up logs &amp; intermediate files</a></li>
  <li><a href="#data-objects" id="toc-data-objects" class="nav-link" data-scroll-target="#data-objects">Data Objects</a></li>
  <li><a href="#class-for-each-year." id="toc-class-for-each-year." class="nav-link" data-scroll-target="#class-for-each-year.">Class for each year.</a></li>
  <li><a href="#prep-year-by-year" id="toc-prep-year-by-year" class="nav-link" data-scroll-target="#prep-year-by-year">Prep year by year</a></li>
  <li><a href="#prepare-and-write-minimally-altered-g2f-database" id="toc-prepare-and-write-minimally-altered-g2f-database" class="nav-link" data-scroll-target="#prepare-and-write-minimally-altered-g2f-database">Prepare and write minimally altered G2F database</a></li>
  </ul>
<div class="toc-actions"><div><i class="bi bi-github"></i></div><div class="action-links"><p><a href="https://github.com/danielkick/g2fd/issues/new" class="toc-action">Report an issue</a></p></div></div></nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title d-none d-lg-block">Setup</h1>
</div>



<div class="quarto-title-meta">

    
    
  </div>
  

</header>

<!-- WARNING: THIS FILE WAS AUTOGENERATED! DO NOT EDIT! -->
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Imports ----</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> re</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np <span class="co"># for np.nan</span></span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a>pd.set_option(<span class="st">'display.max_columns'</span>, <span class="va">None</span>)</span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a><span class="co"># import os   # for write_log, delete_logs</span></span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> glob <span class="co"># for delete_all_logs</span></span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> datetime <span class="im">import</span> date, timedelta</span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> json <span class="co"># for saving a dict to txt with json.dumps</span></span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pickle</span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true" tabindex="-1"></a><span class="co"># import matplotlib as mpl</span></span>
<span id="cb1-14"><a href="#cb1-14" aria-hidden="true" tabindex="-1"></a><span class="co"># import matplotlib.pyplot as plt</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Settings ----</span></span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a><span class="co"># remakeDaymet = False</span></span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a><span class="co"># remakeDaymet = True</span></span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a><span class="co"># findBestWeatherModels = False#True </span></span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a><span class="co"># findBestWeatherModels = True</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a>log_path <span class="op">=</span> <span class="st">'./data/logs/'</span> <span class="co"># '../data/external/'</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<section id="custom-functions" class="level2">
<h2 class="anchored" data-anchor-id="custom-functions">Custom Functions</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="co"># def add_SiteYear(df):</span></span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a><span class="co">#     df['SiteYear'] = df['ExperimentCode'].astype(str) + '_' + df['Year'].astype(str)</span></span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a><span class="co">#     return(df)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="co"># metadata, 'Metadata', colGroupings</span></span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> check_col_types(data, grouping, colGroupings</span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a>):</span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a><span class="co">#     data = metadata</span></span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a><span class="co">#     grouping = 'Metadata'</span></span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a><span class="co">#     colGroupings = pd.read_csv('../data/external/UpdateColGroupings.csv')</span></span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-8"><a href="#cb5-8" aria-hidden="true" tabindex="-1"></a>    considerCols <span class="op">=</span> colGroupings.loc[colGroupings[grouping].notna(), (grouping, grouping<span class="op">+</span><span class="st">'Type'</span>)]</span>
<span id="cb5-9"><a href="#cb5-9" aria-hidden="true" tabindex="-1"></a>    considerCols<span class="op">=</span> considerCols.reset_index().drop(columns <span class="op">=</span> <span class="st">'index'</span>)</span>
<span id="cb5-10"><a href="#cb5-10" aria-hidden="true" tabindex="-1"></a>    changeMessages <span class="op">=</span> []</span>
<span id="cb5-11"><a href="#cb5-11" aria-hidden="true" tabindex="-1"></a>    issueMessages  <span class="op">=</span> []</span>
<span id="cb5-12"><a href="#cb5-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-13"><a href="#cb5-13" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(considerCols.shape[<span class="dv">0</span>]):</span>
<span id="cb5-14"><a href="#cb5-14" aria-hidden="true" tabindex="-1"></a>        considerCol <span class="op">=</span> considerCols.loc[i, grouping]</span>
<span id="cb5-15"><a href="#cb5-15" aria-hidden="true" tabindex="-1"></a>        considerColType <span class="op">=</span> considerCols.loc[i, grouping<span class="op">+</span><span class="st">'Type'</span>]</span>
<span id="cb5-16"><a href="#cb5-16" aria-hidden="true" tabindex="-1"></a>        <span class="co"># print(i, considerCol, considerColType)</span></span>
<span id="cb5-17"><a href="#cb5-17" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb5-18"><a href="#cb5-18" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> considerCol <span class="kw">in</span> <span class="bu">list</span>(data):</span>
<span id="cb5-19"><a href="#cb5-19" aria-hidden="true" tabindex="-1"></a>            <span class="co"># handle nans, datetime</span></span>
<span id="cb5-20"><a href="#cb5-20" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> <span class="kw">not</span> pd.isna(considerColType):</span>
<span id="cb5-21"><a href="#cb5-21" aria-hidden="true" tabindex="-1"></a>                <span class="cf">try</span>:</span>
<span id="cb5-22"><a href="#cb5-22" aria-hidden="true" tabindex="-1"></a>                    <span class="cf">if</span> considerColType <span class="op">==</span> <span class="st">'datetime'</span>:</span>
<span id="cb5-23"><a href="#cb5-23" aria-hidden="true" tabindex="-1"></a>                        data[considerCol]<span class="op">=</span> pd.to_datetime(data[considerCol])</span>
<span id="cb5-24"><a href="#cb5-24" aria-hidden="true" tabindex="-1"></a>                    <span class="cf">else</span>:</span>
<span id="cb5-25"><a href="#cb5-25" aria-hidden="true" tabindex="-1"></a>                        data[considerCol]<span class="op">=</span> data[considerCol].astype(considerColType)</span>
<span id="cb5-26"><a href="#cb5-26" aria-hidden="true" tabindex="-1"></a>                    changeMessage <span class="op">=</span> (considerCol<span class="op">+</span><span class="st">' -&gt; type '</span><span class="op">+</span>considerColType<span class="op">+</span><span class="st">''</span>)</span>
<span id="cb5-27"><a href="#cb5-27" aria-hidden="true" tabindex="-1"></a>                    changeMessages <span class="op">=</span> changeMessages <span class="op">+</span> [changeMessage]</span>
<span id="cb5-28"><a href="#cb5-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-29"><a href="#cb5-29" aria-hidden="true" tabindex="-1"></a>                <span class="cf">except</span> (<span class="pp">ValueError</span>, <span class="pp">TypeError</span>):</span>
<span id="cb5-30"><a href="#cb5-30" aria-hidden="true" tabindex="-1"></a>                    data[considerCol]<span class="op">=</span> data[considerCol].astype(<span class="st">'string'</span>)</span>
<span id="cb5-31"><a href="#cb5-31" aria-hidden="true" tabindex="-1"></a>                    issueMessage <span class="op">=</span> (<span class="st">'Returned as string. '</span><span class="op">+</span>considerCol<span class="op">+</span><span class="st">' could not be converted to '</span><span class="op">+</span>considerColType)</span>
<span id="cb5-32"><a href="#cb5-32" aria-hidden="true" tabindex="-1"></a>                    issueMessages <span class="op">=</span> issueMessages <span class="op">+</span> [issueMessage]</span>
<span id="cb5-33"><a href="#cb5-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-34"><a href="#cb5-34" aria-hidden="true" tabindex="-1"></a>            <span class="cf">else</span>: <span class="co"># i.e. if type == na</span></span>
<span id="cb5-35"><a href="#cb5-35" aria-hidden="true" tabindex="-1"></a>                data[considerCol]<span class="op">=</span> data[considerCol].astype(<span class="st">'string'</span>)</span>
<span id="cb5-36"><a href="#cb5-36" aria-hidden="true" tabindex="-1"></a>                issueMessage <span class="op">=</span> (considerCol<span class="op">+</span><span class="st">' has no type specified (na). Returned as string.'</span>)</span>
<span id="cb5-37"><a href="#cb5-37" aria-hidden="true" tabindex="-1"></a>                issueMessages <span class="op">=</span> issueMessages <span class="op">+</span> [issueMessage]</span>
<span id="cb5-38"><a href="#cb5-38" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-39"><a href="#cb5-39" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span>(data, changeMessages, issueMessages)</span>
<span id="cb5-40"><a href="#cb5-40" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-41"><a href="#cb5-41" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-42"><a href="#cb5-42" aria-hidden="true" tabindex="-1"></a><span class="co"># 'metadata2018', colGroupings</span></span>
<span id="cb5-43"><a href="#cb5-43" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> check_col_types_all_groupings(</span>
<span id="cb5-44"><a href="#cb5-44" aria-hidden="true" tabindex="-1"></a>    dfNameStr, </span>
<span id="cb5-45"><a href="#cb5-45" aria-hidden="true" tabindex="-1"></a>    colGroupings</span>
<span id="cb5-46"><a href="#cb5-46" aria-hidden="true" tabindex="-1"></a>):</span>
<span id="cb5-47"><a href="#cb5-47" aria-hidden="true" tabindex="-1"></a>    reTypedColumns <span class="op">=</span> {</span>
<span id="cb5-48"><a href="#cb5-48" aria-hidden="true" tabindex="-1"></a>        <span class="st">'Metadata'</span>: [], </span>
<span id="cb5-49"><a href="#cb5-49" aria-hidden="true" tabindex="-1"></a>        <span class="st">'Soil'</span>: [],</span>
<span id="cb5-50"><a href="#cb5-50" aria-hidden="true" tabindex="-1"></a>        <span class="st">'Phenotype'</span>: [],</span>
<span id="cb5-51"><a href="#cb5-51" aria-hidden="true" tabindex="-1"></a>        <span class="st">'Genotype'</span>: [],</span>
<span id="cb5-52"><a href="#cb5-52" aria-hidden="true" tabindex="-1"></a>        <span class="st">'Management'</span>: [],</span>
<span id="cb5-53"><a href="#cb5-53" aria-hidden="true" tabindex="-1"></a>        <span class="st">'Weather'</span>: []</span>
<span id="cb5-54"><a href="#cb5-54" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb5-55"><a href="#cb5-55" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-56"><a href="#cb5-56" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> grouping <span class="kw">in</span> reTypedColumns.keys(): <span class="co">#['Metadata', 'Soil', 'Phenotype', 'Genotype', 'Management', 'Weather']:</span></span>
<span id="cb5-57"><a href="#cb5-57" aria-hidden="true" tabindex="-1"></a>    <span class="co">#     print(grouping)</span></span>
<span id="cb5-58"><a href="#cb5-58" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-59"><a href="#cb5-59" aria-hidden="true" tabindex="-1"></a>        outputList <span class="op">=</span> check_col_types(data <span class="op">=</span> <span class="bu">eval</span>(dfNameStr), grouping <span class="op">=</span> grouping, colGroupings <span class="op">=</span> colGroupings)</span>
<span id="cb5-60"><a href="#cb5-60" aria-hidden="true" tabindex="-1"></a>    <span class="co">#     updatedDf = outputList[0]</span></span>
<span id="cb5-61"><a href="#cb5-61" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-62"><a href="#cb5-62" aria-hidden="true" tabindex="-1"></a>        reTypedColumns[grouping] <span class="op">=</span> outputList[<span class="dv">0</span>]</span>
<span id="cb5-63"><a href="#cb5-63" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-64"><a href="#cb5-64" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> outputList[<span class="dv">1</span>] <span class="op">!=</span> []:</span>
<span id="cb5-65"><a href="#cb5-65" aria-hidden="true" tabindex="-1"></a>            write_log(pathString<span class="op">=</span> <span class="st">'../data/external/'</span><span class="op">+</span><span class="st">'log_'</span><span class="op">+</span>dfNameStr<span class="op">+</span><span class="st">'_changes.txt'</span>, </span>
<span id="cb5-66"><a href="#cb5-66" aria-hidden="true" tabindex="-1"></a>                      message <span class="op">=</span> (grouping<span class="op">+</span><span class="st">' ========'</span>).encode())</span>
<span id="cb5-67"><a href="#cb5-67" aria-hidden="true" tabindex="-1"></a>            <span class="cf">for</span> change <span class="kw">in</span> outputList[<span class="dv">1</span>]:</span>
<span id="cb5-68"><a href="#cb5-68" aria-hidden="true" tabindex="-1"></a>                write_log(pathString<span class="op">=</span> <span class="st">'../data/external/'</span><span class="op">+</span><span class="st">'log_'</span><span class="op">+</span>dfNameStr<span class="op">+</span><span class="st">'_changes.txt'</span>, </span>
<span id="cb5-69"><a href="#cb5-69" aria-hidden="true" tabindex="-1"></a>                          message <span class="op">=</span> change.encode())</span>
<span id="cb5-70"><a href="#cb5-70" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-71"><a href="#cb5-71" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> outputList[<span class="dv">2</span>] <span class="op">!=</span> []:</span>
<span id="cb5-72"><a href="#cb5-72" aria-hidden="true" tabindex="-1"></a>            write_log(pathString<span class="op">=</span> <span class="st">'../data/external/'</span><span class="op">+</span><span class="st">'log_'</span><span class="op">+</span>dfNameStr<span class="op">+</span><span class="st">'_issues.txt'</span>, </span>
<span id="cb5-73"><a href="#cb5-73" aria-hidden="true" tabindex="-1"></a>                      message <span class="op">=</span> (grouping<span class="op">+</span><span class="st">' ========'</span>).encode())</span>
<span id="cb5-74"><a href="#cb5-74" aria-hidden="true" tabindex="-1"></a>            <span class="cf">for</span> issue <span class="kw">in</span> outputList[<span class="dv">2</span>]:</span>
<span id="cb5-75"><a href="#cb5-75" aria-hidden="true" tabindex="-1"></a>                write_log(pathString<span class="op">=</span> <span class="st">'../data/external/'</span><span class="op">+</span><span class="st">'log_'</span><span class="op">+</span>dfNameStr<span class="op">+</span><span class="st">'_issues.txt'</span>, </span>
<span id="cb5-76"><a href="#cb5-76" aria-hidden="true" tabindex="-1"></a>                          message <span class="op">=</span> issue.encode())</span>
<span id="cb5-77"><a href="#cb5-77" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-78"><a href="#cb5-78" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span>(reTypedColumns)</span>
<span id="cb5-79"><a href="#cb5-79" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-80"><a href="#cb5-80" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-81"><a href="#cb5-81" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> check_col_types_all_groupings_across_tables(</span>
<span id="cb5-82"><a href="#cb5-82" aria-hidden="true" tabindex="-1"></a>    metadataDfNameStr, <span class="co"># = 'metadata2018',</span></span>
<span id="cb5-83"><a href="#cb5-83" aria-hidden="true" tabindex="-1"></a>    soilDfNameStr, <span class="co"># = 'soil2018',</span></span>
<span id="cb5-84"><a href="#cb5-84" aria-hidden="true" tabindex="-1"></a>    weatherDfNameStr, <span class="co"># = 'weather2018',</span></span>
<span id="cb5-85"><a href="#cb5-85" aria-hidden="true" tabindex="-1"></a>    managementDfNameStr, <span class="co"># = 'agro2018',</span></span>
<span id="cb5-86"><a href="#cb5-86" aria-hidden="true" tabindex="-1"></a>    phenotypeDfNameStr, <span class="co"># = 'pheno2018',</span></span>
<span id="cb5-87"><a href="#cb5-87" aria-hidden="true" tabindex="-1"></a>    genotypeDfNameStr, <span class="co"># = '',</span></span>
<span id="cb5-88"><a href="#cb5-88" aria-hidden="true" tabindex="-1"></a>    colGroupings <span class="co"># = colGroupings</span></span>
<span id="cb5-89"><a href="#cb5-89" aria-hidden="true" tabindex="-1"></a>):</span>
<span id="cb5-90"><a href="#cb5-90" aria-hidden="true" tabindex="-1"></a>    metadataDict <span class="op">=</span> []</span>
<span id="cb5-91"><a href="#cb5-91" aria-hidden="true" tabindex="-1"></a>    soilDict <span class="op">=</span> []</span>
<span id="cb5-92"><a href="#cb5-92" aria-hidden="true" tabindex="-1"></a>    phenoDict <span class="op">=</span> []</span>
<span id="cb5-93"><a href="#cb5-93" aria-hidden="true" tabindex="-1"></a>    genoDict <span class="op">=</span> []</span>
<span id="cb5-94"><a href="#cb5-94" aria-hidden="true" tabindex="-1"></a>    agroDict <span class="op">=</span> []</span>
<span id="cb5-95"><a href="#cb5-95" aria-hidden="true" tabindex="-1"></a>    weatherDict <span class="op">=</span> []</span>
<span id="cb5-96"><a href="#cb5-96" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-97"><a href="#cb5-97" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> metadataDfNameStr <span class="op">!=</span> <span class="st">''</span>:</span>
<span id="cb5-98"><a href="#cb5-98" aria-hidden="true" tabindex="-1"></a>        metadataDict <span class="op">=</span> check_col_types_all_groupings(dfNameStr <span class="op">=</span> metadataDfNameStr, </span>
<span id="cb5-99"><a href="#cb5-99" aria-hidden="true" tabindex="-1"></a>                                                     colGroupings <span class="op">=</span> colGroupings)</span>
<span id="cb5-100"><a href="#cb5-100" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> soilDfNameStr <span class="op">!=</span> <span class="st">''</span>:</span>
<span id="cb5-101"><a href="#cb5-101" aria-hidden="true" tabindex="-1"></a>        soilDict <span class="op">=</span> check_col_types_all_groupings(dfNameStr <span class="op">=</span> soilDfNameStr, </span>
<span id="cb5-102"><a href="#cb5-102" aria-hidden="true" tabindex="-1"></a>                                                 colGroupings <span class="op">=</span> colGroupings)</span>
<span id="cb5-103"><a href="#cb5-103" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> phenotypeDfNameStr <span class="op">!=</span> <span class="st">''</span>:</span>
<span id="cb5-104"><a href="#cb5-104" aria-hidden="true" tabindex="-1"></a>        phenoDict <span class="op">=</span> check_col_types_all_groupings(dfNameStr <span class="op">=</span> phenotypeDfNameStr, </span>
<span id="cb5-105"><a href="#cb5-105" aria-hidden="true" tabindex="-1"></a>                                                  colGroupings <span class="op">=</span> colGroupings)</span>
<span id="cb5-106"><a href="#cb5-106" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> genotypeDfNameStr <span class="op">!=</span> <span class="st">''</span>:</span>
<span id="cb5-107"><a href="#cb5-107" aria-hidden="true" tabindex="-1"></a>        genoDict <span class="op">=</span> check_col_types_all_groupings(dfNameStr <span class="op">=</span> genotypeDfNameStr, </span>
<span id="cb5-108"><a href="#cb5-108" aria-hidden="true" tabindex="-1"></a>                                                 colGroupings <span class="op">=</span> colGroupings)</span>
<span id="cb5-109"><a href="#cb5-109" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> managementDfNameStr <span class="op">!=</span> <span class="st">''</span>:</span>
<span id="cb5-110"><a href="#cb5-110" aria-hidden="true" tabindex="-1"></a>        agroDict <span class="op">=</span> check_col_types_all_groupings(dfNameStr <span class="op">=</span> managementDfNameStr , </span>
<span id="cb5-111"><a href="#cb5-111" aria-hidden="true" tabindex="-1"></a>                                                 colGroupings <span class="op">=</span> colGroupings)</span>
<span id="cb5-112"><a href="#cb5-112" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> weatherDfNameStr <span class="op">!=</span> <span class="st">''</span>:</span>
<span id="cb5-113"><a href="#cb5-113" aria-hidden="true" tabindex="-1"></a>        weatherDict <span class="op">=</span> check_col_types_all_groupings(dfNameStr <span class="op">=</span> weatherDfNameStr, </span>
<span id="cb5-114"><a href="#cb5-114" aria-hidden="true" tabindex="-1"></a>                                                    colGroupings <span class="op">=</span> colGroupings)</span>
<span id="cb5-115"><a href="#cb5-115" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-116"><a href="#cb5-116" aria-hidden="true" tabindex="-1"></a>    outputList <span class="op">=</span> [entry <span class="cf">for</span> entry <span class="kw">in</span> [metadataDict,</span>
<span id="cb5-117"><a href="#cb5-117" aria-hidden="true" tabindex="-1"></a>                                      soilDict,</span>
<span id="cb5-118"><a href="#cb5-118" aria-hidden="true" tabindex="-1"></a>                                      phenoDict,</span>
<span id="cb5-119"><a href="#cb5-119" aria-hidden="true" tabindex="-1"></a>                                      genoDict, </span>
<span id="cb5-120"><a href="#cb5-120" aria-hidden="true" tabindex="-1"></a>                                      agroDict, </span>
<span id="cb5-121"><a href="#cb5-121" aria-hidden="true" tabindex="-1"></a>                                      weatherDict] <span class="cf">if</span> entry <span class="op">!=</span> {}]</span>
<span id="cb5-122"><a href="#cb5-122" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-123"><a href="#cb5-123" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span>(outputList)</span>
<span id="cb5-124"><a href="#cb5-124" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-125"><a href="#cb5-125" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> combine_dfDicts(</span>
<span id="cb5-126"><a href="#cb5-126" aria-hidden="true" tabindex="-1"></a>    key, <span class="co"># = 'Metadata', </span></span>
<span id="cb5-127"><a href="#cb5-127" aria-hidden="true" tabindex="-1"></a>    dfDictList, <span class="co"># = [], #[metadataDict, soilDict, phenoDict, agroDict, weatherDict]</span></span>
<span id="cb5-128"><a href="#cb5-128" aria-hidden="true" tabindex="-1"></a>    logfileName, <span class="co"># = 'combineMetadata',</span></span>
<span id="cb5-129"><a href="#cb5-129" aria-hidden="true" tabindex="-1"></a>    colGroupings <span class="co">#= colGroupings</span></span>
<span id="cb5-130"><a href="#cb5-130" aria-hidden="true" tabindex="-1"></a>):</span>
<span id="cb5-131"><a href="#cb5-131" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-132"><a href="#cb5-132" aria-hidden="true" tabindex="-1"></a>    desiredCols <span class="op">=</span> <span class="bu">list</span>(colGroupings[key].dropna())</span>
<span id="cb5-133"><a href="#cb5-133" aria-hidden="true" tabindex="-1"></a>    accumulator <span class="op">=</span> pd.DataFrame()</span>
<span id="cb5-134"><a href="#cb5-134" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb5-135"><a href="#cb5-135" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> dfDict <span class="kw">in</span> dfDictList:</span>
<span id="cb5-136"><a href="#cb5-136" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> dfDict <span class="op">!=</span> []:</span>
<span id="cb5-137"><a href="#cb5-137" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> accumulator.shape <span class="op">==</span> (<span class="dv">0</span>,<span class="dv">0</span>):</span>
<span id="cb5-138"><a href="#cb5-138" aria-hidden="true" tabindex="-1"></a>                accumulator <span class="op">=</span> dfDict[key].loc[:, [col <span class="cf">for</span> col <span class="kw">in</span> <span class="bu">list</span>(dfDict[key]) <span class="cf">if</span> col <span class="kw">in</span> desiredCols]].drop_duplicates()</span>
<span id="cb5-139"><a href="#cb5-139" aria-hidden="true" tabindex="-1"></a>            <span class="cf">else</span>:</span>
<span id="cb5-140"><a href="#cb5-140" aria-hidden="true" tabindex="-1"></a>                temp <span class="op">=</span> dfDict[key].loc[:, [col <span class="cf">for</span> col <span class="kw">in</span> <span class="bu">list</span>(dfDict[key]) <span class="cf">if</span> col <span class="kw">in</span> desiredCols]].drop_duplicates()</span>
<span id="cb5-141"><a href="#cb5-141" aria-hidden="true" tabindex="-1"></a>                </span>
<span id="cb5-142"><a href="#cb5-142" aria-hidden="true" tabindex="-1"></a>                <span class="co"># Only proceed if if there are more columns shared than just identifiers.</span></span>
<span id="cb5-143"><a href="#cb5-143" aria-hidden="true" tabindex="-1"></a>                <span class="cf">if</span> [entry <span class="cf">for</span> entry <span class="kw">in</span> <span class="bu">list</span>(temp) <span class="cf">if</span> entry <span class="kw">not</span> <span class="kw">in</span> <span class="bu">list</span>(colGroupings[<span class="st">'Keys'</span>].dropna())] <span class="op">!=</span> []:</span>
<span id="cb5-144"><a href="#cb5-144" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-145"><a href="#cb5-145" aria-hidden="true" tabindex="-1"></a>                    <span class="co"># find mismatched columns</span></span>
<span id="cb5-146"><a href="#cb5-146" aria-hidden="true" tabindex="-1"></a>                    downgradeToStr <span class="op">=</span> [col <span class="cf">for</span> col <span class="kw">in</span> <span class="bu">list</span>(temp) <span class="cf">if</span> col <span class="kw">in</span> <span class="bu">list</span>(accumulator)]    </span>
<span id="cb5-147"><a href="#cb5-147" aria-hidden="true" tabindex="-1"></a><span class="co">#                     downgradeToStr = [col for col in downgradeToStr if type(temp[col][0]) != type(accumulator[col][0])]</span></span>
<span id="cb5-148"><a href="#cb5-148" aria-hidden="true" tabindex="-1"></a>                    <span class="co"># This is not done as </span></span>
<span id="cb5-149"><a href="#cb5-149" aria-hidden="true" tabindex="-1"></a>                    <span class="co"># downgradeToStr = [col for col in downgradeToStr if temp[col].dtype != accumulator[col].dtype]</span></span>
<span id="cb5-150"><a href="#cb5-150" aria-hidden="true" tabindex="-1"></a>                    <span class="co"># because doing so causes TypeError: Cannot interpret 'StringDtype' as a data type</span></span>
<span id="cb5-151"><a href="#cb5-151" aria-hidden="true" tabindex="-1"></a>                    <span class="co"># see also https://stackoverflow.com/questions/65079545/compare-dataframe-columns-typeerror-cannot-interpret-stringdtype-as-a-data-t</span></span>
<span id="cb5-152"><a href="#cb5-152" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-153"><a href="#cb5-153" aria-hidden="true" tabindex="-1"></a>                    <span class="cf">for</span> col <span class="kw">in</span> downgradeToStr:</span>
<span id="cb5-154"><a href="#cb5-154" aria-hidden="true" tabindex="-1"></a>                        accumulator[col] <span class="op">=</span> accumulator[col].astype(<span class="bu">str</span>)</span>
<span id="cb5-155"><a href="#cb5-155" aria-hidden="true" tabindex="-1"></a>                        temp[col] <span class="op">=</span> temp[col].astype(<span class="bu">str</span>)</span>
<span id="cb5-156"><a href="#cb5-156" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-157"><a href="#cb5-157" aria-hidden="true" tabindex="-1"></a>                        logMessage <span class="op">=</span> <span class="st">"Set to string:"</span><span class="op">+</span>col</span>
<span id="cb5-158"><a href="#cb5-158" aria-hidden="true" tabindex="-1"></a>                        write_log(pathString<span class="op">=</span> <span class="st">'../data/external/'</span><span class="op">+</span><span class="st">'log_'</span><span class="op">+</span>logfileName<span class="op">+</span><span class="st">'_changes.txt'</span>, </span>
<span id="cb5-159"><a href="#cb5-159" aria-hidden="true" tabindex="-1"></a>                                  message <span class="op">=</span> logMessage.encode())</span>
<span id="cb5-160"><a href="#cb5-160" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-161"><a href="#cb5-161" aria-hidden="true" tabindex="-1"></a>                    <span class="co"># merge the now compatable dfs.</span></span>
<span id="cb5-162"><a href="#cb5-162" aria-hidden="true" tabindex="-1"></a>                    accumulator<span class="op">=</span> accumulator.merge(temp, how <span class="op">=</span> <span class="st">'outer'</span>).drop_duplicates()</span>
<span id="cb5-163"><a href="#cb5-163" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span>(accumulator)</span>
<span id="cb5-164"><a href="#cb5-164" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-165"><a href="#cb5-165" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-166"><a href="#cb5-166" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-167"><a href="#cb5-167" aria-hidden="true" tabindex="-1"></a><span class="co"># combine_dfDicts(key, dfDictList, logfileName, colGroupings) -&gt; accumulator</span></span>
<span id="cb5-168"><a href="#cb5-168" aria-hidden="true" tabindex="-1"></a><span class="co">#                   ^        ^</span></span>
<span id="cb5-169"><a href="#cb5-169" aria-hidden="true" tabindex="-1"></a><span class="co">#      e.g. 'metadata'       |_______________________________</span></span>
<span id="cb5-170"><a href="#cb5-170" aria-hidden="true" tabindex="-1"></a><span class="co">#                                                           \  </span></span>
<span id="cb5-171"><a href="#cb5-171" aria-hidden="true" tabindex="-1"></a><span class="co"># check_col_types_all_groupings_across_tables(              |</span></span>
<span id="cb5-172"><a href="#cb5-172" aria-hidden="true" tabindex="-1"></a><span class="co"># metadataDfNameStr, ... weatherDfNameStr, colGroupings) -&gt; [metadataDict ... weatherDict] if entry != {}]</span></span>
<span id="cb5-173"><a href="#cb5-173" aria-hidden="true" tabindex="-1"></a><span class="co">#                                 |                          ^           </span></span>
<span id="cb5-174"><a href="#cb5-174" aria-hidden="true" tabindex="-1"></a><span class="co">#                                 v                          |    </span></span>
<span id="cb5-175"><a href="#cb5-175" aria-hidden="true" tabindex="-1"></a><span class="co"># check_col_types_all_groupings(dfNameStr, colGroupings) -&gt; {'Metadata': [], 'Soil': [], 'Phenotype': [], 'Genotype': [], 'Management': [], 'Weather': []}</span></span>
<span id="cb5-176"><a href="#cb5-176" aria-hidden="true" tabindex="-1"></a><span class="co">#                                 |                                      ^</span></span>
<span id="cb5-177"><a href="#cb5-177" aria-hidden="true" tabindex="-1"></a><span class="co">#                                 v                                      |</span></span>
<span id="cb5-178"><a href="#cb5-178" aria-hidden="true" tabindex="-1"></a><span class="co">#               check_col_types(data, grouping, colGroupings) -&gt; return(data, changeMessages, issueMessages)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="remove-output-files" class="level2">
<h2 class="anchored" data-anchor-id="remove-output-files">Remove output files</h2>
</section>
<section id="clean-up-logs-intermediate-files" class="level2">
<h2 class="anchored" data-anchor-id="clean-up-logs-intermediate-files">Clean up logs &amp; intermediate files</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> delete_logs(pathString <span class="op">=</span> <span class="st">'../data/external/'</span>):</span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>    logs <span class="op">=</span> glob.glob(pathString<span class="op">+</span><span class="st">'log*.txt'</span>) </span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> log <span class="kw">in</span> logs:</span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a>        os.remove(log)</span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-6"><a href="#cb6-6" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> write_log(pathString<span class="op">=</span> <span class="st">'../data/external/logfile.txt'</span>, message <span class="op">=</span> <span class="st">'hello'</span>):</span>
<span id="cb6-7"><a href="#cb6-7" aria-hidden="true" tabindex="-1"></a>    <span class="co"># fileName = pathString.split(sep = '/')[-1]</span></span>
<span id="cb6-8"><a href="#cb6-8" aria-hidden="true" tabindex="-1"></a>    <span class="co"># mk log file if it doesn't exist</span></span>
<span id="cb6-9"><a href="#cb6-9" aria-hidden="true" tabindex="-1"></a><span class="co">#     print(os.path.isfile(pathString))</span></span>
<span id="cb6-10"><a href="#cb6-10" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> os.path.isfile(pathString) <span class="op">==</span> <span class="va">False</span>:</span>
<span id="cb6-11"><a href="#cb6-11" aria-hidden="true" tabindex="-1"></a>        <span class="cf">with</span> <span class="bu">open</span>(pathString, <span class="st">'wb'</span>) <span class="im">as</span> textFile: </span>
<span id="cb6-12"><a href="#cb6-12" aria-hidden="true" tabindex="-1"></a>            <span class="co"># wb allows for unicode </span></span>
<span id="cb6-13"><a href="#cb6-13" aria-hidden="true" tabindex="-1"></a>            <span class="co"># only needed because there's a non-standard character in one of the column names</span></span>
<span id="cb6-14"><a href="#cb6-14" aria-hidden="true" tabindex="-1"></a>            <span class="co"># https://www.kite.com/python/answers/how-to-write-unicode-text-to-a-text-file-in-python</span></span>
<span id="cb6-15"><a href="#cb6-15" aria-hidden="true" tabindex="-1"></a>            textFile.write(<span class="st">''</span>.encode(<span class="st">"utf8"</span>))</span>
<span id="cb6-16"><a href="#cb6-16" aria-hidden="true" tabindex="-1"></a>    <span class="cf">else</span>:    </span>
<span id="cb6-17"><a href="#cb6-17" aria-hidden="true" tabindex="-1"></a>        <span class="cf">with</span> <span class="bu">open</span>(pathString, <span class="st">"ab"</span>) <span class="im">as</span> textFile:</span>
<span id="cb6-18"><a href="#cb6-18" aria-hidden="true" tabindex="-1"></a>            textFile.write(message)</span>
<span id="cb6-19"><a href="#cb6-19" aria-hidden="true" tabindex="-1"></a>            textFile.write(<span class="st">'</span><span class="ch">\n</span><span class="st">'</span>.encode(<span class="st">"utf8"</span>))</span>
<span id="cb6-20"><a href="#cb6-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-21"><a href="#cb6-21" aria-hidden="true" tabindex="-1"></a>delete_logs(pathString <span class="op">=</span> log_path)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="co"># rm database files</span></span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a><span class="co"># for filePath in glob.glob('../data/interim/*.db'):</span></span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a><span class="co">#     os.remove(filePath)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="data-objects" class="level2">
<h2 class="anchored" data-anchor-id="data-objects">Data Objects</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="co">## Pull in info/data objects for converting names</span></span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a><span class="co"># def get_json_dict(path):</span></span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a><span class="co">#     with open(path) as f:</span></span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a><span class="co">#         dat = json.load(f)</span></span>
<span id="cb8-6"><a href="#cb8-6" aria-hidden="true" tabindex="-1"></a><span class="co">#     return(dat)</span></span>
<span id="cb8-7"><a href="#cb8-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-8"><a href="#cb8-8" aria-hidden="true" tabindex="-1"></a><span class="co"># # gets the first item of the dict, returns the assoicated list</span></span>
<span id="cb8-9"><a href="#cb8-9" aria-hidden="true" tabindex="-1"></a><span class="co"># def get_json_list(path):</span></span>
<span id="cb8-10"><a href="#cb8-10" aria-hidden="true" tabindex="-1"></a><span class="co">#     dat = get_json_dict(path)</span></span>
<span id="cb8-11"><a href="#cb8-11" aria-hidden="true" tabindex="-1"></a><span class="co">#     # get only the 0th value</span></span>
<span id="cb8-12"><a href="#cb8-12" aria-hidden="true" tabindex="-1"></a><span class="co">#     dat = dat[list(dat.keys())[0]]</span></span>
<span id="cb8-13"><a href="#cb8-13" aria-hidden="true" tabindex="-1"></a><span class="co">#     return(dat)</span></span>
<span id="cb8-14"><a href="#cb8-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-15"><a href="#cb8-15" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> load_pickle(path):</span>
<span id="cb8-16"><a href="#cb8-16" aria-hidden="true" tabindex="-1"></a>    <span class="cf">with</span> <span class="bu">open</span>(path, <span class="st">'rb'</span>) <span class="im">as</span> f:</span>
<span id="cb8-17"><a href="#cb8-17" aria-hidden="true" tabindex="-1"></a>        data <span class="op">=</span> pickle.load(f)</span>
<span id="cb8-18"><a href="#cb8-18" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span>(data)</span>
<span id="cb8-19"><a href="#cb8-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-20"><a href="#cb8-20" aria-hidden="true" tabindex="-1"></a><span class="co"># this is an unideal workaround that comes from some data having characters within the string (",","","","\xa0") that prevent using csv or json easily</span></span>
<span id="cb8-21"><a href="#cb8-21" aria-hidden="true" tabindex="-1"></a><span class="co"># Putting the conversions into a python script isn't as nice as a table but it's still plaintext so it can be version controlled easily.</span></span>
<span id="cb8-22"><a href="#cb8-22" aria-hidden="true" tabindex="-1"></a>expectedExperimentCodes <span class="op">=</span> load_pickle(path <span class="op">=</span> <span class="st">"./data/manual/expectedExperimentCodes.pickle"</span>)</span>
<span id="cb8-23"><a href="#cb8-23" aria-hidden="true" tabindex="-1"></a>replaceExperimentCodes  <span class="op">=</span> load_pickle(path <span class="op">=</span> <span class="st">"./data/manual/replaceExperimentCodes.pickle"</span>)</span>
<span id="cb8-24"><a href="#cb8-24" aria-hidden="true" tabindex="-1"></a>expectedManagementCols  <span class="op">=</span> load_pickle(path <span class="op">=</span> <span class="st">"./data/manual/expectedManagementCols.pickle"</span>)</span>
<span id="cb8-25"><a href="#cb8-25" aria-hidden="true" tabindex="-1"></a>newApplicationNames     <span class="op">=</span> load_pickle(path <span class="op">=</span> <span class="st">"./data/manual/newApplicationNames.pickle"</span>)</span>
<span id="cb8-26"><a href="#cb8-26" aria-hidden="true" tabindex="-1"></a>expectedApplicationUnits<span class="op">=</span> load_pickle(path <span class="op">=</span> <span class="st">"./data/manual/expectedApplicationUnits.pickle"</span>)</span>
<span id="cb8-27"><a href="#cb8-27" aria-hidden="true" tabindex="-1"></a>replaceApplicationUnits <span class="op">=</span> load_pickle(path <span class="op">=</span> <span class="st">"./data/manual/replaceApplicationUnits.pickle"</span>)</span>
<span id="cb8-28"><a href="#cb8-28" aria-hidden="true" tabindex="-1"></a>newProductNames         <span class="op">=</span> load_pickle(path <span class="op">=</span> <span class="st">"./data/manual/newProductNames.pickle"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="class-for-each-year." class="level2">
<h2 class="anchored" data-anchor-id="class-for-each-year.">Class for each year.</h2>
<p>Goal: allow for reuse of methods on like data (e.g.&nbsp;metadata) while enabling year specific methods or data types. To accomplish this, each data type gets a class subclassed from the <code>data_obj</code> class. These are bundled into a generic <code>g2f_year</code> class which can be subclassed to apply to different years.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="co">## Generic data object template ====</span></span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a><span class="kw">class</span> data_obj:</span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> <span class="fu">__init__</span>(<span class="va">self</span>, path <span class="op">=</span> <span class="va">None</span>, data <span class="op">=</span> <span class="va">None</span>):</span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.path <span class="op">=</span> path</span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.data <span class="op">=</span> data </span>
<span id="cb9-6"><a href="#cb9-6" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb9-7"><a href="#cb9-7" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> load_csv(<span class="va">self</span>):</span>
<span id="cb9-8"><a href="#cb9-8" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.data <span class="op">=</span> pd.read_csv(<span class="va">self</span>.path, encoding <span class="op">=</span> <span class="st">"ISO-8859-1"</span>, low_memory<span class="op">=</span><span class="va">False</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="co">## Data type specific classes ====</span></span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a><span class="co"># metadata</span></span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a><span class="kw">class</span> meta_obj(data_obj):</span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a>    <span class="cf">pass</span></span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-6"><a href="#cb10-6" aria-hidden="true" tabindex="-1"></a><span class="co"># phenotype</span></span>
<span id="cb10-7"><a href="#cb10-7" aria-hidden="true" tabindex="-1"></a><span class="kw">class</span> phno_obj(data_obj):</span>
<span id="cb10-8"><a href="#cb10-8" aria-hidden="true" tabindex="-1"></a>    <span class="cf">pass</span></span>
<span id="cb10-9"><a href="#cb10-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-10"><a href="#cb10-10" aria-hidden="true" tabindex="-1"></a><span class="co"># genotype</span></span>
<span id="cb10-11"><a href="#cb10-11" aria-hidden="true" tabindex="-1"></a><span class="kw">class</span> geno_obj(data_obj):</span>
<span id="cb10-12"><a href="#cb10-12" aria-hidden="true" tabindex="-1"></a>    <span class="cf">pass</span></span>
<span id="cb10-13"><a href="#cb10-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-14"><a href="#cb10-14" aria-hidden="true" tabindex="-1"></a><span class="co"># weather</span></span>
<span id="cb10-15"><a href="#cb10-15" aria-hidden="true" tabindex="-1"></a><span class="kw">class</span> wthr_obj(data_obj):</span>
<span id="cb10-16"><a href="#cb10-16" aria-hidden="true" tabindex="-1"></a>    <span class="cf">pass</span></span>
<span id="cb10-17"><a href="#cb10-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-18"><a href="#cb10-18" aria-hidden="true" tabindex="-1"></a><span class="co"># soil</span></span>
<span id="cb10-19"><a href="#cb10-19" aria-hidden="true" tabindex="-1"></a><span class="kw">class</span> soil_obj(data_obj):</span>
<span id="cb10-20"><a href="#cb10-20" aria-hidden="true" tabindex="-1"></a>    <span class="cf">pass</span></span>
<span id="cb10-21"><a href="#cb10-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-22"><a href="#cb10-22" aria-hidden="true" tabindex="-1"></a><span class="co"># managment</span></span>
<span id="cb10-23"><a href="#cb10-23" aria-hidden="true" tabindex="-1"></a><span class="kw">class</span> mgmt_obj(data_obj):</span>
<span id="cb10-24"><a href="#cb10-24" aria-hidden="true" tabindex="-1"></a>    <span class="cf">pass</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="co">## Combined yearly data release ====</span></span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a><span class="kw">class</span> g2f_year:</span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> <span class="fu">__init__</span>(<span class="va">self</span>, </span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a>                 meta_path <span class="op">=</span> <span class="va">None</span>, </span>
<span id="cb11-5"><a href="#cb11-5" aria-hidden="true" tabindex="-1"></a>                 phno_path <span class="op">=</span> <span class="va">None</span>,  </span>
<span id="cb11-6"><a href="#cb11-6" aria-hidden="true" tabindex="-1"></a>                 geno_path <span class="op">=</span> <span class="va">None</span>,  </span>
<span id="cb11-7"><a href="#cb11-7" aria-hidden="true" tabindex="-1"></a>                 wthr_path <span class="op">=</span> <span class="va">None</span>, </span>
<span id="cb11-8"><a href="#cb11-8" aria-hidden="true" tabindex="-1"></a>                 soil_path <span class="op">=</span> <span class="va">None</span>,</span>
<span id="cb11-9"><a href="#cb11-9" aria-hidden="true" tabindex="-1"></a>                 mgmt_path <span class="op">=</span> <span class="va">None</span>,</span>
<span id="cb11-10"><a href="#cb11-10" aria-hidden="true" tabindex="-1"></a>                 year <span class="op">=</span> <span class="va">None</span></span>
<span id="cb11-11"><a href="#cb11-11" aria-hidden="true" tabindex="-1"></a>                ):        </span>
<span id="cb11-12"><a href="#cb11-12" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.meta <span class="op">=</span> meta_obj(meta_path)</span>
<span id="cb11-13"><a href="#cb11-13" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.phno <span class="op">=</span> phno_obj(phno_path)</span>
<span id="cb11-14"><a href="#cb11-14" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.geno <span class="op">=</span> geno_obj(geno_path)</span>
<span id="cb11-15"><a href="#cb11-15" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.wthr <span class="op">=</span> wthr_obj(wthr_path)</span>
<span id="cb11-16"><a href="#cb11-16" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.soil <span class="op">=</span> soil_obj(soil_path)</span>
<span id="cb11-17"><a href="#cb11-17" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.mgmt <span class="op">=</span> mgmt_obj(mgmt_path)</span>
<span id="cb11-18"><a href="#cb11-18" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.year <span class="op">=</span> year</span>
<span id="cb11-19"><a href="#cb11-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-20"><a href="#cb11-20" aria-hidden="true" tabindex="-1"></a>    <span class="co"># load all the csvs that are provided. Ignore genotypic data for now.</span></span>
<span id="cb11-21"><a href="#cb11-21" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> ready_csvs(<span class="va">self</span>):</span>
<span id="cb11-22"><a href="#cb11-22" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> entry <span class="kw">in</span> [<span class="st">'meta'</span>, <span class="st">'phno'</span>, <span class="co">#'geno', </span></span>
<span id="cb11-23"><a href="#cb11-23" aria-hidden="true" tabindex="-1"></a>                                     <span class="st">'wthr'</span>, <span class="st">'soil'</span>, <span class="st">'mgmt'</span>]:</span>
<span id="cb11-24"><a href="#cb11-24" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> <span class="bu">getattr</span>(<span class="va">self</span>,  entry).path <span class="op">!=</span> <span class="va">None</span>:</span>
<span id="cb11-25"><a href="#cb11-25" aria-hidden="true" tabindex="-1"></a>                <span class="bu">getattr</span>(<span class="va">self</span>, entry).load_csv()</span>
<span id="cb11-26"><a href="#cb11-26" aria-hidden="true" tabindex="-1"></a>                </span>
<span id="cb11-27"><a href="#cb11-27" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Helper function mimicing `ready_csv`'s check for initialized </span></span>
<span id="cb11-28"><a href="#cb11-28" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> _get_active_attr(<span class="va">self</span>):</span>
<span id="cb11-29"><a href="#cb11-29" aria-hidden="true" tabindex="-1"></a>        active_attr <span class="op">=</span> [entry <span class="cf">for</span> entry <span class="kw">in</span> [<span class="st">'meta'</span>, <span class="st">'phno'</span>, <span class="co">#'geno', </span></span>
<span id="cb11-30"><a href="#cb11-30" aria-hidden="true" tabindex="-1"></a>                                          <span class="st">'wthr'</span>, <span class="st">'soil'</span>, <span class="st">'mgmt'</span></span>
<span id="cb11-31"><a href="#cb11-31" aria-hidden="true" tabindex="-1"></a>                                         ] <span class="cf">if</span> <span class="bu">type</span>(<span class="bu">getattr</span>(<span class="va">self</span>,  entry).data) <span class="op">!=</span> <span class="bu">type</span>(<span class="va">None</span>)]</span>
<span id="cb11-32"><a href="#cb11-32" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span>(active_attr)</span>
<span id="cb11-33"><a href="#cb11-33" aria-hidden="true" tabindex="-1"></a>                </span>
<span id="cb11-34"><a href="#cb11-34" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb11-35"><a href="#cb11-35" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb11-36"><a href="#cb11-36" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb11-37"><a href="#cb11-37" aria-hidden="true" tabindex="-1"></a>    <span class="co"># want to standardize column names all at once _then_ we'll worry about bigger disagreements between years </span></span>
<span id="cb11-38"><a href="#cb11-38" aria-hidden="true" tabindex="-1"></a>    <span class="co"># e.g. make `Location` and `LOCATION` equivalent then worry about equivalence with `ExperimentLocation`</span></span>
<span id="cb11-39"><a href="#cb11-39" aria-hidden="true" tabindex="-1"></a>    <span class="co"># This will give us a capitalized snake case while allowing special names (e.g. elements) to stay capitalized</span></span>
<span id="cb11-40"><a href="#cb11-40" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> _transform_name(<span class="va">self</span>, <span class="bu">input</span>):</span>
<span id="cb11-41"><a href="#cb11-41" aria-hidden="true" tabindex="-1"></a>        <span class="kw">def</span> _transform_string(<span class="bu">input</span>):</span>
<span id="cb11-42"><a href="#cb11-42" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> <span class="bu">type</span>(<span class="bu">input</span>) <span class="op">!=</span> <span class="bu">str</span>:</span>
<span id="cb11-43"><a href="#cb11-43" aria-hidden="true" tabindex="-1"></a>                <span class="bu">print</span>(<span class="st">"input must be a string"</span>)</span>
<span id="cb11-44"><a href="#cb11-44" aria-hidden="true" tabindex="-1"></a>                <span class="cf">return</span> <span class="va">None</span></span>
<span id="cb11-45"><a href="#cb11-45" aria-hidden="true" tabindex="-1"></a>            <span class="cf">else</span>:</span>
<span id="cb11-46"><a href="#cb11-46" aria-hidden="true" tabindex="-1"></a>                transformed_string <span class="op">=</span> <span class="bu">input</span></span>
<span id="cb11-47"><a href="#cb11-47" aria-hidden="true" tabindex="-1"></a>                <span class="co"># if there are multiple spaces in a replace them with 1</span></span>
<span id="cb11-48"><a href="#cb11-48" aria-hidden="true" tabindex="-1"></a>                transformed_string <span class="op">=</span> re.sub(<span class="st">' {2,}'</span>, <span class="st">' '</span>, transformed_string)</span>
<span id="cb11-49"><a href="#cb11-49" aria-hidden="true" tabindex="-1"></a>                <span class="co"># remove space after % as in '% Silt'</span></span>
<span id="cb11-50"><a href="#cb11-50" aria-hidden="true" tabindex="-1"></a>                transformed_string <span class="op">=</span> re.sub(<span class="st">'% '</span>, <span class="st">'%'</span>, transformed_string)</span>
<span id="cb11-51"><a href="#cb11-51" aria-hidden="true" tabindex="-1"></a>                transformed_string <span class="op">=</span> re.sub(<span class="st">' %'</span>, <span class="st">'%'</span>, transformed_string)</span>
<span id="cb11-52"><a href="#cb11-52" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-53"><a href="#cb11-53" aria-hidden="true" tabindex="-1"></a>                <span class="co"># Split to Words</span></span>
<span id="cb11-54"><a href="#cb11-54" aria-hidden="true" tabindex="-1"></a>                transformed_string <span class="op">=</span> transformed_string.replace(<span class="st">' '</span>, <span class="st">'_'</span>)</span>
<span id="cb11-55"><a href="#cb11-55" aria-hidden="true" tabindex="-1"></a>                transformed_string <span class="op">=</span> transformed_string.split(<span class="st">'_'</span>)</span>
<span id="cb11-56"><a href="#cb11-56" aria-hidden="true" tabindex="-1"></a>                <span class="co"># decapitalize words that are capitalized but a few words (e.g. elements)</span></span>
<span id="cb11-57"><a href="#cb11-57" aria-hidden="true" tabindex="-1"></a>                <span class="co"># should be capitalized will be uncapitalized. Correct for this.</span></span>
<span id="cb11-58"><a href="#cb11-58" aria-hidden="true" tabindex="-1"></a>                <span class="kw">def</span> _decapitalize(string): <span class="cf">return</span> (string[<span class="dv">0</span>].lower()<span class="op">+</span>string[<span class="dv">1</span>:])</span>
<span id="cb11-59"><a href="#cb11-59" aria-hidden="true" tabindex="-1"></a>                <span class="co">"""</span></span>
<span id="cb11-60"><a href="#cb11-60" aria-hidden="true" tabindex="-1"></a><span class="co">                This list holds all of the okayed strings that we want to stay uppercase</span></span>
<span id="cb11-61"><a href="#cb11-61" aria-hidden="true" tabindex="-1"></a><span class="co">                """</span></span>
<span id="cb11-62"><a href="#cb11-62" aria-hidden="true" tabindex="-1"></a>                ok_cap <span class="op">=</span> [<span class="st">"ID"</span>,<span class="st">"NWS"</span>, <span class="st">"LOI%"</span>, <span class="st">"N"</span>, <span class="st">"N/A"</span>, <span class="st">"K"</span>, <span class="st">"S"</span>, <span class="st">"H"</span>, <span class="st">"K"</span>, <span class="st">"Ca"</span>, <span class="st">"Mg"</span>, <span class="st">"Na"</span>, <span class="st">"P-III"</span>, <span class="st">"P"</span>]</span>
<span id="cb11-63"><a href="#cb11-63" aria-hidden="true" tabindex="-1"></a>                transformed_string <span class="op">=</span> [e <span class="cf">if</span> e <span class="kw">in</span> ok_cap <span class="cf">else</span> _decapitalize(e)  <span class="cf">for</span> e <span class="kw">in</span> transformed_string]</span>
<span id="cb11-64"><a href="#cb11-64" aria-hidden="true" tabindex="-1"></a>                transformed_string <span class="op">=</span> <span class="st">'_'</span>.join(transformed_string)</span>
<span id="cb11-65"><a href="#cb11-65" aria-hidden="true" tabindex="-1"></a>                <span class="co"># Now recapitalize the first letter</span></span>
<span id="cb11-66"><a href="#cb11-66" aria-hidden="true" tabindex="-1"></a>                transformed_string <span class="op">=</span> transformed_string[<span class="dv">0</span>].capitalize()<span class="op">+</span>transformed_string[<span class="dv">1</span>:]</span>
<span id="cb11-67"><a href="#cb11-67" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-68"><a href="#cb11-68" aria-hidden="true" tabindex="-1"></a>                <span class="cf">return</span> transformed_string</span>
<span id="cb11-69"><a href="#cb11-69" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-70"><a href="#cb11-70" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="bu">type</span>(<span class="bu">input</span>) <span class="op">==</span> <span class="bu">list</span>:</span>
<span id="cb11-71"><a href="#cb11-71" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span> [_transform_string(e) <span class="cf">for</span> e <span class="kw">in</span> <span class="bu">input</span>]</span>
<span id="cb11-72"><a href="#cb11-72" aria-hidden="true" tabindex="-1"></a>        <span class="cf">else</span>:</span>
<span id="cb11-73"><a href="#cb11-73" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span> _transform_string(<span class="bu">input</span>)</span>
<span id="cb11-74"><a href="#cb11-74" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb11-75"><a href="#cb11-75" aria-hidden="true" tabindex="-1"></a>    <span class="co"># walk over all active dataframes and apply simple renaming transformations</span></span>
<span id="cb11-76"><a href="#cb11-76" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> transform_all_names(<span class="va">self</span>):</span>
<span id="cb11-77"><a href="#cb11-77" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> entry <span class="kw">in</span> <span class="va">self</span>._get_active_attr():</span>
<span id="cb11-78"><a href="#cb11-78" aria-hidden="true" tabindex="-1"></a>                cols_list <span class="op">=</span> <span class="bu">getattr</span>(<span class="va">self</span>, entry).data.columns</span>
<span id="cb11-79"><a href="#cb11-79" aria-hidden="true" tabindex="-1"></a>                cols_list <span class="op">=</span> <span class="bu">list</span>(cols_list) </span>
<span id="cb11-80"><a href="#cb11-80" aria-hidden="true" tabindex="-1"></a>                <span class="bu">getattr</span>(<span class="va">self</span>, entry).data <span class="op">=</span> <span class="bu">getattr</span>(<span class="va">self</span>, entry).data.rename(</span>
<span id="cb11-81"><a href="#cb11-81" aria-hidden="true" tabindex="-1"></a>                    columns<span class="op">=</span><span class="bu">dict</span>(<span class="bu">zip</span>(cols_list,</span>
<span id="cb11-82"><a href="#cb11-82" aria-hidden="true" tabindex="-1"></a>                                     <span class="va">self</span>._transform_name(<span class="bu">input</span> <span class="op">=</span> cols_list))))</span>
<span id="cb11-83"><a href="#cb11-83" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb11-84"><a href="#cb11-84" aria-hidden="true" tabindex="-1"></a>    <span class="co"># This function acts to check if there are names in the csv that are not what we expect</span></span>
<span id="cb11-85"><a href="#cb11-85" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Year specific variations will be coerced to one of these when possible before standardizing them</span></span>
<span id="cb11-86"><a href="#cb11-86" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> transform_all_names_check(<span class="va">self</span>):</span>
<span id="cb11-87"><a href="#cb11-87" aria-hidden="true" tabindex="-1"></a>        expected_cols_dict <span class="op">=</span> {</span>
<span id="cb11-88"><a href="#cb11-88" aria-hidden="true" tabindex="-1"></a>        <span class="st">'meta'</span>: [</span>
<span id="cb11-89"><a href="#cb11-89" aria-hidden="true" tabindex="-1"></a>            <span class="st">'Experiment_code'</span>, </span>
<span id="cb11-90"><a href="#cb11-90" aria-hidden="true" tabindex="-1"></a>            <span class="st">'Treatment'</span>, </span>
<span id="cb11-91"><a href="#cb11-91" aria-hidden="true" tabindex="-1"></a>            <span class="st">'City'</span>, </span>
<span id="cb11-92"><a href="#cb11-92" aria-hidden="true" tabindex="-1"></a>            <span class="st">'Farm'</span>, </span>
<span id="cb11-93"><a href="#cb11-93" aria-hidden="true" tabindex="-1"></a>            <span class="st">'Field'</span>, </span>
<span id="cb11-94"><a href="#cb11-94" aria-hidden="true" tabindex="-1"></a>            <span class="st">'Trial_ID_(Assigned_by_collaborator_for_internal_reference)'</span>, </span>
<span id="cb11-95"><a href="#cb11-95" aria-hidden="true" tabindex="-1"></a>            <span class="st">'Soil_taxonomic_ID_and_horizon_description,_if_known'</span>, </span>
<span id="cb11-96"><a href="#cb11-96" aria-hidden="true" tabindex="-1"></a>            <span class="st">'Weather_station_serial_number_(Last_four_digits,_e.g._m2700s#####)'</span>, </span>
<span id="cb11-97"><a href="#cb11-97" aria-hidden="true" tabindex="-1"></a>            <span class="st">'Weather_station_latitude_(in_decimal_numbers_nOT_dMS)'</span>, </span>
<span id="cb11-98"><a href="#cb11-98" aria-hidden="true" tabindex="-1"></a>            <span class="st">'Weather_station_longitude_(in_decimal_numbers_nOT_dMS)'</span>, </span>
<span id="cb11-99"><a href="#cb11-99" aria-hidden="true" tabindex="-1"></a>            <span class="st">'Date_weather_station_placed'</span>, </span>
<span id="cb11-100"><a href="#cb11-100" aria-hidden="true" tabindex="-1"></a>            <span class="st">'Date_weather_station_removed'</span>, </span>
<span id="cb11-101"><a href="#cb11-101" aria-hidden="true" tabindex="-1"></a>            <span class="st">'In-field_weather_station_serial_number'</span>, </span>
<span id="cb11-102"><a href="#cb11-102" aria-hidden="true" tabindex="-1"></a>            <span class="st">'In-field_weather_station_latitude_(in_decimal)'</span>, </span>
<span id="cb11-103"><a href="#cb11-103" aria-hidden="true" tabindex="-1"></a>            <span class="st">'In-field_weather_station_longitude_(in_decimal)'</span>, </span>
<span id="cb11-104"><a href="#cb11-104" aria-hidden="true" tabindex="-1"></a>            <span class="st">'Previous_crop'</span>, </span>
<span id="cb11-105"><a href="#cb11-105" aria-hidden="true" tabindex="-1"></a>            <span class="st">'Pre-plant_tillage_method(s)'</span>, </span>
<span id="cb11-106"><a href="#cb11-106" aria-hidden="true" tabindex="-1"></a>            <span class="st">'In-season_tillage_method(s)'</span>, </span>
<span id="cb11-107"><a href="#cb11-107" aria-hidden="true" tabindex="-1"></a>            <span class="st">'Plot_length_(center-alley_to_center-alley_in_feet)'</span>, </span>
<span id="cb11-108"><a href="#cb11-108" aria-hidden="true" tabindex="-1"></a>            <span class="st">'Alley_length_(in_inches)'</span>, </span>
<span id="cb11-109"><a href="#cb11-109" aria-hidden="true" tabindex="-1"></a>            <span class="st">'Row_spacing_(in_inches)'</span>, </span>
<span id="cb11-110"><a href="#cb11-110" aria-hidden="true" tabindex="-1"></a>            <span class="st">'Type_of_planter_(fluted_cone;_belt_cone;_air_planter)'</span>, </span>
<span id="cb11-111"><a href="#cb11-111" aria-hidden="true" tabindex="-1"></a>            <span class="st">'Number_kernels_planted_per_plot_(&gt;200_seed/pack_for_cone_planters)'</span>, </span>
<span id="cb11-112"><a href="#cb11-112" aria-hidden="true" tabindex="-1"></a>            <span class="st">'System_determining_moisture'</span>, </span>
<span id="cb11-113"><a href="#cb11-113" aria-hidden="true" tabindex="-1"></a>            <span class="st">'Pounds_needed_soil_moisture'</span>, </span>
<span id="cb11-114"><a href="#cb11-114" aria-hidden="true" tabindex="-1"></a>            <span class="st">'Latitude_of_field_corner_#1_(lower_left)'</span>, </span>
<span id="cb11-115"><a href="#cb11-115" aria-hidden="true" tabindex="-1"></a>            <span class="st">'Longitude_of_field_corner_#1_(lower_left)'</span>, </span>
<span id="cb11-116"><a href="#cb11-116" aria-hidden="true" tabindex="-1"></a>            <span class="st">'Latitude_of_field_corner_#2_(lower_right)'</span>, </span>
<span id="cb11-117"><a href="#cb11-117" aria-hidden="true" tabindex="-1"></a>            <span class="st">'Longitude_of_field_corner_#2_(lower_right)'</span>, </span>
<span id="cb11-118"><a href="#cb11-118" aria-hidden="true" tabindex="-1"></a>            <span class="st">'Latitude_of_field_corner_#3_(upper_right)'</span>, </span>
<span id="cb11-119"><a href="#cb11-119" aria-hidden="true" tabindex="-1"></a>            <span class="st">'Longitude_of_field_corner_#3_(upper_right)'</span>, </span>
<span id="cb11-120"><a href="#cb11-120" aria-hidden="true" tabindex="-1"></a>            <span class="st">'Latitude_of_field_corner_#4_(upper_left)'</span>, </span>
<span id="cb11-121"><a href="#cb11-121" aria-hidden="true" tabindex="-1"></a>            <span class="st">'Longitude_of_field_corner_#4_(upper_left)'</span>, </span>
<span id="cb11-122"><a href="#cb11-122" aria-hidden="true" tabindex="-1"></a>            <span class="st">'Cardinal_heading_pass_1'</span>, </span>
<span id="cb11-123"><a href="#cb11-123" aria-hidden="true" tabindex="-1"></a>            <span class="st">'Local_check_#1_pedigree'</span>, </span>
<span id="cb11-124"><a href="#cb11-124" aria-hidden="true" tabindex="-1"></a>            <span class="st">'Local_check_#1_source'</span>, </span>
<span id="cb11-125"><a href="#cb11-125" aria-hidden="true" tabindex="-1"></a>            <span class="st">'Local_check_#2_pedigree'</span>, </span>
<span id="cb11-126"><a href="#cb11-126" aria-hidden="true" tabindex="-1"></a>            <span class="st">'Local_check_#2_source'</span>, </span>
<span id="cb11-127"><a href="#cb11-127" aria-hidden="true" tabindex="-1"></a>            <span class="st">'Local_check_#3_pedigree'</span>, </span>
<span id="cb11-128"><a href="#cb11-128" aria-hidden="true" tabindex="-1"></a>            <span class="st">'Local_check_#3_source'</span>, </span>
<span id="cb11-129"><a href="#cb11-129" aria-hidden="true" tabindex="-1"></a>            <span class="st">'Local_check_#4_pedigree'</span>, </span>
<span id="cb11-130"><a href="#cb11-130" aria-hidden="true" tabindex="-1"></a>            <span class="st">'Local_check_#4_source'</span>, </span>
<span id="cb11-131"><a href="#cb11-131" aria-hidden="true" tabindex="-1"></a>            <span class="st">'Local_check_#5_pedigree'</span>, </span>
<span id="cb11-132"><a href="#cb11-132" aria-hidden="true" tabindex="-1"></a>            <span class="st">'Local_check_#5_source'</span>, </span>
<span id="cb11-133"><a href="#cb11-133" aria-hidden="true" tabindex="-1"></a>            <span class="st">'Issue/comment_#1'</span>, </span>
<span id="cb11-134"><a href="#cb11-134" aria-hidden="true" tabindex="-1"></a>            <span class="st">'Issue/comment_#2'</span>, </span>
<span id="cb11-135"><a href="#cb11-135" aria-hidden="true" tabindex="-1"></a>            <span class="st">'Issue/comment_#3'</span>, </span>
<span id="cb11-136"><a href="#cb11-136" aria-hidden="true" tabindex="-1"></a>            <span class="st">'Issue/comment_#4'</span>, </span>
<span id="cb11-137"><a href="#cb11-137" aria-hidden="true" tabindex="-1"></a>            <span class="st">'Issue/comment_#5'</span>, </span>
<span id="cb11-138"><a href="#cb11-138" aria-hidden="true" tabindex="-1"></a>            <span class="st">'Issue/comment_#6'</span>, </span>
<span id="cb11-139"><a href="#cb11-139" aria-hidden="true" tabindex="-1"></a>            <span class="st">'Issue/comment_#7'</span>, </span>
<span id="cb11-140"><a href="#cb11-140" aria-hidden="true" tabindex="-1"></a>            <span class="st">'Issue/comment_#8'</span>, </span>
<span id="cb11-141"><a href="#cb11-141" aria-hidden="true" tabindex="-1"></a>            <span class="st">'Issue/comment_#9'</span>, </span>
<span id="cb11-142"><a href="#cb11-142" aria-hidden="true" tabindex="-1"></a>            <span class="st">'Issue/comment_#10'</span>,</span>
<span id="cb11-143"><a href="#cb11-143" aria-hidden="true" tabindex="-1"></a>            <span class="co">#2018</span></span>
<span id="cb11-144"><a href="#cb11-144" aria-hidden="true" tabindex="-1"></a>            <span class="st">'Station_ID'</span>,</span>
<span id="cb11-145"><a href="#cb11-145" aria-hidden="true" tabindex="-1"></a>            <span class="co">#2015</span></span>
<span id="cb11-146"><a href="#cb11-146" aria-hidden="true" tabindex="-1"></a>            <span class="st">'LBS_for_test'</span>, </span>
<span id="cb11-147"><a href="#cb11-147" aria-hidden="true" tabindex="-1"></a>            <span class="st">'Date_Collected'</span>, </span>
<span id="cb11-148"><a href="#cb11-148" aria-hidden="true" tabindex="-1"></a>            <span class="st">'Preplant_herb'</span>, </span>
<span id="cb11-149"><a href="#cb11-149" aria-hidden="true" tabindex="-1"></a>            <span class="st">'Postplant_herb'</span>, </span>
<span id="cb11-150"><a href="#cb11-150" aria-hidden="true" tabindex="-1"></a>            <span class="st">'Total_N'</span>, </span>
<span id="cb11-151"><a href="#cb11-151" aria-hidden="true" tabindex="-1"></a>            <span class="st">'Total_P'</span>, </span>
<span id="cb11-152"><a href="#cb11-152" aria-hidden="true" tabindex="-1"></a>            <span class="st">'Total_K'</span>, </span>
<span id="cb11-153"><a href="#cb11-153" aria-hidden="true" tabindex="-1"></a>            <span class="st">'Fert_dates_1'</span>, </span>
<span id="cb11-154"><a href="#cb11-154" aria-hidden="true" tabindex="-1"></a>            <span class="st">'Fert_dates_2'</span>, </span>
<span id="cb11-155"><a href="#cb11-155" aria-hidden="true" tabindex="-1"></a>            <span class="st">'Fert_dates_3'</span>, </span>
<span id="cb11-156"><a href="#cb11-156" aria-hidden="true" tabindex="-1"></a>            <span class="st">'Fert_dates_4'</span>, </span>
<span id="cb11-157"><a href="#cb11-157" aria-hidden="true" tabindex="-1"></a>            <span class="st">'Fert_dates_5'</span>, </span>
<span id="cb11-158"><a href="#cb11-158" aria-hidden="true" tabindex="-1"></a>            <span class="st">'Fert_dates_6'</span>, </span>
<span id="cb11-159"><a href="#cb11-159" aria-hidden="true" tabindex="-1"></a>            <span class="st">'Fert_dates_7'</span>, </span>
<span id="cb11-160"><a href="#cb11-160" aria-hidden="true" tabindex="-1"></a>            <span class="st">'Fert_dates_8'</span>, </span>
<span id="cb11-161"><a href="#cb11-161" aria-hidden="true" tabindex="-1"></a>            <span class="st">'Type_of_fert'</span>,</span>
<span id="cb11-162"><a href="#cb11-162" aria-hidden="true" tabindex="-1"></a>            <span class="co"># 2014</span></span>
<span id="cb11-163"><a href="#cb11-163" aria-hidden="true" tabindex="-1"></a>            <span class="st">'Location_short'</span>, </span>
<span id="cb11-164"><a href="#cb11-164" aria-hidden="true" tabindex="-1"></a>            <span class="st">'Type'</span>, </span>
<span id="cb11-165"><a href="#cb11-165" aria-hidden="true" tabindex="-1"></a>            <span class="st">'Location'</span>, </span>
<span id="cb11-166"><a href="#cb11-166" aria-hidden="true" tabindex="-1"></a>            <span class="st">'Insecticide'</span>, </span>
<span id="cb11-167"><a href="#cb11-167" aria-hidden="true" tabindex="-1"></a>            <span class="st">'Pre-plant_herbicides'</span>, </span>
<span id="cb11-168"><a href="#cb11-168" aria-hidden="true" tabindex="-1"></a>            <span class="st">'Post-plant_herbicides'</span>, </span>
<span id="cb11-169"><a href="#cb11-169" aria-hidden="true" tabindex="-1"></a>            <span class="st">'Tillage_method'</span>, </span>
<span id="cb11-170"><a href="#cb11-170" aria-hidden="true" tabindex="-1"></a>            <span class="st">'Soil_test_type'</span>, </span>
<span id="cb11-171"><a href="#cb11-171" aria-hidden="true" tabindex="-1"></a>            <span class="st">'Soil_texture'</span>, </span>
<span id="cb11-172"><a href="#cb11-172" aria-hidden="true" tabindex="-1"></a>            <span class="st">'Soil_pH'</span>, </span>
<span id="cb11-173"><a href="#cb11-173" aria-hidden="true" tabindex="-1"></a>            <span class="st">'Total_nitrogen'</span>, </span>
<span id="cb11-174"><a href="#cb11-174" aria-hidden="true" tabindex="-1"></a>            <span class="st">'Total_phosphorus'</span>, </span>
<span id="cb11-175"><a href="#cb11-175" aria-hidden="true" tabindex="-1"></a>            <span class="st">'Total_potassium'</span>, </span>
<span id="cb11-176"><a href="#cb11-176" aria-hidden="true" tabindex="-1"></a>            <span class="st">'Nutrient_application_schedule'</span>, </span>
<span id="cb11-177"><a href="#cb11-177" aria-hidden="true" tabindex="-1"></a>            <span class="st">'Irrigated?'</span>, </span>
<span id="cb11-178"><a href="#cb11-178" aria-hidden="true" tabindex="-1"></a>            <span class="st">'Weather_station_includes_irrigation'</span>, </span>
<span id="cb11-179"><a href="#cb11-179" aria-hidden="true" tabindex="-1"></a>            <span class="st">'Fertigation_schedule'</span>, </span>
<span id="cb11-180"><a href="#cb11-180" aria-hidden="true" tabindex="-1"></a>            <span class="st">'Irrigation_schedule'</span>, </span>
<span id="cb11-181"><a href="#cb11-181" aria-hidden="true" tabindex="-1"></a>            <span class="st">'Local_check'</span>, </span>
<span id="cb11-182"><a href="#cb11-182" aria-hidden="true" tabindex="-1"></a>            <span class="st">'Date_plot_harvested_[MM/DD/YY]'</span>, </span>
<span id="cb11-183"><a href="#cb11-183" aria-hidden="true" tabindex="-1"></a>            <span class="st">'Date_plot_planted_[MM/DD/YY]'</span>, </span>
<span id="cb11-184"><a href="#cb11-184" aria-hidden="true" tabindex="-1"></a>            <span class="st">'Inbred_reps'</span>, </span>
<span id="cb11-185"><a href="#cb11-185" aria-hidden="true" tabindex="-1"></a>            <span class="st">'Inbred_plots'</span>, </span>
<span id="cb11-186"><a href="#cb11-186" aria-hidden="true" tabindex="-1"></a>            <span class="st">'Collaborators'</span>, </span>
<span id="cb11-187"><a href="#cb11-187" aria-hidden="true" tabindex="-1"></a>            <span class="st">'State'</span></span>
<span id="cb11-188"><a href="#cb11-188" aria-hidden="true" tabindex="-1"></a>        ], </span>
<span id="cb11-189"><a href="#cb11-189" aria-hidden="true" tabindex="-1"></a>        <span class="st">'phno'</span>: [</span>
<span id="cb11-190"><a href="#cb11-190" aria-hidden="true" tabindex="-1"></a>            <span class="st">'Year'</span>, </span>
<span id="cb11-191"><a href="#cb11-191" aria-hidden="true" tabindex="-1"></a>            <span class="st">'Field-Location'</span>, </span>
<span id="cb11-192"><a href="#cb11-192" aria-hidden="true" tabindex="-1"></a>            <span class="st">'State'</span>, </span>
<span id="cb11-193"><a href="#cb11-193" aria-hidden="true" tabindex="-1"></a>            <span class="st">'City'</span>, </span>
<span id="cb11-194"><a href="#cb11-194" aria-hidden="true" tabindex="-1"></a>            <span class="st">'Plot_length_(center-center_in_feet)'</span>, </span>
<span id="cb11-195"><a href="#cb11-195" aria-hidden="true" tabindex="-1"></a>            <span class="st">'Plot_area_(ft2)'</span>, </span>
<span id="cb11-196"><a href="#cb11-196" aria-hidden="true" tabindex="-1"></a>            <span class="st">'Alley_length_(in_inches)'</span>, </span>
<span id="cb11-197"><a href="#cb11-197" aria-hidden="true" tabindex="-1"></a>            <span class="st">'Row_spacing_(in_inches)'</span>, </span>
<span id="cb11-198"><a href="#cb11-198" aria-hidden="true" tabindex="-1"></a>            <span class="st">'Rows_per_plot'</span>, </span>
<span id="cb11-199"><a href="#cb11-199" aria-hidden="true" tabindex="-1"></a>            <span class="st">'#_seed_per_plot'</span>, </span>
<span id="cb11-200"><a href="#cb11-200" aria-hidden="true" tabindex="-1"></a>            <span class="st">'Experiment'</span>, </span>
<span id="cb11-201"><a href="#cb11-201" aria-hidden="true" tabindex="-1"></a>            <span class="st">'Source'</span>, </span>
<span id="cb11-202"><a href="#cb11-202" aria-hidden="true" tabindex="-1"></a>            <span class="st">'Pedigree'</span>, </span>
<span id="cb11-203"><a href="#cb11-203" aria-hidden="true" tabindex="-1"></a>            <span class="st">'Family'</span>, </span>
<span id="cb11-204"><a href="#cb11-204" aria-hidden="true" tabindex="-1"></a>            <span class="st">'Tester'</span>, </span>
<span id="cb11-205"><a href="#cb11-205" aria-hidden="true" tabindex="-1"></a>            <span class="st">'Replicate'</span>, </span>
<span id="cb11-206"><a href="#cb11-206" aria-hidden="true" tabindex="-1"></a>            <span class="st">'Block'</span>, </span>
<span id="cb11-207"><a href="#cb11-207" aria-hidden="true" tabindex="-1"></a>            <span class="st">'Plot'</span>, </span>
<span id="cb11-208"><a href="#cb11-208" aria-hidden="true" tabindex="-1"></a>            <span class="st">'Plot_ID'</span>, </span>
<span id="cb11-209"><a href="#cb11-209" aria-hidden="true" tabindex="-1"></a>            <span class="st">'Range'</span>, </span>
<span id="cb11-210"><a href="#cb11-210" aria-hidden="true" tabindex="-1"></a>            <span class="st">'Pass'</span>, </span>
<span id="cb11-211"><a href="#cb11-211" aria-hidden="true" tabindex="-1"></a>            <span class="st">'Date_plot_planted_[MM/DD/YY]'</span>, </span>
<span id="cb11-212"><a href="#cb11-212" aria-hidden="true" tabindex="-1"></a>            <span class="st">'Date_plot_harvested_[MM/DD/YY]'</span>, </span>
<span id="cb11-213"><a href="#cb11-213" aria-hidden="true" tabindex="-1"></a>            <span class="st">'Anthesis_[MM/DD/YY]'</span>, </span>
<span id="cb11-214"><a href="#cb11-214" aria-hidden="true" tabindex="-1"></a>            <span class="st">'Silking_[MM/DD/YY]'</span>, </span>
<span id="cb11-215"><a href="#cb11-215" aria-hidden="true" tabindex="-1"></a>            <span class="st">'Anthesis_[days]'</span>, </span>
<span id="cb11-216"><a href="#cb11-216" aria-hidden="true" tabindex="-1"></a>            <span class="st">'Silking_[days]'</span>, </span>
<span id="cb11-217"><a href="#cb11-217" aria-hidden="true" tabindex="-1"></a>            <span class="st">'Plant_height_[cm]'</span>, </span>
<span id="cb11-218"><a href="#cb11-218" aria-hidden="true" tabindex="-1"></a>            <span class="st">'Ear_height_[cm]'</span>, </span>
<span id="cb11-219"><a href="#cb11-219" aria-hidden="true" tabindex="-1"></a>            <span class="st">'Stand_count_[#_of_plants]'</span>, </span>
<span id="cb11-220"><a href="#cb11-220" aria-hidden="true" tabindex="-1"></a>            <span class="st">'Root_lodging_[#_of_plants]'</span>, </span>
<span id="cb11-221"><a href="#cb11-221" aria-hidden="true" tabindex="-1"></a>            <span class="st">'Stalk_lodging_[#_of_plants]'</span>, </span>
<span id="cb11-222"><a href="#cb11-222" aria-hidden="true" tabindex="-1"></a>            <span class="st">'Grain_moisture_[%]'</span>, </span>
<span id="cb11-223"><a href="#cb11-223" aria-hidden="true" tabindex="-1"></a>            <span class="st">'Test_weight_[lbs]'</span>, </span>
<span id="cb11-224"><a href="#cb11-224" aria-hidden="true" tabindex="-1"></a>            <span class="st">'Plot_weight_[lbs]'</span>, </span>
<span id="cb11-225"><a href="#cb11-225" aria-hidden="true" tabindex="-1"></a>            <span class="st">'Grain_yield_(bu/A)'</span>, </span>
<span id="cb11-226"><a href="#cb11-226" aria-hidden="true" tabindex="-1"></a>            <span class="st">"Plot_discarded_[enter_'yes'_or_blank]"</span>, </span>
<span id="cb11-227"><a href="#cb11-227" aria-hidden="true" tabindex="-1"></a>            <span class="st">'Comments'</span>, </span>
<span id="cb11-228"><a href="#cb11-228" aria-hidden="true" tabindex="-1"></a>            <span class="st">'Filler'</span>, </span>
<span id="cb11-229"><a href="#cb11-229" aria-hidden="true" tabindex="-1"></a>            <span class="st">'Snap_[#_of_plants]'</span>, </span>
<span id="cb11-230"><a href="#cb11-230" aria-hidden="true" tabindex="-1"></a>            <span class="st">'Kernels/Packet'</span>, </span>
<span id="cb11-231"><a href="#cb11-231" aria-hidden="true" tabindex="-1"></a>            <span class="st">"Filler_[enter_'filler'_or_blank]"</span>, </span>
<span id="cb11-232"><a href="#cb11-232" aria-hidden="true" tabindex="-1"></a>            <span class="st">'Possible_subs'</span>, </span>
<span id="cb11-233"><a href="#cb11-233" aria-hidden="true" tabindex="-1"></a>            <span class="st">'Confirmed_subs'</span>, </span>
<span id="cb11-234"><a href="#cb11-234" aria-hidden="true" tabindex="-1"></a>            <span class="st">'Single_plant_biomass_in_july(g)'</span>, </span>
<span id="cb11-235"><a href="#cb11-235" aria-hidden="true" tabindex="-1"></a>            <span class="st">'Single_plant_biomass_in_august(g)'</span>, </span>
<span id="cb11-236"><a href="#cb11-236" aria-hidden="true" tabindex="-1"></a>            <span class="st">'RootPullingForce(kgf)_july'</span>, </span>
<span id="cb11-237"><a href="#cb11-237" aria-hidden="true" tabindex="-1"></a>            <span class="st">'RootPullingForce(kgf)_august'</span>,</span>
<span id="cb11-238"><a href="#cb11-238" aria-hidden="true" tabindex="-1"></a>            <span class="co">#2018</span></span>
<span id="cb11-239"><a href="#cb11-239" aria-hidden="true" tabindex="-1"></a>            <span class="st">'RecId'</span>, </span>
<span id="cb11-240"><a href="#cb11-240" aria-hidden="true" tabindex="-1"></a>            <span class="st">'Local_check_(Yes,_no)'</span>, </span>
<span id="cb11-241"><a href="#cb11-241" aria-hidden="true" tabindex="-1"></a>            <span class="st">'Plot_length_field'</span>, </span>
<span id="cb11-242"><a href="#cb11-242" aria-hidden="true" tabindex="-1"></a>            <span class="st">'Plot_area'</span>, </span>
<span id="cb11-243"><a href="#cb11-243" aria-hidden="true" tabindex="-1"></a>            <span class="st">'Rows/Plot'</span>, </span>
<span id="cb11-244"><a href="#cb11-244" aria-hidden="true" tabindex="-1"></a>            <span class="st">'Packet/Plot'</span>, </span>
<span id="cb11-245"><a href="#cb11-245" aria-hidden="true" tabindex="-1"></a>            <span class="st">'#_seed'</span>, </span>
<span id="cb11-246"><a href="#cb11-246" aria-hidden="true" tabindex="-1"></a>            <span class="st">'Stand_[%]'</span>, </span>
<span id="cb11-247"><a href="#cb11-247" aria-hidden="true" tabindex="-1"></a>            <span class="st">'Root_lodging_[plants]'</span>, </span>
<span id="cb11-248"><a href="#cb11-248" aria-hidden="true" tabindex="-1"></a>            <span class="st">'Stalk_lodging_[plants]'</span>, </span>
<span id="cb11-249"><a href="#cb11-249" aria-hidden="true" tabindex="-1"></a>            <span class="st">'Plot_discarded_[enter_"Yes"_or_"blank"]'</span>, </span>
<span id="cb11-250"><a href="#cb11-250" aria-hidden="true" tabindex="-1"></a>            <span class="st">'Filler_[enter_"filler"_or_"blank"]'</span>, </span>
<span id="cb11-251"><a href="#cb11-251" aria-hidden="true" tabindex="-1"></a>            <span class="st">'[add_additional_measurements_here]'</span>,</span>
<span id="cb11-252"><a href="#cb11-252" aria-hidden="true" tabindex="-1"></a>            <span class="co">#2016</span></span>
<span id="cb11-253"><a href="#cb11-253" aria-hidden="true" tabindex="-1"></a>            <span class="st">'RecId'</span>, </span>
<span id="cb11-254"><a href="#cb11-254" aria-hidden="true" tabindex="-1"></a>            <span class="st">'Plot_area'</span>, </span>
<span id="cb11-255"><a href="#cb11-255" aria-hidden="true" tabindex="-1"></a>            <span class="st">'Rows/Plot'</span>, </span>
<span id="cb11-256"><a href="#cb11-256" aria-hidden="true" tabindex="-1"></a>            <span class="st">'Packet/Plot'</span>, </span>
<span id="cb11-257"><a href="#cb11-257" aria-hidden="true" tabindex="-1"></a>            <span class="st">'Kernels/Packet'</span>, </span>
<span id="cb11-258"><a href="#cb11-258" aria-hidden="true" tabindex="-1"></a>            <span class="st">'#_seed'</span>, </span>
<span id="cb11-259"><a href="#cb11-259" aria-hidden="true" tabindex="-1"></a>            <span class="st">'Plot_length_(center-alley_to_center-alley_in_feet)'</span>, </span>
<span id="cb11-260"><a href="#cb11-260" aria-hidden="true" tabindex="-1"></a>            <span class="st">'Additional_measurements'</span>,</span>
<span id="cb11-261"><a href="#cb11-261" aria-hidden="true" tabindex="-1"></a>            <span class="co">#2015</span></span>
<span id="cb11-262"><a href="#cb11-262" aria-hidden="true" tabindex="-1"></a>            <span class="st">'Alley_length_(in_feet)'</span></span>
<span id="cb11-263"><a href="#cb11-263" aria-hidden="true" tabindex="-1"></a>        ], </span>
<span id="cb11-264"><a href="#cb11-264" aria-hidden="true" tabindex="-1"></a>        <span class="st">'geno'</span>: [], </span>
<span id="cb11-265"><a href="#cb11-265" aria-hidden="true" tabindex="-1"></a>        <span class="st">'wthr'</span>: [</span>
<span id="cb11-266"><a href="#cb11-266" aria-hidden="true" tabindex="-1"></a>            <span class="st">'Field_location'</span>, </span>
<span id="cb11-267"><a href="#cb11-267" aria-hidden="true" tabindex="-1"></a>            <span class="st">'Station_ID'</span>, </span>
<span id="cb11-268"><a href="#cb11-268" aria-hidden="true" tabindex="-1"></a>            <span class="st">'NWS_network'</span>, </span>
<span id="cb11-269"><a href="#cb11-269" aria-hidden="true" tabindex="-1"></a>            <span class="st">'NWS_station'</span>, </span>
<span id="cb11-270"><a href="#cb11-270" aria-hidden="true" tabindex="-1"></a>            <span class="st">'Date_key'</span>, </span>
<span id="cb11-271"><a href="#cb11-271" aria-hidden="true" tabindex="-1"></a>            <span class="st">'Month'</span>, </span>
<span id="cb11-272"><a href="#cb11-272" aria-hidden="true" tabindex="-1"></a>            <span class="st">'Day'</span>, </span>
<span id="cb11-273"><a href="#cb11-273" aria-hidden="true" tabindex="-1"></a>            <span class="st">'Year'</span>, </span>
<span id="cb11-274"><a href="#cb11-274" aria-hidden="true" tabindex="-1"></a>            <span class="st">'Time'</span>, </span>
<span id="cb11-275"><a href="#cb11-275" aria-hidden="true" tabindex="-1"></a>            <span class="st">'Temperature_[C]'</span>, </span>
<span id="cb11-276"><a href="#cb11-276" aria-hidden="true" tabindex="-1"></a>            <span class="st">'Dew_point_[C]'</span>, </span>
<span id="cb11-277"><a href="#cb11-277" aria-hidden="true" tabindex="-1"></a>            <span class="st">'Relative_humidity_[%]'</span>, </span>
<span id="cb11-278"><a href="#cb11-278" aria-hidden="true" tabindex="-1"></a>            <span class="st">'Solar_radiation_[W/m2]'</span>, </span>
<span id="cb11-279"><a href="#cb11-279" aria-hidden="true" tabindex="-1"></a>            <span class="st">'Rainfall_[mm]'</span>, </span>
<span id="cb11-280"><a href="#cb11-280" aria-hidden="true" tabindex="-1"></a>            <span class="st">'Wind_speed_[m/s]'</span>, </span>
<span id="cb11-281"><a href="#cb11-281" aria-hidden="true" tabindex="-1"></a>            <span class="st">'Wind_direction_[degrees]'</span>, </span>
<span id="cb11-282"><a href="#cb11-282" aria-hidden="true" tabindex="-1"></a>            <span class="st">'Wind_gust_[m/s]'</span>, </span>
<span id="cb11-283"><a href="#cb11-283" aria-hidden="true" tabindex="-1"></a>            <span class="st">'Soil_temperature_[C]'</span>, </span>
<span id="cb11-284"><a href="#cb11-284" aria-hidden="true" tabindex="-1"></a>            <span class="st">'Soil_moisture_[%VWC]'</span>, </span>
<span id="cb11-285"><a href="#cb11-285" aria-hidden="true" tabindex="-1"></a>            <span class="st">'Soil_eC_[mS/cm]'</span>, </span>
<span id="cb11-286"><a href="#cb11-286" aria-hidden="true" tabindex="-1"></a>            <span class="st">'UV_light_[uM/m2s]'</span>, </span>
<span id="cb11-287"><a href="#cb11-287" aria-hidden="true" tabindex="-1"></a>            <span class="st">'PAR_[uM/m2s]'</span>,</span>
<span id="cb11-288"><a href="#cb11-288" aria-hidden="true" tabindex="-1"></a>            <span class="co"># 2020</span></span>
<span id="cb11-289"><a href="#cb11-289" aria-hidden="true" tabindex="-1"></a>            <span class="st">'CO2_[ppm]'</span>, </span>
<span id="cb11-290"><a href="#cb11-290" aria-hidden="true" tabindex="-1"></a>            <span class="co"># 2018</span></span>
<span id="cb11-291"><a href="#cb11-291" aria-hidden="true" tabindex="-1"></a>            <span class="st">'Photoperiod_[hours]'</span>,</span>
<span id="cb11-292"><a href="#cb11-292" aria-hidden="true" tabindex="-1"></a>            <span class="st">'Column_altered'</span>, </span>
<span id="cb11-293"><a href="#cb11-293" aria-hidden="true" tabindex="-1"></a>            <span class="st">'Altered_column_names'</span>, </span>
<span id="cb11-294"><a href="#cb11-294" aria-hidden="true" tabindex="-1"></a>            <span class="st">'Cleaning_method'</span>, </span>
<span id="cb11-295"><a href="#cb11-295" aria-hidden="true" tabindex="-1"></a>            <span class="st">'Comment'</span>,</span>
<span id="cb11-296"><a href="#cb11-296" aria-hidden="true" tabindex="-1"></a>            <span class="co"># 2015</span></span>
<span id="cb11-297"><a href="#cb11-297" aria-hidden="true" tabindex="-1"></a>            <span class="st">'Record_number'</span>, <span class="st">'Location(s)'</span>, <span class="st">'DOY'</span>, <span class="st">'Datetime_[UTC]'</span>,</span>
<span id="cb11-298"><a href="#cb11-298" aria-hidden="true" tabindex="-1"></a>            <span class="co"># 2014</span></span>
<span id="cb11-299"><a href="#cb11-299" aria-hidden="true" tabindex="-1"></a>            <span class="st">'DOY'</span></span>
<span id="cb11-300"><a href="#cb11-300" aria-hidden="true" tabindex="-1"></a>        ], </span>
<span id="cb11-301"><a href="#cb11-301" aria-hidden="true" tabindex="-1"></a>        <span class="st">'soil'</span>: [</span>
<span id="cb11-302"><a href="#cb11-302" aria-hidden="true" tabindex="-1"></a>            <span class="st">'Grower'</span>, </span>
<span id="cb11-303"><a href="#cb11-303" aria-hidden="true" tabindex="-1"></a>            <span class="st">'Location'</span>, </span>
<span id="cb11-304"><a href="#cb11-304" aria-hidden="true" tabindex="-1"></a>            <span class="st">'Date_received'</span>, </span>
<span id="cb11-305"><a href="#cb11-305" aria-hidden="true" tabindex="-1"></a>            <span class="st">'Date_reported'</span>, </span>
<span id="cb11-306"><a href="#cb11-306" aria-hidden="true" tabindex="-1"></a>            <span class="st">'E_depth'</span>, </span>
<span id="cb11-307"><a href="#cb11-307" aria-hidden="true" tabindex="-1"></a>            <span class="st">'1:1_soil_pH'</span>, </span>
<span id="cb11-308"><a href="#cb11-308" aria-hidden="true" tabindex="-1"></a>            <span class="st">'WDRF_buffer_pH'</span>, </span>
<span id="cb11-309"><a href="#cb11-309" aria-hidden="true" tabindex="-1"></a>            <span class="st">'1:1_S_salts_mmho/cm'</span>, </span>
<span id="cb11-310"><a href="#cb11-310" aria-hidden="true" tabindex="-1"></a>            <span class="st">'Texture_no'</span>, </span>
<span id="cb11-311"><a href="#cb11-311" aria-hidden="true" tabindex="-1"></a>            <span class="st">'Organic_matter_LOI%'</span>, </span>
<span id="cb11-312"><a href="#cb11-312" aria-hidden="true" tabindex="-1"></a>            <span class="st">'Nitrate-N_ppm_N'</span>, </span>
<span id="cb11-313"><a href="#cb11-313" aria-hidden="true" tabindex="-1"></a>            <span class="st">'Lbs_N/A'</span>, </span>
<span id="cb11-314"><a href="#cb11-314" aria-hidden="true" tabindex="-1"></a>            <span class="st">'Potassium_ppm_K'</span>, </span>
<span id="cb11-315"><a href="#cb11-315" aria-hidden="true" tabindex="-1"></a>            <span class="st">'Sulfate-S_ppm_S'</span>, </span>
<span id="cb11-316"><a href="#cb11-316" aria-hidden="true" tabindex="-1"></a>            <span class="st">'Calcium_ppm_Ca'</span>, </span>
<span id="cb11-317"><a href="#cb11-317" aria-hidden="true" tabindex="-1"></a>            <span class="st">'Magnesium_ppm_Mg'</span>, </span>
<span id="cb11-318"><a href="#cb11-318" aria-hidden="true" tabindex="-1"></a>            <span class="st">'Sodium_ppm_Na'</span>, </span>
<span id="cb11-319"><a href="#cb11-319" aria-hidden="true" tabindex="-1"></a>            <span class="st">'CEC/Sum_of_cations_me/100g'</span>, </span>
<span id="cb11-320"><a href="#cb11-320" aria-hidden="true" tabindex="-1"></a>            <span class="st">'%H_sat'</span>, </span>
<span id="cb11-321"><a href="#cb11-321" aria-hidden="true" tabindex="-1"></a>            <span class="st">'%K_sat'</span>, </span>
<span id="cb11-322"><a href="#cb11-322" aria-hidden="true" tabindex="-1"></a>            <span class="st">'%Ca_sat'</span>, </span>
<span id="cb11-323"><a href="#cb11-323" aria-hidden="true" tabindex="-1"></a>            <span class="st">'%Mg_sat'</span>, </span>
<span id="cb11-324"><a href="#cb11-324" aria-hidden="true" tabindex="-1"></a>            <span class="st">'%Na_sat'</span>, </span>
<span id="cb11-325"><a href="#cb11-325" aria-hidden="true" tabindex="-1"></a>            <span class="st">'Mehlich_P-III_ppm_P'</span>, </span>
<span id="cb11-326"><a href="#cb11-326" aria-hidden="true" tabindex="-1"></a>            <span class="st">'%Sand'</span>, </span>
<span id="cb11-327"><a href="#cb11-327" aria-hidden="true" tabindex="-1"></a>            <span class="st">'%Silt'</span>, </span>
<span id="cb11-328"><a href="#cb11-328" aria-hidden="true" tabindex="-1"></a>            <span class="st">'%Clay'</span>, </span>
<span id="cb11-329"><a href="#cb11-329" aria-hidden="true" tabindex="-1"></a>            <span class="st">'Texture'</span>, </span>
<span id="cb11-330"><a href="#cb11-330" aria-hidden="true" tabindex="-1"></a>            <span class="st">'Comments'</span>,</span>
<span id="cb11-331"><a href="#cb11-331" aria-hidden="true" tabindex="-1"></a>            <span class="co">#2016</span></span>
<span id="cb11-332"><a href="#cb11-332" aria-hidden="true" tabindex="-1"></a>            <span class="st">'Zinc_ppm_Zn'</span>, <span class="st">'Iron_ppm_Fe'</span>, <span class="st">'Manganese_ppm_Mn'</span>, <span class="st">'Copper_ppm_Cu'</span>, <span class="st">'Boron_ppm_B'</span>,</span>
<span id="cb11-333"><a href="#cb11-333" aria-hidden="true" tabindex="-1"></a>            <span class="co"># 2015</span></span>
<span id="cb11-334"><a href="#cb11-334" aria-hidden="true" tabindex="-1"></a>            <span class="st">'Lab_id'</span>, </span>
<span id="cb11-335"><a href="#cb11-335" aria-hidden="true" tabindex="-1"></a>            <span class="st">'Lab_sample_id'</span>, </span>
<span id="cb11-336"><a href="#cb11-336" aria-hidden="true" tabindex="-1"></a>            <span class="st">'Date_Collected'</span>, </span>
<span id="cb11-337"><a href="#cb11-337" aria-hidden="true" tabindex="-1"></a>            <span class="st">'Cooperator'</span>, </span>
<span id="cb11-338"><a href="#cb11-338" aria-hidden="true" tabindex="-1"></a>            <span class="st">'Plow_depth'</span>, </span>
<span id="cb11-339"><a href="#cb11-339" aria-hidden="true" tabindex="-1"></a>            <span class="st">'PH'</span>, </span>
<span id="cb11-340"><a href="#cb11-340" aria-hidden="true" tabindex="-1"></a>            <span class="st">'BpH'</span>, </span>
<span id="cb11-341"><a href="#cb11-341" aria-hidden="true" tabindex="-1"></a>            <span class="st">'OM'</span>, </span>
<span id="cb11-342"><a href="#cb11-342" aria-hidden="true" tabindex="-1"></a>            <span class="st">'P'</span>, </span>
<span id="cb11-343"><a href="#cb11-343" aria-hidden="true" tabindex="-1"></a>            <span class="st">'K'</span></span>
<span id="cb11-344"><a href="#cb11-344" aria-hidden="true" tabindex="-1"></a>        ], </span>
<span id="cb11-345"><a href="#cb11-345" aria-hidden="true" tabindex="-1"></a>        <span class="st">'mgmt'</span>: [</span>
<span id="cb11-346"><a href="#cb11-346" aria-hidden="true" tabindex="-1"></a>            <span class="st">'Location'</span>, </span>
<span id="cb11-347"><a href="#cb11-347" aria-hidden="true" tabindex="-1"></a>            <span class="st">'Application_or_treatment'</span>, </span>
<span id="cb11-348"><a href="#cb11-348" aria-hidden="true" tabindex="-1"></a>            <span class="st">'Product_or_nutrient_applied'</span>, </span>
<span id="cb11-349"><a href="#cb11-349" aria-hidden="true" tabindex="-1"></a>            <span class="st">'Date_of_application'</span>, </span>
<span id="cb11-350"><a href="#cb11-350" aria-hidden="true" tabindex="-1"></a>            <span class="st">'Quantity_per_acre'</span>, </span>
<span id="cb11-351"><a href="#cb11-351" aria-hidden="true" tabindex="-1"></a>            <span class="st">'Application_unit'</span>,</span>
<span id="cb11-352"><a href="#cb11-352" aria-hidden="true" tabindex="-1"></a>            <span class="co"># 2015</span></span>
<span id="cb11-353"><a href="#cb11-353" aria-hidden="true" tabindex="-1"></a>            <span class="st">'Irrigation/Fertigation_(yes/no)'</span>, </span>
<span id="cb11-354"><a href="#cb11-354" aria-hidden="true" tabindex="-1"></a>            <span class="st">'Weather_station_documents_irrigation?_(yes/no)'</span>, </span>
<span id="cb11-355"><a href="#cb11-355" aria-hidden="true" tabindex="-1"></a>            <span class="st">'Nutrients_applied'</span>, </span>
<span id="cb11-356"><a href="#cb11-356" aria-hidden="true" tabindex="-1"></a>            <span class="st">'Notes'</span></span>
<span id="cb11-357"><a href="#cb11-357" aria-hidden="true" tabindex="-1"></a>        ]</span>
<span id="cb11-358"><a href="#cb11-358" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb11-359"><a href="#cb11-359" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-360"><a href="#cb11-360" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-361"><a href="#cb11-361" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-362"><a href="#cb11-362" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-363"><a href="#cb11-363" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-364"><a href="#cb11-364" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-365"><a href="#cb11-365" aria-hidden="true" tabindex="-1"></a>        expected_cols_lol <span class="op">=</span> [expected_cols_dict[e] <span class="cf">for</span> e <span class="kw">in</span> <span class="bu">list</span>(expected_cols_dict.keys())]</span>
<span id="cb11-366"><a href="#cb11-366" aria-hidden="true" tabindex="-1"></a>        <span class="kw">def</span> _flatten_lol(lol): <span class="cf">return</span> [item <span class="cf">for</span> listWithin <span class="kw">in</span> lol <span class="cf">for</span> item <span class="kw">in</span> listWithin]</span>
<span id="cb11-367"><a href="#cb11-367" aria-hidden="true" tabindex="-1"></a>        expected_cols_all <span class="op">=</span> _flatten_lol(expected_cols_lol)</span>
<span id="cb11-368"><a href="#cb11-368" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb11-369"><a href="#cb11-369" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> entry <span class="kw">in</span> [<span class="st">'meta'</span>, <span class="st">'phno'</span>, <span class="st">'geno'</span>, <span class="st">'wthr'</span>, <span class="st">'soil'</span>, <span class="st">'mgmt'</span>]:</span>
<span id="cb11-370"><a href="#cb11-370" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> <span class="bu">type</span>(<span class="bu">getattr</span>(<span class="va">self</span>,  entry).data) <span class="op">==</span> <span class="bu">type</span>(<span class="va">None</span>):</span>
<span id="cb11-371"><a href="#cb11-371" aria-hidden="true" tabindex="-1"></a>                <span class="bu">print</span>(entry<span class="op">+</span><span class="st">" is not initialized and None type."</span>)</span>
<span id="cb11-372"><a href="#cb11-372" aria-hidden="true" tabindex="-1"></a>            <span class="cf">else</span>:</span>
<span id="cb11-373"><a href="#cb11-373" aria-hidden="true" tabindex="-1"></a>                expected_cols <span class="op">=</span> expected_cols_dict[entry]</span>
<span id="cb11-374"><a href="#cb11-374" aria-hidden="true" tabindex="-1"></a>                found_cols <span class="op">=</span> <span class="bu">list</span>(<span class="bu">getattr</span>(<span class="va">self</span>,  entry).data.columns)</span>
<span id="cb11-375"><a href="#cb11-375" aria-hidden="true" tabindex="-1"></a>                </span>
<span id="cb11-376"><a href="#cb11-376" aria-hidden="true" tabindex="-1"></a>                unexpected_cols <span class="op">=</span> [e <span class="cf">for</span> e <span class="kw">in</span> found_cols <span class="cf">if</span> e <span class="kw">not</span> <span class="kw">in</span> expected_cols]</span>
<span id="cb11-377"><a href="#cb11-377" aria-hidden="true" tabindex="-1"></a>                unexpected_cols_all <span class="op">=</span> [e <span class="cf">for</span> e <span class="kw">in</span> unexpected_cols <span class="cf">if</span> e <span class="kw">not</span> <span class="kw">in</span> expected_cols_all]</span>
<span id="cb11-378"><a href="#cb11-378" aria-hidden="true" tabindex="-1"></a>                </span>
<span id="cb11-379"><a href="#cb11-379" aria-hidden="true" tabindex="-1"></a>                <span class="cf">if</span> unexpected_cols <span class="op">!=</span> []:</span>
<span id="cb11-380"><a href="#cb11-380" aria-hidden="true" tabindex="-1"></a>                    <span class="bu">print</span>(<span class="st">"Unexpected in "</span><span class="op">+</span>entry)</span>
<span id="cb11-381"><a href="#cb11-381" aria-hidden="true" tabindex="-1"></a>                    <span class="bu">print</span>(unexpected_cols)</span>
<span id="cb11-382"><a href="#cb11-382" aria-hidden="true" tabindex="-1"></a>                <span class="cf">if</span> unexpected_cols_all <span class="op">!=</span> []:</span>
<span id="cb11-383"><a href="#cb11-383" aria-hidden="true" tabindex="-1"></a>                    <span class="bu">print</span>(<span class="st">"Unexpected in any table"</span>)</span>
<span id="cb11-384"><a href="#cb11-384" aria-hidden="true" tabindex="-1"></a>                    <span class="bu">print</span>(unexpected_cols_all)</span>
<span id="cb11-385"><a href="#cb11-385" aria-hidden="true" tabindex="-1"></a>                    </span>
<span id="cb11-386"><a href="#cb11-386" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb11-387"><a href="#cb11-387" aria-hidden="true" tabindex="-1"></a>    <span class="co"># This is a function I expect to be overwritten with year specific subclasses.</span></span>
<span id="cb11-388"><a href="#cb11-388" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Year specific naming conventions will likely require case by case handling   </span></span>
<span id="cb11-389"><a href="#cb11-389" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> standardize_all_transformed_names(<span class="va">self</span>, entry):</span>
<span id="cb11-390"><a href="#cb11-390" aria-hidden="true" tabindex="-1"></a>        <span class="cf">pass</span></span>
<span id="cb11-391"><a href="#cb11-391" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb11-392"><a href="#cb11-392" aria-hidden="true" tabindex="-1"></a><span class="co">#     def standardize_all_cols(self):</span></span>
<span id="cb11-393"><a href="#cb11-393" aria-hidden="true" tabindex="-1"></a><span class="co">#         for entry in ['meta', 'phno', 'geno', 'wthr', 'soil', 'mgmt']:</span></span>
<span id="cb11-394"><a href="#cb11-394" aria-hidden="true" tabindex="-1"></a><span class="co">#             if type(getattr(self,  entry).data) == type(None):</span></span>
<span id="cb11-395"><a href="#cb11-395" aria-hidden="true" tabindex="-1"></a><span class="co">#                 print(entry+" is not initialized and None type.")</span></span>
<span id="cb11-396"><a href="#cb11-396" aria-hidden="true" tabindex="-1"></a><span class="co">#             else:</span></span>
<span id="cb11-397"><a href="#cb11-397" aria-hidden="true" tabindex="-1"></a><span class="co">#                 self.rename_id_cols(entry = entry)</span></span>
<span id="cb11-398"><a href="#cb11-398" aria-hidden="true" tabindex="-1"></a><span class="co">#                 print(entry+" ids renamed.")  </span></span>
<span id="cb11-399"><a href="#cb11-399" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb11-400"><a href="#cb11-400" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb11-401"><a href="#cb11-401" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb11-402"><a href="#cb11-402" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> add_year_col_to_all(<span class="va">self</span>):</span>
<span id="cb11-403"><a href="#cb11-403" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> entry <span class="kw">in</span> [<span class="st">'meta'</span>, <span class="st">'phno'</span>, <span class="st">'geno'</span>, <span class="st">'wthr'</span>, <span class="st">'soil'</span>, <span class="st">'mgmt'</span>]:</span>
<span id="cb11-404"><a href="#cb11-404" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> <span class="bu">type</span>(<span class="bu">getattr</span>(<span class="va">self</span>,  entry).data) <span class="op">==</span> <span class="bu">type</span>(<span class="va">None</span>):</span>
<span id="cb11-405"><a href="#cb11-405" aria-hidden="true" tabindex="-1"></a>                <span class="bu">print</span>(entry<span class="op">+</span><span class="st">" is not initialized and None type."</span>)</span>
<span id="cb11-406"><a href="#cb11-406" aria-hidden="true" tabindex="-1"></a>            <span class="cf">else</span>:</span>
<span id="cb11-407"><a href="#cb11-407" aria-hidden="true" tabindex="-1"></a>                <span class="bu">getattr</span>(<span class="va">self</span>,  entry).data.loc[:, <span class="st">"Year"</span>] <span class="op">=</span> <span class="va">self</span>.year</span>
<span id="cb11-408"><a href="#cb11-408" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb11-409"><a href="#cb11-409" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb11-410"><a href="#cb11-410" aria-hidden="true" tabindex="-1"></a>    <span class="co"># This is a function I expect to be overwritten with year specific subclasses.</span></span>
<span id="cb11-411"><a href="#cb11-411" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Year specific naming conventions will likely require case by case handling</span></span>
<span id="cb11-412"><a href="#cb11-412" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> rename_id_cols(<span class="va">self</span>, entry):</span>
<span id="cb11-413"><a href="#cb11-413" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="bu">type</span>(<span class="bu">getattr</span>(<span class="va">self</span>,  entry).data) <span class="op">==</span> <span class="bu">type</span>(<span class="va">None</span>):</span>
<span id="cb11-414"><a href="#cb11-414" aria-hidden="true" tabindex="-1"></a>            <span class="bu">print</span>(entry<span class="op">+</span><span class="st">" is not initialized and None type."</span>)</span>
<span id="cb11-415"><a href="#cb11-415" aria-hidden="true" tabindex="-1"></a>        <span class="cf">else</span>:</span>
<span id="cb11-416"><a href="#cb11-416" aria-hidden="true" tabindex="-1"></a>            rename_id_dict <span class="op">=</span> {}</span>
<span id="cb11-417"><a href="#cb11-417" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb11-418"><a href="#cb11-418" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> entry <span class="op">==</span> <span class="st">"meta"</span>:</span>
<span id="cb11-419"><a href="#cb11-419" aria-hidden="true" tabindex="-1"></a>                rename_id_dict.update({</span>
<span id="cb11-420"><a href="#cb11-420" aria-hidden="true" tabindex="-1"></a>                    <span class="st">'Experiment_code'</span>: <span class="st">'Location'</span></span>
<span id="cb11-421"><a href="#cb11-421" aria-hidden="true" tabindex="-1"></a>                })</span>
<span id="cb11-422"><a href="#cb11-422" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> entry <span class="op">==</span> <span class="st">"phno"</span>:</span>
<span id="cb11-423"><a href="#cb11-423" aria-hidden="true" tabindex="-1"></a>                rename_id_dict.update({</span>
<span id="cb11-424"><a href="#cb11-424" aria-hidden="true" tabindex="-1"></a>                    <span class="st">'Field-Location'</span>:<span class="st">'Location'</span>,</span>
<span id="cb11-425"><a href="#cb11-425" aria-hidden="true" tabindex="-1"></a>                    <span class="st">'Replicate'</span>:<span class="st">'Replication'</span></span>
<span id="cb11-426"><a href="#cb11-426" aria-hidden="true" tabindex="-1"></a>                })</span>
<span id="cb11-427"><a href="#cb11-427" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> entry <span class="op">==</span> <span class="st">"wthr"</span>:</span>
<span id="cb11-428"><a href="#cb11-428" aria-hidden="true" tabindex="-1"></a>                rename_id_dict.update({</span>
<span id="cb11-429"><a href="#cb11-429" aria-hidden="true" tabindex="-1"></a>                    <span class="st">'Field_location'</span>:<span class="st">'Location'</span> ,</span>
<span id="cb11-430"><a href="#cb11-430" aria-hidden="true" tabindex="-1"></a>                    <span class="st">'Date_key'</span>:<span class="st">'Date_Time'</span></span>
<span id="cb11-431"><a href="#cb11-431" aria-hidden="true" tabindex="-1"></a>                })</span>
<span id="cb11-432"><a href="#cb11-432" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> entry <span class="op">==</span> <span class="st">"soil"</span>:</span>
<span id="cb11-433"><a href="#cb11-433" aria-hidden="true" tabindex="-1"></a>                <span class="cf">pass</span></span>
<span id="cb11-434"><a href="#cb11-434" aria-hidden="true" tabindex="-1"></a><span class="co">#                 rename_id_dict = rename_id_dict.update({</span></span>
<span id="cb11-435"><a href="#cb11-435" aria-hidden="true" tabindex="-1"></a>                     </span>
<span id="cb11-436"><a href="#cb11-436" aria-hidden="true" tabindex="-1"></a><span class="co">#                 })</span></span>
<span id="cb11-437"><a href="#cb11-437" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> entry <span class="op">==</span> <span class="st">"mgmt"</span>:</span>
<span id="cb11-438"><a href="#cb11-438" aria-hidden="true" tabindex="-1"></a>                rename_id_dict.update({</span>
<span id="cb11-439"><a href="#cb11-439" aria-hidden="true" tabindex="-1"></a>                    <span class="co">#'Location': '', </span></span>
<span id="cb11-440"><a href="#cb11-440" aria-hidden="true" tabindex="-1"></a>                    <span class="st">'Application_or_treatment'</span>: <span class="st">'Application'</span>, </span>
<span id="cb11-441"><a href="#cb11-441" aria-hidden="true" tabindex="-1"></a>                    <span class="st">'Product_or_nutrient_applied'</span>: <span class="st">'Product'</span>,  </span>
<span id="cb11-442"><a href="#cb11-442" aria-hidden="true" tabindex="-1"></a>                    <span class="st">'Date_of_application'</span>: <span class="st">'Date'</span>, </span>
<span id="cb11-443"><a href="#cb11-443" aria-hidden="true" tabindex="-1"></a>                    <span class="st">'Quantity_per_acre'</span>: <span class="st">'Quantity/acre'</span>, </span>
<span id="cb11-444"><a href="#cb11-444" aria-hidden="true" tabindex="-1"></a>                    <span class="st">'Application_unit'</span>: <span class="st">'Unit'</span></span>
<span id="cb11-445"><a href="#cb11-445" aria-hidden="true" tabindex="-1"></a>                })</span>
<span id="cb11-446"><a href="#cb11-446" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb11-447"><a href="#cb11-447" aria-hidden="true" tabindex="-1"></a>            <span class="bu">getattr</span>(<span class="va">self</span>,  entry).data <span class="op">=</span> <span class="bu">getattr</span>(<span class="va">self</span>,  entry).data.rename(columns <span class="op">=</span> rename_id_dict)</span>
<span id="cb11-448"><a href="#cb11-448" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb11-449"><a href="#cb11-449" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> rename_all_id_cols(<span class="va">self</span>):</span>
<span id="cb11-450"><a href="#cb11-450" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> entry <span class="kw">in</span> [<span class="st">'meta'</span>, <span class="st">'phno'</span>, <span class="st">'geno'</span>, <span class="st">'wthr'</span>, <span class="st">'soil'</span>, <span class="st">'mgmt'</span>]:</span>
<span id="cb11-451"><a href="#cb11-451" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> <span class="bu">type</span>(<span class="bu">getattr</span>(<span class="va">self</span>,  entry).data) <span class="op">==</span> <span class="bu">type</span>(<span class="va">None</span>):</span>
<span id="cb11-452"><a href="#cb11-452" aria-hidden="true" tabindex="-1"></a>                <span class="bu">print</span>(entry<span class="op">+</span><span class="st">" is not initialized and None type."</span>)</span>
<span id="cb11-453"><a href="#cb11-453" aria-hidden="true" tabindex="-1"></a>            <span class="cf">else</span>:</span>
<span id="cb11-454"><a href="#cb11-454" aria-hidden="true" tabindex="-1"></a>                <span class="va">self</span>.rename_id_cols(entry <span class="op">=</span> entry)</span>
<span id="cb11-455"><a href="#cb11-455" aria-hidden="true" tabindex="-1"></a>                <span class="bu">print</span>(entry<span class="op">+</span><span class="st">" ids renamed."</span>)        </span>
<span id="cb11-456"><a href="#cb11-456" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb11-457"><a href="#cb11-457" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> check_for_id_cols(<span class="va">self</span>):</span>
<span id="cb11-458"><a href="#cb11-458" aria-hidden="true" tabindex="-1"></a>        expected_ids_dict <span class="op">=</span> {</span>
<span id="cb11-459"><a href="#cb11-459" aria-hidden="true" tabindex="-1"></a>            <span class="st">'meta'</span>: [<span class="st">'Year'</span>, <span class="st">'Location'</span>                           ], </span>
<span id="cb11-460"><a href="#cb11-460" aria-hidden="true" tabindex="-1"></a>            <span class="st">'phno'</span>: [<span class="st">'Year'</span>, <span class="st">'Location'</span>, <span class="st">'Pedigree'</span>, <span class="st">'Replication'</span>],</span>
<span id="cb11-461"><a href="#cb11-461" aria-hidden="true" tabindex="-1"></a>            <span class="st">'geno'</span>: [], </span>
<span id="cb11-462"><a href="#cb11-462" aria-hidden="true" tabindex="-1"></a>            <span class="st">'wthr'</span>: [<span class="st">'Year'</span>, <span class="st">'Location'</span>, <span class="st">'Date_Time'</span>   ],</span>
<span id="cb11-463"><a href="#cb11-463" aria-hidden="true" tabindex="-1"></a>            <span class="st">'soil'</span>: [<span class="st">'Year'</span>, <span class="st">'Location'</span>                           ],</span>
<span id="cb11-464"><a href="#cb11-464" aria-hidden="true" tabindex="-1"></a>            <span class="st">'mgmt'</span>: [<span class="st">'Year'</span>, <span class="st">'Location'</span>, <span class="st">'Date'</span>,           <span class="st">'Product'</span>]</span>
<span id="cb11-465"><a href="#cb11-465" aria-hidden="true" tabindex="-1"></a>        }</span>
<span id="cb11-466"><a href="#cb11-466" aria-hidden="true" tabindex="-1"></a>        expected_cols_lol <span class="op">=</span> [expected_ids_dict[e] <span class="cf">for</span> e <span class="kw">in</span> <span class="bu">list</span>(expected_ids_dict.keys())]</span>
<span id="cb11-467"><a href="#cb11-467" aria-hidden="true" tabindex="-1"></a>        <span class="kw">def</span> _flatten_lol(lol): <span class="cf">return</span> [item <span class="cf">for</span> listWithin <span class="kw">in</span> lol <span class="cf">for</span> item <span class="kw">in</span> listWithin]</span>
<span id="cb11-468"><a href="#cb11-468" aria-hidden="true" tabindex="-1"></a>        expected_cols_all <span class="op">=</span> _flatten_lol(expected_cols_lol)</span>
<span id="cb11-469"><a href="#cb11-469" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb11-470"><a href="#cb11-470" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> entry <span class="kw">in</span> [<span class="st">'meta'</span>, <span class="st">'phno'</span>, <span class="st">'geno'</span>, <span class="st">'wthr'</span>, <span class="st">'soil'</span>, <span class="st">'mgmt'</span>]:</span>
<span id="cb11-471"><a href="#cb11-471" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> <span class="bu">type</span>(<span class="bu">getattr</span>(<span class="va">self</span>,  entry).data) <span class="op">==</span> <span class="bu">type</span>(<span class="va">None</span>):</span>
<span id="cb11-472"><a href="#cb11-472" aria-hidden="true" tabindex="-1"></a>                <span class="bu">print</span>(entry<span class="op">+</span><span class="st">" is not initialized and None type."</span>)</span>
<span id="cb11-473"><a href="#cb11-473" aria-hidden="true" tabindex="-1"></a>            <span class="cf">else</span>:</span>
<span id="cb11-474"><a href="#cb11-474" aria-hidden="true" tabindex="-1"></a>                expected_but_not_found <span class="op">=</span> [e <span class="cf">for</span> e <span class="kw">in</span> expected_ids_dict[entry] <span class="cf">if</span> e <span class="kw">not</span> <span class="kw">in</span> <span class="bu">getattr</span>(<span class="va">self</span>,  entry).data.columns]</span>
<span id="cb11-475"><a href="#cb11-475" aria-hidden="true" tabindex="-1"></a>                <span class="cf">if</span> expected_but_not_found <span class="op">==</span> []:</span>
<span id="cb11-476"><a href="#cb11-476" aria-hidden="true" tabindex="-1"></a>                    <span class="cf">pass</span></span>
<span id="cb11-477"><a href="#cb11-477" aria-hidden="true" tabindex="-1"></a>                    <span class="co">#print('No missing id columns')</span></span>
<span id="cb11-478"><a href="#cb11-478" aria-hidden="true" tabindex="-1"></a>                <span class="cf">else</span>:</span>
<span id="cb11-479"><a href="#cb11-479" aria-hidden="true" tabindex="-1"></a>                    <span class="bu">print</span>(entry)</span>
<span id="cb11-480"><a href="#cb11-480" aria-hidden="true" tabindex="-1"></a>                    <span class="bu">print</span>(<span class="st">'Missing id columns: "'</span><span class="op">+</span><span class="st">'", "'</span>.join(expected_but_not_found)<span class="op">+</span><span class="st">'"'</span>)  </span>
<span id="cb11-481"><a href="#cb11-481" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb11-482"><a href="#cb11-482" aria-hidden="true" tabindex="-1"></a>                </span>
<span id="cb11-483"><a href="#cb11-483" aria-hidden="true" tabindex="-1"></a>                </span>
<span id="cb11-484"><a href="#cb11-484" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> _hide_comments(<span class="va">self</span>): </span>
<span id="cb11-485"><a href="#cb11-485" aria-hidden="true" tabindex="-1"></a>        <span class="co">#     ## Update Column Names =====</span></span>
<span id="cb11-486"><a href="#cb11-486" aria-hidden="true" tabindex="-1"></a>        <span class="co">#     # used in rename_columns()</span></span>
<span id="cb11-487"><a href="#cb11-487" aria-hidden="true" tabindex="-1"></a>        <span class="co">#     def _update_col_names(self, df, nameDict):</span></span>
<span id="cb11-488"><a href="#cb11-488" aria-hidden="true" tabindex="-1"></a>        <span class="co">#         changes = []</span></span>
<span id="cb11-489"><a href="#cb11-489" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-490"><a href="#cb11-490" aria-hidden="true" tabindex="-1"></a>        <span class="co">#         keysNotInDf = [key for key in nameDict.keys() if key not in list(df)]</span></span>
<span id="cb11-491"><a href="#cb11-491" aria-hidden="true" tabindex="-1"></a>        <span class="co">#         for key in keysNotInDf:</span></span>
<span id="cb11-492"><a href="#cb11-492" aria-hidden="true" tabindex="-1"></a>        <span class="co">#             for colName in [colName for colName in list(df) if colName in nameDict[key]]:</span></span>
<span id="cb11-493"><a href="#cb11-493" aria-hidden="true" tabindex="-1"></a>        <span class="co">#                 df= df.rename(columns={colName: key})</span></span>
<span id="cb11-494"><a href="#cb11-494" aria-hidden="true" tabindex="-1"></a>        <span class="co">#                 changes = changes + [(colName+' -&gt; '+ key)]</span></span>
<span id="cb11-495"><a href="#cb11-495" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-496"><a href="#cb11-496" aria-hidden="true" tabindex="-1"></a>        <span class="co">#         issues = [colName for colName in list(df) if colName not in nameDict.keys()]</span></span>
<span id="cb11-497"><a href="#cb11-497" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-498"><a href="#cb11-498" aria-hidden="true" tabindex="-1"></a>        <span class="co">#         return([df, changes, issues])</span></span>
<span id="cb11-499"><a href="#cb11-499" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-500"><a href="#cb11-500" aria-hidden="true" tabindex="-1"></a>        <span class="co">#     # used in rename_all_columns()</span></span>
<span id="cb11-501"><a href="#cb11-501" aria-hidden="true" tabindex="-1"></a>        <span class="co">#     def _rename_columns(</span></span>
<span id="cb11-502"><a href="#cb11-502" aria-hidden="true" tabindex="-1"></a>        <span class="co">#         self,</span></span>
<span id="cb11-503"><a href="#cb11-503" aria-hidden="true" tabindex="-1"></a>        <span class="co">#         dataIn,</span></span>
<span id="cb11-504"><a href="#cb11-504" aria-hidden="true" tabindex="-1"></a>        <span class="co">#         colNamePath='./data/external/UpdateColNames.csv',</span></span>
<span id="cb11-505"><a href="#cb11-505" aria-hidden="true" tabindex="-1"></a>        <span class="co">#         logfileName=''):</span></span>
<span id="cb11-506"><a href="#cb11-506" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-507"><a href="#cb11-507" aria-hidden="true" tabindex="-1"></a>        <span class="co">#         # Make col name update dict ===================================================</span></span>
<span id="cb11-508"><a href="#cb11-508" aria-hidden="true" tabindex="-1"></a>        <span class="co">#         temp = pd.read_csv(colNamePath, low_memory=False) # &lt;--- set because Rainfall is coded with numerics and string based na</span></span>
<span id="cb11-509"><a href="#cb11-509" aria-hidden="true" tabindex="-1"></a>        <span class="co">#         temp = temp.loc[:, (['Standardized']+[entry for entry in list(temp) if entry.startswith('Alias')])]</span></span>
<span id="cb11-510"><a href="#cb11-510" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-511"><a href="#cb11-511" aria-hidden="true" tabindex="-1"></a>        <span class="co">#         # Turn slice of df into one to many dict</span></span>
<span id="cb11-512"><a href="#cb11-512" aria-hidden="true" tabindex="-1"></a>        <span class="co">#         renamingDict = {}</span></span>
<span id="cb11-513"><a href="#cb11-513" aria-hidden="true" tabindex="-1"></a>        <span class="co">#         for i in temp.index:</span></span>
<span id="cb11-514"><a href="#cb11-514" aria-hidden="true" tabindex="-1"></a>        <span class="co">#             tempSlice = list(temp.loc[i, :].dropna())</span></span>
<span id="cb11-515"><a href="#cb11-515" aria-hidden="true" tabindex="-1"></a>        <span class="co">#             renamingDict[tempSlice[0]] = tempSlice[1:]</span></span>
<span id="cb11-516"><a href="#cb11-516" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-517"><a href="#cb11-517" aria-hidden="true" tabindex="-1"></a>        <span class="co">#         # Update Column Names =========================================================</span></span>
<span id="cb11-518"><a href="#cb11-518" aria-hidden="true" tabindex="-1"></a>        <span class="co">#         outputList = self._update_col_names(</span></span>
<span id="cb11-519"><a href="#cb11-519" aria-hidden="true" tabindex="-1"></a>        <span class="co">#             df=dataIn,</span></span>
<span id="cb11-520"><a href="#cb11-520" aria-hidden="true" tabindex="-1"></a>        <span class="co">#             nameDict= renamingDict)</span></span>
<span id="cb11-521"><a href="#cb11-521" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-522"><a href="#cb11-522" aria-hidden="true" tabindex="-1"></a>        <span class="co">#         updatedDf = outputList[0]</span></span>
<span id="cb11-523"><a href="#cb11-523" aria-hidden="true" tabindex="-1"></a>        <span class="co">#         dfChanges = outputList[1]</span></span>
<span id="cb11-524"><a href="#cb11-524" aria-hidden="true" tabindex="-1"></a>        <span class="co">#         dfIssues = outputList[2]</span></span>
<span id="cb11-525"><a href="#cb11-525" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-526"><a href="#cb11-526" aria-hidden="true" tabindex="-1"></a>        <span class="co">#         # Write logs ==================================================================</span></span>
<span id="cb11-527"><a href="#cb11-527" aria-hidden="true" tabindex="-1"></a>        <span class="co">#         # </span><span class="al">TODO</span><span class="co"> bring write_log into class</span></span>
<span id="cb11-528"><a href="#cb11-528" aria-hidden="true" tabindex="-1"></a>        <span class="co">#         for change in dfChanges:</span></span>
<span id="cb11-529"><a href="#cb11-529" aria-hidden="true" tabindex="-1"></a>        <span class="co">#             write_log(pathString='./data/logs/log_'+logfileName+'_changes.txt',</span></span>
<span id="cb11-530"><a href="#cb11-530" aria-hidden="true" tabindex="-1"></a>        <span class="co">#                       message=str(change).encode("utf8"))</span></span>
<span id="cb11-531"><a href="#cb11-531" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-532"><a href="#cb11-532" aria-hidden="true" tabindex="-1"></a>        <span class="co">#         for issue in dfIssues:</span></span>
<span id="cb11-533"><a href="#cb11-533" aria-hidden="true" tabindex="-1"></a>        <span class="co">#             write_log(pathString='./data/logs/log_'+logfileName+'_issues.txt',</span></span>
<span id="cb11-534"><a href="#cb11-534" aria-hidden="true" tabindex="-1"></a>        <span class="co">#                       message=('Not defined: "'+str(issue)+'"').encode("utf8"))</span></span>
<span id="cb11-535"><a href="#cb11-535" aria-hidden="true" tabindex="-1"></a>        <span class="co">#         return(updatedDf)</span></span>
<span id="cb11-536"><a href="#cb11-536" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-537"><a href="#cb11-537" aria-hidden="true" tabindex="-1"></a>        <span class="co">#     def rename_all_columns(self,</span></span>
<span id="cb11-538"><a href="#cb11-538" aria-hidden="true" tabindex="-1"></a>        <span class="co">#                            colNamePath='./data/external/UpdateColNames.csv',</span></span>
<span id="cb11-539"><a href="#cb11-539" aria-hidden="true" tabindex="-1"></a>        <span class="co">#                            logfileName=''</span></span>
<span id="cb11-540"><a href="#cb11-540" aria-hidden="true" tabindex="-1"></a>        <span class="co">#                           ):</span></span>
<span id="cb11-541"><a href="#cb11-541" aria-hidden="true" tabindex="-1"></a>        <span class="co">#         for entry in self._get_active_attr():</span></span>
<span id="cb11-542"><a href="#cb11-542" aria-hidden="true" tabindex="-1"></a>        <span class="co">#             getattr(self, entry).data = self._rename_columns(dataIn=getattr(self, entry).data,</span></span>
<span id="cb11-543"><a href="#cb11-543" aria-hidden="true" tabindex="-1"></a>        <span class="co">#                                                              colNamePath=colNamePath,</span></span>
<span id="cb11-544"><a href="#cb11-544" aria-hidden="true" tabindex="-1"></a>        <span class="co">#                                                              logfileName=logfileName)</span></span>
<span id="cb11-545"><a href="#cb11-545" aria-hidden="true" tabindex="-1"></a>        <span class="co">#     ## Regroup Columns ====</span></span>
<span id="cb11-546"><a href="#cb11-546" aria-hidden="true" tabindex="-1"></a>        <span class="co">#     def sort_cols_in_dfs(self,</span></span>
<span id="cb11-547"><a href="#cb11-547" aria-hidden="true" tabindex="-1"></a>        <span class="co">#                      colGroupingsPath = './data/external/UpdateColGroupings.csv' </span></span>
<span id="cb11-548"><a href="#cb11-548" aria-hidden="true" tabindex="-1"></a>        <span class="co">#                     ):</span></span>
<span id="cb11-549"><a href="#cb11-549" aria-hidden="true" tabindex="-1"></a>        <span class="co">#         colGroupings = pd.read_csv(colGroupingsPath)</span></span>
<span id="cb11-550"><a href="#cb11-550" aria-hidden="true" tabindex="-1"></a>        <span class="co">#         inputData = [getattr(self, entry).data for entry in self._get_active_attr()]</span></span>
<span id="cb11-551"><a href="#cb11-551" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-552"><a href="#cb11-552" aria-hidden="true" tabindex="-1"></a>        <span class="co">#         keyCols= list((colGroupings.Keys).dropna())</span></span>
<span id="cb11-553"><a href="#cb11-553" aria-hidden="true" tabindex="-1"></a>        <span class="co">#         groupings= [col for col in list(colGroupings) if ((col.endswith('Type') == False) &amp; (col != 'Keys'))]</span></span>
<span id="cb11-554"><a href="#cb11-554" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-555"><a href="#cb11-555" aria-hidden="true" tabindex="-1"></a>        <span class="co">#         groupingAccumulators = {} #groupings.copy()</span></span>
<span id="cb11-556"><a href="#cb11-556" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-557"><a href="#cb11-557" aria-hidden="true" tabindex="-1"></a>        <span class="co">#         # i = 0</span></span>
<span id="cb11-558"><a href="#cb11-558" aria-hidden="true" tabindex="-1"></a>        <span class="co">#         # j = 0</span></span>
<span id="cb11-559"><a href="#cb11-559" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-560"><a href="#cb11-560" aria-hidden="true" tabindex="-1"></a>        <span class="co">#         for j in range(len(groupings)):</span></span>
<span id="cb11-561"><a href="#cb11-561" aria-hidden="true" tabindex="-1"></a>        <span class="co">#             #keepTheseCols = keyCols+list(colGroupings[groupings[j]].dropna())</span></span>
<span id="cb11-562"><a href="#cb11-562" aria-hidden="true" tabindex="-1"></a>        <span class="co">#             keepTheseCols = list(colGroupings[groupings[j]].dropna())</span></span>
<span id="cb11-563"><a href="#cb11-563" aria-hidden="true" tabindex="-1"></a>        <span class="co">#             accumulator = pd.DataFrame()</span></span>
<span id="cb11-564"><a href="#cb11-564" aria-hidden="true" tabindex="-1"></a>        <span class="co">#             for i in range(len(inputData)):</span></span>
<span id="cb11-565"><a href="#cb11-565" aria-hidden="true" tabindex="-1"></a>        <span class="co">#                 data = inputData[i]</span></span>
<span id="cb11-566"><a href="#cb11-566" aria-hidden="true" tabindex="-1"></a>        <span class="co">#                 data = data.loc[:, [entry for entry in list(data) if entry in keepTheseCols]].drop_duplicates()</span></span>
<span id="cb11-567"><a href="#cb11-567" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-568"><a href="#cb11-568" aria-hidden="true" tabindex="-1"></a>        <span class="co">#                 # this will hopefully prevent dropping data that is text in datetime or numeric cols.</span></span>
<span id="cb11-569"><a href="#cb11-569" aria-hidden="true" tabindex="-1"></a>        <span class="co">#                 # And then we don't have to worry about merging by like types here!</span></span>
<span id="cb11-570"><a href="#cb11-570" aria-hidden="true" tabindex="-1"></a>        <span class="co">#                 data = data.astype(str)</span></span>
<span id="cb11-571"><a href="#cb11-571" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-572"><a href="#cb11-572" aria-hidden="true" tabindex="-1"></a>        <span class="co">#                 if ((accumulator.shape[0] == 0) | (accumulator.shape[1] == 0) ):</span></span>
<span id="cb11-573"><a href="#cb11-573" aria-hidden="true" tabindex="-1"></a>        <span class="co">#                     accumulator = data</span></span>
<span id="cb11-574"><a href="#cb11-574" aria-hidden="true" tabindex="-1"></a>        <span class="co">#                 elif ((data.shape[0] &gt; 0) &amp; (data.shape[1] &gt; 0)) :</span></span>
<span id="cb11-575"><a href="#cb11-575" aria-hidden="true" tabindex="-1"></a>        <span class="co">#     #                 print(list(accumulator))</span></span>
<span id="cb11-576"><a href="#cb11-576" aria-hidden="true" tabindex="-1"></a>        <span class="co">#     #                 print(list(data))</span></span>
<span id="cb11-577"><a href="#cb11-577" aria-hidden="true" tabindex="-1"></a>        <span class="co">#     #                 print('\n')</span></span>
<span id="cb11-578"><a href="#cb11-578" aria-hidden="true" tabindex="-1"></a>        <span class="co">#                     accumulator = accumulator.merge(data, how = 'outer')</span></span>
<span id="cb11-579"><a href="#cb11-579" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-580"><a href="#cb11-580" aria-hidden="true" tabindex="-1"></a>        <span class="co">#                 currentGrouping = groupings[j] # string about to be replace</span></span>
<span id="cb11-581"><a href="#cb11-581" aria-hidden="true" tabindex="-1"></a>        <span class="co">#                 #     groupingAccumulators[j] = {currentGrouping : accumulator}</span></span>
<span id="cb11-582"><a href="#cb11-582" aria-hidden="true" tabindex="-1"></a>        <span class="co">#                 #     groupingAccumulators = groupingAccumulators + {currentGrouping : accumulator}</span></span>
<span id="cb11-583"><a href="#cb11-583" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-584"><a href="#cb11-584" aria-hidden="true" tabindex="-1"></a>        <span class="co">#                 groupingAccumulators.update({currentGrouping : accumulator})</span></span>
<span id="cb11-585"><a href="#cb11-585" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-586"><a href="#cb11-586" aria-hidden="true" tabindex="-1"></a>        <span class="co">#         return(groupingAccumulators) </span></span>
<span id="cb11-587"><a href="#cb11-587" aria-hidden="true" tabindex="-1"></a>        <span class="cf">pass</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> prlst(lst): </span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a>    <span class="co">"This is just a helper function to ease formating lists of strings with each entryon a different line."</span></span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="st">'['</span>)</span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> e <span class="kw">in</span> lst:</span>
<span id="cb12-5"><a href="#cb12-5" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> e <span class="op">!=</span> lst[<span class="op">-</span><span class="dv">1</span>]:</span>
<span id="cb12-6"><a href="#cb12-6" aria-hidden="true" tabindex="-1"></a>            <span class="bu">print</span>(<span class="st">"'"</span><span class="op">+</span>e<span class="op">+</span><span class="st">"', "</span>)</span>
<span id="cb12-7"><a href="#cb12-7" aria-hidden="true" tabindex="-1"></a>        <span class="cf">else</span>:</span>
<span id="cb12-8"><a href="#cb12-8" aria-hidden="true" tabindex="-1"></a>            <span class="bu">print</span>(<span class="st">"'"</span><span class="op">+</span>e<span class="op">+</span><span class="st">"'"</span>)</span>
<span id="cb12-9"><a href="#cb12-9" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="st">']'</span>)</span>
<span id="cb12-10"><a href="#cb12-10" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb12-11"><a href="#cb12-11" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> prlst2dct(lst): </span>
<span id="cb12-12"><a href="#cb12-12" aria-hidden="true" tabindex="-1"></a>    <span class="co">"This is just a helper function to ease formating lists of strings with each entryon a different line."</span></span>
<span id="cb12-13"><a href="#cb12-13" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="st">'{'</span>)</span>
<span id="cb12-14"><a href="#cb12-14" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> e <span class="kw">in</span> lst:</span>
<span id="cb12-15"><a href="#cb12-15" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> e <span class="op">!=</span> lst[<span class="op">-</span><span class="dv">1</span>]:</span>
<span id="cb12-16"><a href="#cb12-16" aria-hidden="true" tabindex="-1"></a>            <span class="bu">print</span>(<span class="st">"'"</span><span class="op">+</span>e<span class="op">+</span><span class="st">"': 'XXXXXXX', "</span>)</span>
<span id="cb12-17"><a href="#cb12-17" aria-hidden="true" tabindex="-1"></a>        <span class="cf">else</span>:</span>
<span id="cb12-18"><a href="#cb12-18" aria-hidden="true" tabindex="-1"></a>            <span class="bu">print</span>(<span class="st">"'"</span><span class="op">+</span>e<span class="op">+</span><span class="st">"': 'XXXXXXX'"</span>)</span>
<span id="cb12-19"><a href="#cb12-19" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="st">'}'</span>)</span>
<span id="cb12-20"><a href="#cb12-20" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb12-21"><a href="#cb12-21" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb12-22"><a href="#cb12-22" aria-hidden="true" tabindex="-1"></a>prlst([])</span>
<span id="cb12-23"><a href="#cb12-23" aria-hidden="true" tabindex="-1"></a><span class="co"># prlst2dct([])</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[
]</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Year specific subclasses ----</span></span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a><span class="kw">class</span> g2f_2021(g2f_year):</span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a>    <span class="co"># no year specific renames because we're bringing everything up to 2021 as a standard</span></span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true" tabindex="-1"></a>    <span class="cf">pass</span></span>
<span id="cb14-5"><a href="#cb14-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-6"><a href="#cb14-6" aria-hidden="true" tabindex="-1"></a><span class="kw">class</span> g2f_2020(g2f_year):</span>
<span id="cb14-7"><a href="#cb14-7" aria-hidden="true" tabindex="-1"></a>    <span class="cf">pass</span></span>
<span id="cb14-8"><a href="#cb14-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-9"><a href="#cb14-9" aria-hidden="true" tabindex="-1"></a><span class="kw">class</span> g2f_2019(g2f_year):</span>
<span id="cb14-10"><a href="#cb14-10" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> standardize_all_transformed_names(<span class="va">self</span>):</span>
<span id="cb14-11"><a href="#cb14-11" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> entry <span class="kw">in</span> [<span class="st">'meta'</span>, <span class="st">'phno'</span>, <span class="co">#'geno', </span></span>
<span id="cb14-12"><a href="#cb14-12" aria-hidden="true" tabindex="-1"></a>                      <span class="st">'wthr'</span>, <span class="st">'soil'</span>, <span class="st">'mgmt'</span>]:</span>
<span id="cb14-13"><a href="#cb14-13" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> <span class="bu">type</span>(<span class="bu">getattr</span>(<span class="va">self</span>,  entry).data) <span class="op">==</span> <span class="bu">type</span>(<span class="va">None</span>):</span>
<span id="cb14-14"><a href="#cb14-14" aria-hidden="true" tabindex="-1"></a>                <span class="bu">print</span>(entry<span class="op">+</span><span class="st">" is not initialized and None type."</span>)</span>
<span id="cb14-15"><a href="#cb14-15" aria-hidden="true" tabindex="-1"></a>            <span class="cf">else</span>:</span>
<span id="cb14-16"><a href="#cb14-16" aria-hidden="true" tabindex="-1"></a>                rename_cols_dict <span class="op">=</span> {}</span>
<span id="cb14-17"><a href="#cb14-17" aria-hidden="true" tabindex="-1"></a>                drop_cols_list <span class="op">=</span> []</span>
<span id="cb14-18"><a href="#cb14-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-19"><a href="#cb14-19" aria-hidden="true" tabindex="-1"></a>                <span class="cf">if</span> entry <span class="op">==</span> <span class="st">"meta"</span>:</span>
<span id="cb14-20"><a href="#cb14-20" aria-hidden="true" tabindex="-1"></a>                    rename_cols_dict.update({</span>
<span id="cb14-21"><a href="#cb14-21" aria-hidden="true" tabindex="-1"></a>                    })</span>
<span id="cb14-22"><a href="#cb14-22" aria-hidden="true" tabindex="-1"></a>                <span class="cf">if</span> entry <span class="op">==</span> <span class="st">"phno"</span>:</span>
<span id="cb14-23"><a href="#cb14-23" aria-hidden="true" tabindex="-1"></a>                    rename_cols_dict.update({</span>
<span id="cb14-24"><a href="#cb14-24" aria-hidden="true" tabindex="-1"></a>                        <span class="st">'Number_kernels_planted_per_plot_(&gt;200_seed/pack_for_cone_planters)'</span>: <span class="st">'Kernels/Packet'</span>, <span class="co">#2021.meta</span></span>
<span id="cb14-25"><a href="#cb14-25" aria-hidden="true" tabindex="-1"></a>                        <span class="st">"Filler_[enter_'filler'_or_blank]"</span>: <span class="st">'Filler'</span></span>
<span id="cb14-26"><a href="#cb14-26" aria-hidden="true" tabindex="-1"></a>                    })</span>
<span id="cb14-27"><a href="#cb14-27" aria-hidden="true" tabindex="-1"></a>                <span class="cf">if</span> entry <span class="op">==</span> <span class="st">"wthr"</span>:</span>
<span id="cb14-28"><a href="#cb14-28" aria-hidden="true" tabindex="-1"></a>                    rename_cols_dict.update({</span>
<span id="cb14-29"><a href="#cb14-29" aria-hidden="true" tabindex="-1"></a>                    })</span>
<span id="cb14-30"><a href="#cb14-30" aria-hidden="true" tabindex="-1"></a>                <span class="cf">if</span> entry <span class="op">==</span> <span class="st">"soil"</span>:</span>
<span id="cb14-31"><a href="#cb14-31" aria-hidden="true" tabindex="-1"></a>                    rename_cols_dict.update({</span>
<span id="cb14-32"><a href="#cb14-32" aria-hidden="true" tabindex="-1"></a>                    })</span>
<span id="cb14-33"><a href="#cb14-33" aria-hidden="true" tabindex="-1"></a>                <span class="cf">if</span> entry <span class="op">==</span> <span class="st">"mgmt"</span>:</span>
<span id="cb14-34"><a href="#cb14-34" aria-hidden="true" tabindex="-1"></a>                    rename_cols_dict.update({</span>
<span id="cb14-35"><a href="#cb14-35" aria-hidden="true" tabindex="-1"></a>                    })</span>
<span id="cb14-36"><a href="#cb14-36" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-37"><a href="#cb14-37" aria-hidden="true" tabindex="-1"></a>                <span class="bu">getattr</span>(<span class="va">self</span>,  entry).data <span class="op">=</span> <span class="bu">getattr</span>(<span class="va">self</span>,  entry).data.rename(columns <span class="op">=</span> rename_cols_dict)</span>
<span id="cb14-38"><a href="#cb14-38" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-39"><a href="#cb14-39" aria-hidden="true" tabindex="-1"></a>                <span class="cf">if</span> drop_cols_list <span class="op">!=</span> []:</span>
<span id="cb14-40"><a href="#cb14-40" aria-hidden="true" tabindex="-1"></a>                    <span class="bu">getattr</span>(<span class="va">self</span>,  entry).data <span class="op">=</span> <span class="bu">getattr</span>(<span class="va">self</span>,  entry).data.drop(drop_cols_list, axis<span class="op">=</span><span class="dv">1</span>)</span>
<span id="cb14-41"><a href="#cb14-41" aria-hidden="true" tabindex="-1"></a>                </span>
<span id="cb14-42"><a href="#cb14-42" aria-hidden="true" tabindex="-1"></a><span class="kw">class</span> g2f_2018(g2f_year):</span>
<span id="cb14-43"><a href="#cb14-43" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> standardize_all_transformed_names(<span class="va">self</span>):</span>
<span id="cb14-44"><a href="#cb14-44" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> entry <span class="kw">in</span> [<span class="st">'meta'</span>, <span class="st">'phno'</span>, <span class="co">#'geno', </span></span>
<span id="cb14-45"><a href="#cb14-45" aria-hidden="true" tabindex="-1"></a>                      <span class="st">'wthr'</span>, <span class="st">'soil'</span>, <span class="st">'mgmt'</span>]:</span>
<span id="cb14-46"><a href="#cb14-46" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> <span class="bu">type</span>(<span class="bu">getattr</span>(<span class="va">self</span>,  entry).data) <span class="op">==</span> <span class="bu">type</span>(<span class="va">None</span>):</span>
<span id="cb14-47"><a href="#cb14-47" aria-hidden="true" tabindex="-1"></a>                <span class="bu">print</span>(entry<span class="op">+</span><span class="st">" is not initialized and None type."</span>)</span>
<span id="cb14-48"><a href="#cb14-48" aria-hidden="true" tabindex="-1"></a>            <span class="cf">else</span>:</span>
<span id="cb14-49"><a href="#cb14-49" aria-hidden="true" tabindex="-1"></a>                rename_cols_dict <span class="op">=</span> {}</span>
<span id="cb14-50"><a href="#cb14-50" aria-hidden="true" tabindex="-1"></a>                drop_cols_list <span class="op">=</span> []</span>
<span id="cb14-51"><a href="#cb14-51" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-52"><a href="#cb14-52" aria-hidden="true" tabindex="-1"></a>                <span class="cf">if</span> entry <span class="op">==</span> <span class="st">"meta"</span>:</span>
<span id="cb14-53"><a href="#cb14-53" aria-hidden="true" tabindex="-1"></a>                    rename_cols_dict.update({</span>
<span id="cb14-54"><a href="#cb14-54" aria-hidden="true" tabindex="-1"></a>                        <span class="st">'Weather_station_serial_number_(Last_four_digits,_e.g.</span><span class="ch">\xa0</span><span class="st">m2700s#####)'</span>: <span class="st">'Station_ID'</span></span>
<span id="cb14-55"><a href="#cb14-55" aria-hidden="true" tabindex="-1"></a>                    })</span>
<span id="cb14-56"><a href="#cb14-56" aria-hidden="true" tabindex="-1"></a>                <span class="cf">if</span> entry <span class="op">==</span> <span class="st">"phno"</span>:</span>
<span id="cb14-57"><a href="#cb14-57" aria-hidden="true" tabindex="-1"></a>                    rename_cols_dict.update({</span>
<span id="cb14-58"><a href="#cb14-58" aria-hidden="true" tabindex="-1"></a>                        <span class="co"># 'RecId': '', </span></span>
<span id="cb14-59"><a href="#cb14-59" aria-hidden="true" tabindex="-1"></a>                        <span class="st">'Tester/Group'</span>: <span class="st">'Tester'</span>, </span>
<span id="cb14-60"><a href="#cb14-60" aria-hidden="true" tabindex="-1"></a>                        <span class="co"># 'Local_check_(Yes,_no)': '', </span></span>
<span id="cb14-61"><a href="#cb14-61" aria-hidden="true" tabindex="-1"></a>                        <span class="co"># 'Plot_length_field': '', </span></span>
<span id="cb14-62"><a href="#cb14-62" aria-hidden="true" tabindex="-1"></a>                        <span class="st">'Alley_length'</span>: <span class="st">'Alley_length_(in_inches)'</span>, </span>
<span id="cb14-63"><a href="#cb14-63" aria-hidden="true" tabindex="-1"></a>                        <span class="st">'Row_spacing'</span>: <span class="st">'Row_spacing_(in_inches)'</span>, </span>
<span id="cb14-64"><a href="#cb14-64" aria-hidden="true" tabindex="-1"></a>                        <span class="co"># 'Plot_area': '', </span></span>
<span id="cb14-65"><a href="#cb14-65" aria-hidden="true" tabindex="-1"></a>                        <span class="co"># 'Rows/Plot': '', </span></span>
<span id="cb14-66"><a href="#cb14-66" aria-hidden="true" tabindex="-1"></a>                        <span class="co"># 'Packet/Plot': '', </span></span>
<span id="cb14-67"><a href="#cb14-67" aria-hidden="true" tabindex="-1"></a>                        <span class="co"># 'Kernels/Packet': '', </span></span>
<span id="cb14-68"><a href="#cb14-68" aria-hidden="true" tabindex="-1"></a>                        <span class="co"># '#_seed': '', </span></span>
<span id="cb14-69"><a href="#cb14-69" aria-hidden="true" tabindex="-1"></a>                        <span class="st">'Date_planted'</span>: <span class="st">'Date_plot_planted_[MM/DD/YY]'</span>, </span>
<span id="cb14-70"><a href="#cb14-70" aria-hidden="true" tabindex="-1"></a>                        <span class="st">'Date_harvested'</span>: <span class="st">'Date_plot_harvested_[MM/DD/YY]'</span>, </span>
<span id="cb14-71"><a href="#cb14-71" aria-hidden="true" tabindex="-1"></a>                        <span class="st">'Anthesis_[date]'</span>: <span class="st">'Anthesis_[MM/DD/YY]'</span>, </span>
<span id="cb14-72"><a href="#cb14-72" aria-hidden="true" tabindex="-1"></a>                        <span class="st">'Silking_[date]'</span>: <span class="st">'Silking_[MM/DD/YY]'</span>, </span>
<span id="cb14-73"><a href="#cb14-73" aria-hidden="true" tabindex="-1"></a>                        <span class="st">'Pollen_dAP_[days]'</span>: <span class="st">'Anthesis_[days]'</span>, </span>
<span id="cb14-74"><a href="#cb14-74" aria-hidden="true" tabindex="-1"></a>                        <span class="st">'Silk_dAP_[days]'</span>: <span class="st">'Silking_[days]'</span>, </span>
<span id="cb14-75"><a href="#cb14-75" aria-hidden="true" tabindex="-1"></a>                        <span class="st">'Stand_count_[plants]'</span>: <span class="st">'Stand_count_[#_of_plants]'</span>, </span>
<span id="cb14-76"><a href="#cb14-76" aria-hidden="true" tabindex="-1"></a>                        <span class="co"># 'Stand_[%]': '', </span></span>
<span id="cb14-77"><a href="#cb14-77" aria-hidden="true" tabindex="-1"></a>                        <span class="co"># 'Root_lodging_[plants]': '', </span></span>
<span id="cb14-78"><a href="#cb14-78" aria-hidden="true" tabindex="-1"></a>                        <span class="co"># 'Stalk_lodging_[plants]': '', </span></span>
<span id="cb14-79"><a href="#cb14-79" aria-hidden="true" tabindex="-1"></a>                        <span class="st">'Test_weight_[lbs/bu]'</span>: <span class="st">'Plot_weight_[lbs]'</span>, </span>
<span id="cb14-80"><a href="#cb14-80" aria-hidden="true" tabindex="-1"></a>                        <span class="st">'Grain_yield_[bu/A]'</span>: <span class="st">'Grain_yield_(bu/A)'</span><span class="co">#, </span></span>
<span id="cb14-81"><a href="#cb14-81" aria-hidden="true" tabindex="-1"></a>                        <span class="co"># 'Plot_discarded_[enter_"Yes"_or_"blank"]': '', </span></span>
<span id="cb14-82"><a href="#cb14-82" aria-hidden="true" tabindex="-1"></a>                        <span class="co"># 'Filler_[enter_"filler"_or_"blank"]': '', </span></span>
<span id="cb14-83"><a href="#cb14-83" aria-hidden="true" tabindex="-1"></a>                        <span class="co"># '[add_additional_measurements_here]': '',</span></span>
<span id="cb14-84"><a href="#cb14-84" aria-hidden="true" tabindex="-1"></a>                    })</span>
<span id="cb14-85"><a href="#cb14-85" aria-hidden="true" tabindex="-1"></a>                <span class="cf">if</span> entry <span class="op">==</span> <span class="st">"wthr"</span>:</span>
<span id="cb14-86"><a href="#cb14-86" aria-hidden="true" tabindex="-1"></a>                    rename_cols_dict.update({</span>
<span id="cb14-87"><a href="#cb14-87" aria-hidden="true" tabindex="-1"></a>                        <span class="st">'UVL_(uM/m^2s)'</span>: <span class="st">'UV_light_[uM/m2s]'</span>, </span>
<span id="cb14-88"><a href="#cb14-88" aria-hidden="true" tabindex="-1"></a>                        <span class="st">'Photoperiod_[_hours]'</span>: <span class="st">'Photoperiod_[hours]'</span></span>
<span id="cb14-89"><a href="#cb14-89" aria-hidden="true" tabindex="-1"></a>                    })</span>
<span id="cb14-90"><a href="#cb14-90" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-91"><a href="#cb14-91" aria-hidden="true" tabindex="-1"></a>                    drop_cols_list <span class="op">=</span> [<span class="st">'Record_number'</span>]</span>
<span id="cb14-92"><a href="#cb14-92" aria-hidden="true" tabindex="-1"></a>                <span class="cf">if</span> entry <span class="op">==</span> <span class="st">"soil"</span>:</span>
<span id="cb14-93"><a href="#cb14-93" aria-hidden="true" tabindex="-1"></a>                    rename_cols_dict.update({</span>
<span id="cb14-94"><a href="#cb14-94" aria-hidden="true" tabindex="-1"></a>                        <span class="st">'Field_ID'</span>: <span class="st">'Location'</span>,</span>
<span id="cb14-95"><a href="#cb14-95" aria-hidden="true" tabindex="-1"></a>                        <span class="st">'Date_recieved'</span>: <span class="st">'Date_received'</span></span>
<span id="cb14-96"><a href="#cb14-96" aria-hidden="true" tabindex="-1"></a>                    })</span>
<span id="cb14-97"><a href="#cb14-97" aria-hidden="true" tabindex="-1"></a>                <span class="cf">if</span> entry <span class="op">==</span> <span class="st">"mgmt"</span>:</span>
<span id="cb14-98"><a href="#cb14-98" aria-hidden="true" tabindex="-1"></a>                    rename_cols_dict.update({</span>
<span id="cb14-99"><a href="#cb14-99" aria-hidden="true" tabindex="-1"></a>                    })</span>
<span id="cb14-100"><a href="#cb14-100" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-101"><a href="#cb14-101" aria-hidden="true" tabindex="-1"></a>                <span class="bu">getattr</span>(<span class="va">self</span>,  entry).data <span class="op">=</span> <span class="bu">getattr</span>(<span class="va">self</span>,  entry).data.rename(columns <span class="op">=</span> rename_cols_dict)</span>
<span id="cb14-102"><a href="#cb14-102" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-103"><a href="#cb14-103" aria-hidden="true" tabindex="-1"></a>                <span class="cf">if</span> drop_cols_list <span class="op">!=</span> []:</span>
<span id="cb14-104"><a href="#cb14-104" aria-hidden="true" tabindex="-1"></a>                    <span class="bu">getattr</span>(<span class="va">self</span>,  entry).data <span class="op">=</span> <span class="bu">getattr</span>(<span class="va">self</span>,  entry).data.drop(drop_cols_list, axis<span class="op">=</span><span class="dv">1</span>)</span>
<span id="cb14-105"><a href="#cb14-105" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb14-106"><a href="#cb14-106" aria-hidden="true" tabindex="-1"></a><span class="kw">class</span> g2f_2017(g2f_year):</span>
<span id="cb14-107"><a href="#cb14-107" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> standardize_all_transformed_names(<span class="va">self</span>):</span>
<span id="cb14-108"><a href="#cb14-108" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> entry <span class="kw">in</span> [<span class="st">'meta'</span>, <span class="st">'phno'</span>, <span class="co">#'geno', </span></span>
<span id="cb14-109"><a href="#cb14-109" aria-hidden="true" tabindex="-1"></a>                      <span class="st">'wthr'</span>, <span class="st">'soil'</span>, <span class="st">'mgmt'</span>]:</span>
<span id="cb14-110"><a href="#cb14-110" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> <span class="bu">type</span>(<span class="bu">getattr</span>(<span class="va">self</span>,  entry).data) <span class="op">==</span> <span class="bu">type</span>(<span class="va">None</span>):</span>
<span id="cb14-111"><a href="#cb14-111" aria-hidden="true" tabindex="-1"></a>                <span class="bu">print</span>(entry<span class="op">+</span><span class="st">" is not initialized and None type."</span>)</span>
<span id="cb14-112"><a href="#cb14-112" aria-hidden="true" tabindex="-1"></a>            <span class="cf">else</span>:</span>
<span id="cb14-113"><a href="#cb14-113" aria-hidden="true" tabindex="-1"></a>                rename_cols_dict <span class="op">=</span> {}</span>
<span id="cb14-114"><a href="#cb14-114" aria-hidden="true" tabindex="-1"></a>                drop_cols_list <span class="op">=</span> []</span>
<span id="cb14-115"><a href="#cb14-115" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-116"><a href="#cb14-116" aria-hidden="true" tabindex="-1"></a>                <span class="cf">if</span> entry <span class="op">==</span> <span class="st">"meta"</span>:</span>
<span id="cb14-117"><a href="#cb14-117" aria-hidden="true" tabindex="-1"></a>                    rename_cols_dict.update({</span>
<span id="cb14-118"><a href="#cb14-118" aria-hidden="true" tabindex="-1"></a>                        <span class="st">'Weather_station_serial_number_(Last_four_digits,_e.g.</span><span class="ch">\xa0</span><span class="st">m2700s#####)'</span>: <span class="st">'Weather_station_serial_number_(Last_four_digits,_e.g._m2700s#####)'</span></span>
<span id="cb14-119"><a href="#cb14-119" aria-hidden="true" tabindex="-1"></a>                    })</span>
<span id="cb14-120"><a href="#cb14-120" aria-hidden="true" tabindex="-1"></a>                <span class="cf">if</span> entry <span class="op">==</span> <span class="st">"phno"</span>:</span>
<span id="cb14-121"><a href="#cb14-121" aria-hidden="true" tabindex="-1"></a>                    rename_cols_dict.update({</span>
<span id="cb14-122"><a href="#cb14-122" aria-hidden="true" tabindex="-1"></a>                        <span class="st">'LOCAL_cHECK_(Yes,_no[Blank])'</span>: <span class="st">'Local_check_(Yes,_no)'</span>, </span>
<span id="cb14-123"><a href="#cb14-123" aria-hidden="true" tabindex="-1"></a>                        <span class="st">'Alley_length'</span>: <span class="st">'Alley_length_(in_inches)'</span>, </span>
<span id="cb14-124"><a href="#cb14-124" aria-hidden="true" tabindex="-1"></a>                        <span class="st">'Row_spacing'</span>: <span class="st">'Row_spacing_(in_inches)'</span>, </span>
<span id="cb14-125"><a href="#cb14-125" aria-hidden="true" tabindex="-1"></a>                        <span class="st">'Date_planted'</span>: <span class="st">'Date_plot_planted_[MM/DD/YY]'</span>, </span>
<span id="cb14-126"><a href="#cb14-126" aria-hidden="true" tabindex="-1"></a>                        <span class="st">'Date_harvested'</span>: <span class="st">'Date_plot_harvested_[MM/DD/YY]'</span>, </span>
<span id="cb14-127"><a href="#cb14-127" aria-hidden="true" tabindex="-1"></a>                        <span class="st">'Anthesis_[date]'</span>: <span class="st">'Anthesis_[MM/DD/YY]'</span>, </span>
<span id="cb14-128"><a href="#cb14-128" aria-hidden="true" tabindex="-1"></a>                        <span class="st">'Silking_[date]'</span>: <span class="st">'Silking_[MM/DD/YY]'</span>, </span>
<span id="cb14-129"><a href="#cb14-129" aria-hidden="true" tabindex="-1"></a>                        <span class="st">'Pollen_dAP_[days]'</span>: <span class="st">'Anthesis_[days]'</span>, </span>
<span id="cb14-130"><a href="#cb14-130" aria-hidden="true" tabindex="-1"></a>                        <span class="st">'Silk_dAP_[days]'</span>: <span class="st">'Silking_[days]'</span>, </span>
<span id="cb14-131"><a href="#cb14-131" aria-hidden="true" tabindex="-1"></a>                        <span class="st">'Stand_count_[plants]'</span>: <span class="st">'Stand_count_[#_of_plants]'</span>, </span>
<span id="cb14-132"><a href="#cb14-132" aria-hidden="true" tabindex="-1"></a>                        <span class="st">'Test_weight_[lbs/bu]'</span>: <span class="st">'Test_weight_[lbs]'</span>, </span>
<span id="cb14-133"><a href="#cb14-133" aria-hidden="true" tabindex="-1"></a>                        <span class="st">'Grain_yield_[bu/A]'</span>: <span class="st">'Grain_yield_(bu/A)'</span>, </span>
<span id="cb14-134"><a href="#cb14-134" aria-hidden="true" tabindex="-1"></a>                        <span class="st">'Plot_discarded_[enter_"yes"_or_"blank"]'</span>: <span class="st">"Plot_discarded_[enter_'yes'_or_blank]"</span></span>
<span id="cb14-135"><a href="#cb14-135" aria-hidden="true" tabindex="-1"></a>                    })</span>
<span id="cb14-136"><a href="#cb14-136" aria-hidden="true" tabindex="-1"></a>                    drop_cols_list <span class="op">=</span> [<span class="st">'Year'</span>]</span>
<span id="cb14-137"><a href="#cb14-137" aria-hidden="true" tabindex="-1"></a>                <span class="cf">if</span> entry <span class="op">==</span> <span class="st">"wthr"</span>:</span>
<span id="cb14-138"><a href="#cb14-138" aria-hidden="true" tabindex="-1"></a>                    rename_cols_dict.update({</span>
<span id="cb14-139"><a href="#cb14-139" aria-hidden="true" tabindex="-1"></a>                    })</span>
<span id="cb14-140"><a href="#cb14-140" aria-hidden="true" tabindex="-1"></a>                <span class="cf">if</span> entry <span class="op">==</span> <span class="st">"soil"</span>:</span>
<span id="cb14-141"><a href="#cb14-141" aria-hidden="true" tabindex="-1"></a>                    rename_cols_dict.update({</span>
<span id="cb14-142"><a href="#cb14-142" aria-hidden="true" tabindex="-1"></a>                    })</span>
<span id="cb14-143"><a href="#cb14-143" aria-hidden="true" tabindex="-1"></a>                <span class="cf">if</span> entry <span class="op">==</span> <span class="st">"mgmt"</span>:</span>
<span id="cb14-144"><a href="#cb14-144" aria-hidden="true" tabindex="-1"></a>                    rename_cols_dict.update({</span>
<span id="cb14-145"><a href="#cb14-145" aria-hidden="true" tabindex="-1"></a>                    })</span>
<span id="cb14-146"><a href="#cb14-146" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-147"><a href="#cb14-147" aria-hidden="true" tabindex="-1"></a>                <span class="bu">getattr</span>(<span class="va">self</span>,  entry).data <span class="op">=</span> <span class="bu">getattr</span>(<span class="va">self</span>,  entry).data.rename(columns <span class="op">=</span> rename_cols_dict)</span>
<span id="cb14-148"><a href="#cb14-148" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-149"><a href="#cb14-149" aria-hidden="true" tabindex="-1"></a>                <span class="cf">if</span> drop_cols_list <span class="op">!=</span> []:</span>
<span id="cb14-150"><a href="#cb14-150" aria-hidden="true" tabindex="-1"></a>                    <span class="bu">getattr</span>(<span class="va">self</span>,  entry).data <span class="op">=</span> <span class="bu">getattr</span>(<span class="va">self</span>,  entry).data.drop(drop_cols_list, axis<span class="op">=</span><span class="dv">1</span>)</span>
<span id="cb14-151"><a href="#cb14-151" aria-hidden="true" tabindex="-1"></a>                    </span>
<span id="cb14-152"><a href="#cb14-152" aria-hidden="true" tabindex="-1"></a><span class="kw">class</span> g2f_2016(g2f_year):</span>
<span id="cb14-153"><a href="#cb14-153" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> standardize_all_transformed_names(<span class="va">self</span>):</span>
<span id="cb14-154"><a href="#cb14-154" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> entry <span class="kw">in</span> [<span class="st">'meta'</span>, <span class="st">'phno'</span>, <span class="co">#'geno', </span></span>
<span id="cb14-155"><a href="#cb14-155" aria-hidden="true" tabindex="-1"></a>                      <span class="st">'wthr'</span>, <span class="st">'soil'</span>, <span class="st">'mgmt'</span>]:</span>
<span id="cb14-156"><a href="#cb14-156" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> <span class="bu">type</span>(<span class="bu">getattr</span>(<span class="va">self</span>,  entry).data) <span class="op">==</span> <span class="bu">type</span>(<span class="va">None</span>):</span>
<span id="cb14-157"><a href="#cb14-157" aria-hidden="true" tabindex="-1"></a>                <span class="bu">print</span>(entry<span class="op">+</span><span class="st">" is not initialized and None type."</span>)</span>
<span id="cb14-158"><a href="#cb14-158" aria-hidden="true" tabindex="-1"></a>            <span class="cf">else</span>:</span>
<span id="cb14-159"><a href="#cb14-159" aria-hidden="true" tabindex="-1"></a>                rename_cols_dict <span class="op">=</span> {}</span>
<span id="cb14-160"><a href="#cb14-160" aria-hidden="true" tabindex="-1"></a>                drop_cols_list <span class="op">=</span> []</span>
<span id="cb14-161"><a href="#cb14-161" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-162"><a href="#cb14-162" aria-hidden="true" tabindex="-1"></a>                <span class="cf">if</span> entry <span class="op">==</span> <span class="st">"meta"</span>:</span>
<span id="cb14-163"><a href="#cb14-163" aria-hidden="true" tabindex="-1"></a>                    rename_cols_dict.update({</span>
<span id="cb14-164"><a href="#cb14-164" aria-hidden="true" tabindex="-1"></a>                        <span class="st">'Weather_station_serial_number_(Last_four_digits,_e.g.</span><span class="ch">\xa0</span><span class="st">m2700s#####)'</span>: <span class="st">'Weather_station_serial_number_(Last_four_digits,_e.g._m2700s#####)'</span></span>
<span id="cb14-165"><a href="#cb14-165" aria-hidden="true" tabindex="-1"></a>                    })</span>
<span id="cb14-166"><a href="#cb14-166" aria-hidden="true" tabindex="-1"></a>                <span class="cf">if</span> entry <span class="op">==</span> <span class="st">"phno"</span>:</span>
<span id="cb14-167"><a href="#cb14-167" aria-hidden="true" tabindex="-1"></a>                    rename_cols_dict.update({</span>
<span id="cb14-168"><a href="#cb14-168" aria-hidden="true" tabindex="-1"></a>                        <span class="st">'LOCAL_cHECK_(Yes,_no[Blank])'</span>: <span class="st">'Local_check_(Yes,_no)'</span>, </span>
<span id="cb14-169"><a href="#cb14-169" aria-hidden="true" tabindex="-1"></a>                        <span class="st">'Plot_length_field'</span>: <span class="st">'Plot_length_(center-alley_to_center-alley_in_feet)'</span>, </span>
<span id="cb14-170"><a href="#cb14-170" aria-hidden="true" tabindex="-1"></a>                        <span class="st">'Alley_length'</span>: <span class="st">'Alley_length_(in_inches)'</span>, </span>
<span id="cb14-171"><a href="#cb14-171" aria-hidden="true" tabindex="-1"></a>                        <span class="st">'Row_spacing'</span>: <span class="st">'Row_spacing_(in_inches)'</span>, </span>
<span id="cb14-172"><a href="#cb14-172" aria-hidden="true" tabindex="-1"></a>                        <span class="st">'Date_planted'</span>: <span class="st">'Date_plot_planted_[MM/DD/YY]'</span>, </span>
<span id="cb14-173"><a href="#cb14-173" aria-hidden="true" tabindex="-1"></a>                        <span class="st">'Date_harvested'</span>: <span class="st">'Date_plot_harvested_[MM/DD/YY]'</span>, </span>
<span id="cb14-174"><a href="#cb14-174" aria-hidden="true" tabindex="-1"></a>                        <span class="st">'Anthesis_[date]'</span>: <span class="st">'Anthesis_[MM/DD/YY]'</span>, </span>
<span id="cb14-175"><a href="#cb14-175" aria-hidden="true" tabindex="-1"></a>                        <span class="st">'Silking_[date]'</span>: <span class="st">'Silking_[MM/DD/YY]'</span>, </span>
<span id="cb14-176"><a href="#cb14-176" aria-hidden="true" tabindex="-1"></a>                        <span class="st">'Pollen_dAP_[days]'</span>: <span class="st">'Anthesis_[days]'</span>, </span>
<span id="cb14-177"><a href="#cb14-177" aria-hidden="true" tabindex="-1"></a>                        <span class="st">'Silk_dAP_[days]'</span>: <span class="st">'Silking_[days]'</span>, </span>
<span id="cb14-178"><a href="#cb14-178" aria-hidden="true" tabindex="-1"></a>                        <span class="st">'Stand_count_[plants]'</span>: <span class="st">'Stand_count_[#_of_plants]'</span>, </span>
<span id="cb14-179"><a href="#cb14-179" aria-hidden="true" tabindex="-1"></a>                        <span class="st">'Root_lodging_[plants]'</span>: <span class="st">'Root_lodging_[#_of_plants]'</span>, </span>
<span id="cb14-180"><a href="#cb14-180" aria-hidden="true" tabindex="-1"></a>                        <span class="st">'Stalk_lodging_[plants]'</span>: <span class="st">'Stalk_lodging_[#_of_plants]'</span>, </span>
<span id="cb14-181"><a href="#cb14-181" aria-hidden="true" tabindex="-1"></a>                        <span class="st">'Test_weight_[lbs/bu]'</span>: <span class="st">'Test_weight_[lbs]'</span>, </span>
<span id="cb14-182"><a href="#cb14-182" aria-hidden="true" tabindex="-1"></a>                        <span class="st">'Grain_yield_[bu/A]'</span>: <span class="st">'Grain_yield_(bu/A)'</span>, </span>
<span id="cb14-183"><a href="#cb14-183" aria-hidden="true" tabindex="-1"></a>                        <span class="st">'Plot_discarded_[enter_"yes"_or_"blank"]'</span>: <span class="st">"Plot_discarded_[enter_'yes'_or_blank]"</span>, </span>
<span id="cb14-184"><a href="#cb14-184" aria-hidden="true" tabindex="-1"></a>                        <span class="st">'Filler_[enter_"filler"_or_"blank"]'</span>: <span class="st">'Filler'</span>, </span>
<span id="cb14-185"><a href="#cb14-185" aria-hidden="true" tabindex="-1"></a>                        <span class="st">'[add_additional_measurements_here]'</span>: <span class="st">'Additional_measurements'</span></span>
<span id="cb14-186"><a href="#cb14-186" aria-hidden="true" tabindex="-1"></a>                    })</span>
<span id="cb14-187"><a href="#cb14-187" aria-hidden="true" tabindex="-1"></a>                    drop_cols_list <span class="op">=</span> [<span class="st">'Year'</span>]</span>
<span id="cb14-188"><a href="#cb14-188" aria-hidden="true" tabindex="-1"></a>                <span class="cf">if</span> entry <span class="op">==</span> <span class="st">"wthr"</span>:</span>
<span id="cb14-189"><a href="#cb14-189" aria-hidden="true" tabindex="-1"></a>                    rename_cols_dict.update({</span>
<span id="cb14-190"><a href="#cb14-190" aria-hidden="true" tabindex="-1"></a>                        <span class="st">'Time[Local]'</span>: <span class="st">'Time'</span>, </span>
<span id="cb14-191"><a href="#cb14-191" aria-hidden="true" tabindex="-1"></a>                        <span class="st">'Rainfall[mm]'</span>: <span class="st">'Rainfall_[mm]'</span>, </span>
<span id="cb14-192"><a href="#cb14-192" aria-hidden="true" tabindex="-1"></a>                        <span class="st">'Photoperiod[hours]'</span>: <span class="st">'Photoperiod_[hours]'</span></span>
<span id="cb14-193"><a href="#cb14-193" aria-hidden="true" tabindex="-1"></a>                    })</span>
<span id="cb14-194"><a href="#cb14-194" aria-hidden="true" tabindex="-1"></a>                <span class="cf">if</span> entry <span class="op">==</span> <span class="st">"soil"</span>:</span>
<span id="cb14-195"><a href="#cb14-195" aria-hidden="true" tabindex="-1"></a>                    rename_cols_dict.update({</span>
<span id="cb14-196"><a href="#cb14-196" aria-hidden="true" tabindex="-1"></a>                        <span class="st">'Zinc_ppm_zn'</span>: <span class="st">'Zinc_ppm_Zn'</span>, </span>
<span id="cb14-197"><a href="#cb14-197" aria-hidden="true" tabindex="-1"></a>                        <span class="st">'Iron_ppm_fe'</span>: <span class="st">'Iron_ppm_Fe'</span>, </span>
<span id="cb14-198"><a href="#cb14-198" aria-hidden="true" tabindex="-1"></a>                        <span class="st">'Manganese_ppm_mn'</span>: <span class="st">'Manganese_ppm_Mn'</span>, </span>
<span id="cb14-199"><a href="#cb14-199" aria-hidden="true" tabindex="-1"></a>                        <span class="st">'Copper_ppm_cu'</span>: <span class="st">'Copper_ppm_Cu'</span>, </span>
<span id="cb14-200"><a href="#cb14-200" aria-hidden="true" tabindex="-1"></a>                        <span class="st">'Boron_ppm_b'</span>: <span class="st">'Boron_ppm_B'</span></span>
<span id="cb14-201"><a href="#cb14-201" aria-hidden="true" tabindex="-1"></a>                    })</span>
<span id="cb14-202"><a href="#cb14-202" aria-hidden="true" tabindex="-1"></a>                    drop_cols_list <span class="op">=</span> [<span class="st">'Sample_type'</span>]</span>
<span id="cb14-203"><a href="#cb14-203" aria-hidden="true" tabindex="-1"></a>                <span class="cf">if</span> entry <span class="op">==</span> <span class="st">"mgmt"</span>:</span>
<span id="cb14-204"><a href="#cb14-204" aria-hidden="true" tabindex="-1"></a>                    rename_cols_dict.update({</span>
<span id="cb14-205"><a href="#cb14-205" aria-hidden="true" tabindex="-1"></a>                        <span class="st">'Experiment_code'</span>: <span class="st">'Location'</span>, </span>
<span id="cb14-206"><a href="#cb14-206" aria-hidden="true" tabindex="-1"></a>                        <span class="st">'Product/Nutrient_applied'</span>: <span class="st">'Quantity_per_acre'</span>, </span>
<span id="cb14-207"><a href="#cb14-207" aria-hidden="true" tabindex="-1"></a>                        <span class="st">'Application_unit</span><span class="ch">\n</span><span class="st">(lbs,_in,_oz_per_acre)'</span>: <span class="st">'Application_unit'</span></span>
<span id="cb14-208"><a href="#cb14-208" aria-hidden="true" tabindex="-1"></a>                    })</span>
<span id="cb14-209"><a href="#cb14-209" aria-hidden="true" tabindex="-1"></a>                    drop_cols_list <span class="op">=</span> [<span class="st">'Record_order'</span>, <span class="st">'Record_ID'</span>]</span>
<span id="cb14-210"><a href="#cb14-210" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-211"><a href="#cb14-211" aria-hidden="true" tabindex="-1"></a>                <span class="bu">getattr</span>(<span class="va">self</span>,  entry).data <span class="op">=</span> <span class="bu">getattr</span>(<span class="va">self</span>,  entry).data.rename(columns <span class="op">=</span> rename_cols_dict)</span>
<span id="cb14-212"><a href="#cb14-212" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-213"><a href="#cb14-213" aria-hidden="true" tabindex="-1"></a>                <span class="cf">if</span> drop_cols_list <span class="op">!=</span> []:</span>
<span id="cb14-214"><a href="#cb14-214" aria-hidden="true" tabindex="-1"></a>                    <span class="bu">getattr</span>(<span class="va">self</span>,  entry).data <span class="op">=</span> <span class="bu">getattr</span>(<span class="va">self</span>,  entry).data.drop(drop_cols_list, axis<span class="op">=</span><span class="dv">1</span>)</span>
<span id="cb14-215"><a href="#cb14-215" aria-hidden="true" tabindex="-1"></a><span class="kw">class</span> g2f_2015(g2f_year):</span>
<span id="cb14-216"><a href="#cb14-216" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> standardize_all_transformed_names(<span class="va">self</span>):</span>
<span id="cb14-217"><a href="#cb14-217" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> entry <span class="kw">in</span> [<span class="st">'meta'</span>, <span class="st">'phno'</span>, <span class="co">#'geno', </span></span>
<span id="cb14-218"><a href="#cb14-218" aria-hidden="true" tabindex="-1"></a>                      <span class="st">'wthr'</span>, <span class="st">'soil'</span>, <span class="st">'mgmt'</span>]:</span>
<span id="cb14-219"><a href="#cb14-219" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> <span class="bu">type</span>(<span class="bu">getattr</span>(<span class="va">self</span>,  entry).data) <span class="op">==</span> <span class="bu">type</span>(<span class="va">None</span>):</span>
<span id="cb14-220"><a href="#cb14-220" aria-hidden="true" tabindex="-1"></a>                <span class="bu">print</span>(entry<span class="op">+</span><span class="st">" is not initialized and None type."</span>)</span>
<span id="cb14-221"><a href="#cb14-221" aria-hidden="true" tabindex="-1"></a>            <span class="cf">else</span>:</span>
<span id="cb14-222"><a href="#cb14-222" aria-hidden="true" tabindex="-1"></a>                rename_cols_dict <span class="op">=</span> {}</span>
<span id="cb14-223"><a href="#cb14-223" aria-hidden="true" tabindex="-1"></a>                drop_cols_list <span class="op">=</span> []</span>
<span id="cb14-224"><a href="#cb14-224" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-225"><a href="#cb14-225" aria-hidden="true" tabindex="-1"></a>                <span class="cf">if</span> entry <span class="op">==</span> <span class="st">"meta"</span>:</span>
<span id="cb14-226"><a href="#cb14-226" aria-hidden="true" tabindex="-1"></a>                    rename_cols_dict.update({</span>
<span id="cb14-227"><a href="#cb14-227" aria-hidden="true" tabindex="-1"></a>                        <span class="st">'Experiment'</span>: <span class="st">'Location'</span>,  </span>
<span id="cb14-228"><a href="#cb14-228" aria-hidden="true" tabindex="-1"></a>                        <span class="st">'WS_sN'</span>: <span class="st">'Weather_station_serial_number_(Last_four_digits,_e.g._m2700s#####)'</span>, </span>
<span id="cb14-229"><a href="#cb14-229" aria-hidden="true" tabindex="-1"></a>                        <span class="st">'WS_lat'</span>: <span class="st">'Weather_station_latitude_(in_decimal_numbers_nOT_dMS)'</span>,</span>
<span id="cb14-230"><a href="#cb14-230" aria-hidden="true" tabindex="-1"></a>                        <span class="st">'WS_lon'</span>: <span class="st">'Weather_station_longitude_(in_decimal_numbers_nOT_dMS)'</span>, </span>
<span id="cb14-231"><a href="#cb14-231" aria-hidden="true" tabindex="-1"></a>                        <span class="st">'DateIn'</span>: <span class="st">'Date_weather_station_placed'</span>, </span>
<span id="cb14-232"><a href="#cb14-232" aria-hidden="true" tabindex="-1"></a>                        <span class="st">'DateOut'</span>: <span class="st">'Date_weather_station_removed'</span>, </span>
<span id="cb14-233"><a href="#cb14-233" aria-hidden="true" tabindex="-1"></a>                        <span class="st">'Tillage'</span>: <span class="st">'Pre-plant_tillage_method(s)'</span>, </span>
<span id="cb14-234"><a href="#cb14-234" aria-hidden="true" tabindex="-1"></a>                        <span class="st">'PlotLen'</span>: <span class="st">'Plot_length_(center-alley_to_center-alley_in_feet)'</span>, </span>
<span id="cb14-235"><a href="#cb14-235" aria-hidden="true" tabindex="-1"></a>                        <span class="st">'AlleyLen'</span>: <span class="st">'Alley_length_(in_inches)'</span>, </span>
<span id="cb14-236"><a href="#cb14-236" aria-hidden="true" tabindex="-1"></a>                        <span class="st">'RowSp'</span>: <span class="st">'Row_spacing_(in_inches)'</span>, </span>
<span id="cb14-237"><a href="#cb14-237" aria-hidden="true" tabindex="-1"></a>                        <span class="st">'PlanterType'</span>: <span class="st">'Type_of_planter_(fluted_cone;_belt_cone;_air_planter)'</span>, </span>
<span id="cb14-238"><a href="#cb14-238" aria-hidden="true" tabindex="-1"></a>                        <span class="st">'KernelsPerPlot'</span>: <span class="st">'Number_kernels_planted_per_plot_(&gt;200_seed/pack_for_cone_planters)'</span>, </span>
<span id="cb14-239"><a href="#cb14-239" aria-hidden="true" tabindex="-1"></a>                        <span class="st">'Moisture_meter'</span>: <span class="st">'System_determining_moisture'</span>, </span>
<span id="cb14-240"><a href="#cb14-240" aria-hidden="true" tabindex="-1"></a>                        <span class="st">'Corner1_lat'</span>: <span class="st">'Latitude_of_field_corner_#1_(lower_left)'</span>, </span>
<span id="cb14-241"><a href="#cb14-241" aria-hidden="true" tabindex="-1"></a>                        <span class="st">'Corner1_lon'</span>: <span class="st">'Longitude_of_field_corner_#1_(lower_left)'</span>, </span>
<span id="cb14-242"><a href="#cb14-242" aria-hidden="true" tabindex="-1"></a>                        <span class="st">'Corner_2lat'</span>: <span class="st">'Latitude_of_field_corner_#2_(lower_right)'</span>, </span>
<span id="cb14-243"><a href="#cb14-243" aria-hidden="true" tabindex="-1"></a>                        <span class="st">'Corner2_lon'</span>: <span class="st">'Longitude_of_field_corner_#2_(lower_right)'</span>,</span>
<span id="cb14-244"><a href="#cb14-244" aria-hidden="true" tabindex="-1"></a>                        <span class="st">'Corner3_lat'</span>: <span class="st">'Latitude_of_field_corner_#3_(upper_right)'</span>, </span>
<span id="cb14-245"><a href="#cb14-245" aria-hidden="true" tabindex="-1"></a>                        <span class="st">'Corner3_lon'</span>: <span class="st">'Longitude_of_field_corner_#3_(upper_right)'</span>, </span>
<span id="cb14-246"><a href="#cb14-246" aria-hidden="true" tabindex="-1"></a>                        <span class="st">'Corner4_lat'</span>: <span class="st">'Latitude_of_field_corner_#4_(upper_left)'</span>, </span>
<span id="cb14-247"><a href="#cb14-247" aria-hidden="true" tabindex="-1"></a>                        <span class="st">'Corner4_lon'</span>: <span class="st">'Longitude_of_field_corner_#4_(upper_left)'</span>, </span>
<span id="cb14-248"><a href="#cb14-248" aria-hidden="true" tabindex="-1"></a>                        <span class="st">'Cardinal'</span>: <span class="st">'Cardinal_heading_pass_1'</span>, </span>
<span id="cb14-249"><a href="#cb14-249" aria-hidden="true" tabindex="-1"></a>                        <span class="st">'Date_of_soil_sampling'</span>: <span class="st">'Date_Collected'</span>, </span>
<span id="cb14-250"><a href="#cb14-250" aria-hidden="true" tabindex="-1"></a>                    })</span>
<span id="cb14-251"><a href="#cb14-251" aria-hidden="true" tabindex="-1"></a>                    </span>
<span id="cb14-252"><a href="#cb14-252" aria-hidden="true" tabindex="-1"></a>                    drop_cols_list <span class="op">=</span> []</span>
<span id="cb14-253"><a href="#cb14-253" aria-hidden="true" tabindex="-1"></a>                <span class="cf">if</span> entry <span class="op">==</span> <span class="st">"phno"</span>:</span>
<span id="cb14-254"><a href="#cb14-254" aria-hidden="true" tabindex="-1"></a>                    rename_cols_dict.update({ </span>
<span id="cb14-255"><a href="#cb14-255" aria-hidden="true" tabindex="-1"></a>                        <span class="st">'LOCAL_cHECK_(Yes,_no[Blank])'</span>: <span class="st">'Local_check_(Yes,_no)'</span>, </span>
<span id="cb14-256"><a href="#cb14-256" aria-hidden="true" tabindex="-1"></a>                        <span class="st">'Plot_length_field_(center_to_center_in_feet)'</span>: <span class="st">'Plot_length_(center-alley_to_center-alley_in_feet)'</span>, </span>
<span id="cb14-257"><a href="#cb14-257" aria-hidden="true" tabindex="-1"></a>                        <span class="st">'Alley_length_(feet)'</span>: <span class="st">'Alley_length_(in_feet)'</span>, </span>
<span id="cb14-258"><a href="#cb14-258" aria-hidden="true" tabindex="-1"></a>                        <span class="st">'Row_spacing_(inches)'</span>: <span class="st">'Row_spacing_(in_inches)'</span>, </span>
<span id="cb14-259"><a href="#cb14-259" aria-hidden="true" tabindex="-1"></a>                        <span class="st">'Date_planted'</span>: <span class="st">'Date_plot_planted_[MM/DD/YY]'</span>, </span>
<span id="cb14-260"><a href="#cb14-260" aria-hidden="true" tabindex="-1"></a>                        <span class="st">'Date_harvested'</span>: <span class="st">'Date_plot_harvested_[MM/DD/YY]'</span>, </span>
<span id="cb14-261"><a href="#cb14-261" aria-hidden="true" tabindex="-1"></a>                        <span class="st">'Anthesis_[date]'</span>: <span class="st">'Anthesis_[MM/DD/YY]'</span>, </span>
<span id="cb14-262"><a href="#cb14-262" aria-hidden="true" tabindex="-1"></a>                        <span class="st">'Silking_[date]'</span>: <span class="st">'Silking_[MM/DD/YY]'</span>, </span>
<span id="cb14-263"><a href="#cb14-263" aria-hidden="true" tabindex="-1"></a>                        <span class="st">'Pollen_dAP_[days]'</span>: <span class="st">'Anthesis_[days]'</span>, </span>
<span id="cb14-264"><a href="#cb14-264" aria-hidden="true" tabindex="-1"></a>                        <span class="st">'Silk_dAP_[days]'</span>: <span class="st">'Silking_[days]'</span>, </span>
<span id="cb14-265"><a href="#cb14-265" aria-hidden="true" tabindex="-1"></a>                        <span class="st">'Stand_count_[plants]'</span>: <span class="st">'Stand_count_[#_of_plants]'</span>, </span>
<span id="cb14-266"><a href="#cb14-266" aria-hidden="true" tabindex="-1"></a>                        <span class="st">'Root_lodging_[plants]'</span>: <span class="st">'Root_lodging_[#_of_plants]'</span>, </span>
<span id="cb14-267"><a href="#cb14-267" aria-hidden="true" tabindex="-1"></a>                        <span class="st">'Stalk_lodging_[plants]'</span>: <span class="st">'Stalk_lodging_[#_of_plants]'</span>, </span>
<span id="cb14-268"><a href="#cb14-268" aria-hidden="true" tabindex="-1"></a>                        <span class="st">'Test_weight_[lbs/bu]'</span>: <span class="st">'Test_weight_[lbs]'</span>, </span>
<span id="cb14-269"><a href="#cb14-269" aria-hidden="true" tabindex="-1"></a>                        <span class="st">'Grain_yield_[bu/A]'</span>: <span class="st">'Grain_yield_(bu/A)'</span>, </span>
<span id="cb14-270"><a href="#cb14-270" aria-hidden="true" tabindex="-1"></a>                        <span class="st">'Plot_discarded_[enter_"yes"_or_"blank"]'</span>: <span class="st">"Plot_discarded_[enter_'yes'_or_blank]"</span>, </span>
<span id="cb14-271"><a href="#cb14-271" aria-hidden="true" tabindex="-1"></a>                        <span class="st">'Filler_[enter_"filler"_or_"blank"]'</span>: <span class="st">'Filler'</span>, </span>
<span id="cb14-272"><a href="#cb14-272" aria-hidden="true" tabindex="-1"></a>                        <span class="st">'[add_additional_measurements_here]'</span>: <span class="st">'Additional_measurements'</span></span>
<span id="cb14-273"><a href="#cb14-273" aria-hidden="true" tabindex="-1"></a>                    })</span>
<span id="cb14-274"><a href="#cb14-274" aria-hidden="true" tabindex="-1"></a>                    drop_cols_list <span class="op">=</span> []</span>
<span id="cb14-275"><a href="#cb14-275" aria-hidden="true" tabindex="-1"></a>                <span class="cf">if</span> entry <span class="op">==</span> <span class="st">"wthr"</span>:</span>
<span id="cb14-276"><a href="#cb14-276" aria-hidden="true" tabindex="-1"></a>                    rename_cols_dict.update({</span>
<span id="cb14-277"><a href="#cb14-277" aria-hidden="true" tabindex="-1"></a>                        <span class="st">'Record_number'</span>: <span class="st">'Record_number'</span>, </span>
<span id="cb14-278"><a href="#cb14-278" aria-hidden="true" tabindex="-1"></a>                        <span class="st">'Experiment(s)'</span>: <span class="st">'Location(s)'</span>, </span>
<span id="cb14-279"><a href="#cb14-279" aria-hidden="true" tabindex="-1"></a>                        <span class="st">'Day_of_year'</span>: <span class="st">'DOY'</span>, </span>
<span id="cb14-280"><a href="#cb14-280" aria-hidden="true" tabindex="-1"></a>                        <span class="st">'Time_[Local]'</span>: <span class="st">'Time'</span>, </span>
<span id="cb14-281"><a href="#cb14-281" aria-hidden="true" tabindex="-1"></a>                        <span class="st">'Datetime_[UTC]'</span>: <span class="st">'Datetime_[UTC]'</span>, </span>
<span id="cb14-282"><a href="#cb14-282" aria-hidden="true" tabindex="-1"></a>                        <span class="st">'Soil_moisture_[%]'</span>: <span class="st">'Soil_moisture_[%VWC]'</span>, </span>
<span id="cb14-283"><a href="#cb14-283" aria-hidden="true" tabindex="-1"></a>                        <span class="st">'Photoperiod_[hours]'</span>: <span class="st">'Photoperiod_[hours]'</span></span>
<span id="cb14-284"><a href="#cb14-284" aria-hidden="true" tabindex="-1"></a>                    })</span>
<span id="cb14-285"><a href="#cb14-285" aria-hidden="true" tabindex="-1"></a>                    drop_cols_list <span class="op">=</span> []</span>
<span id="cb14-286"><a href="#cb14-286" aria-hidden="true" tabindex="-1"></a>                <span class="cf">if</span> entry <span class="op">==</span> <span class="st">"soil"</span>:</span>
<span id="cb14-287"><a href="#cb14-287" aria-hidden="true" tabindex="-1"></a>                    rename_cols_dict.update({</span>
<span id="cb14-288"><a href="#cb14-288" aria-hidden="true" tabindex="-1"></a>                        <span class="st">'LabID'</span>: <span class="st">'Lab_id'</span>, </span>
<span id="cb14-289"><a href="#cb14-289" aria-hidden="true" tabindex="-1"></a>                        <span class="st">'LabSmplID'</span>: <span class="st">'Lab_sample_id'</span>, </span>
<span id="cb14-290"><a href="#cb14-290" aria-hidden="true" tabindex="-1"></a>                        <span class="st">'SmplDate'</span>: <span class="st">'Date_Collected'</span>, </span>
<span id="cb14-291"><a href="#cb14-291" aria-hidden="true" tabindex="-1"></a>                        <span class="st">'CoopName'</span>: <span class="st">'Cooperator'</span>, </span>
<span id="cb14-292"><a href="#cb14-292" aria-hidden="true" tabindex="-1"></a>                        <span class="st">'Experiment'</span>: <span class="st">'Location'</span>, </span>
<span id="cb14-293"><a href="#cb14-293" aria-hidden="true" tabindex="-1"></a>                        <span class="st">'PlowDepth'</span>: <span class="st">'Plow_depth'</span>, </span>
<span id="cb14-294"><a href="#cb14-294" aria-hidden="true" tabindex="-1"></a>                    })</span>
<span id="cb14-295"><a href="#cb14-295" aria-hidden="true" tabindex="-1"></a>                    drop_cols_list <span class="op">=</span> []</span>
<span id="cb14-296"><a href="#cb14-296" aria-hidden="true" tabindex="-1"></a>                <span class="cf">if</span> entry <span class="op">==</span> <span class="st">"mgmt"</span>:</span>
<span id="cb14-297"><a href="#cb14-297" aria-hidden="true" tabindex="-1"></a>                    rename_cols_dict.update({</span>
<span id="cb14-298"><a href="#cb14-298" aria-hidden="true" tabindex="-1"></a>                    })</span>
<span id="cb14-299"><a href="#cb14-299" aria-hidden="true" tabindex="-1"></a>                    drop_cols_list <span class="op">=</span> []</span>
<span id="cb14-300"><a href="#cb14-300" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-301"><a href="#cb14-301" aria-hidden="true" tabindex="-1"></a>                <span class="bu">getattr</span>(<span class="va">self</span>,  entry).data <span class="op">=</span> <span class="bu">getattr</span>(<span class="va">self</span>,  entry).data.rename(columns <span class="op">=</span> rename_cols_dict)</span>
<span id="cb14-302"><a href="#cb14-302" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-303"><a href="#cb14-303" aria-hidden="true" tabindex="-1"></a>                <span class="cf">if</span> drop_cols_list <span class="op">!=</span> []:</span>
<span id="cb14-304"><a href="#cb14-304" aria-hidden="true" tabindex="-1"></a>                    <span class="bu">getattr</span>(<span class="va">self</span>,  entry).data <span class="op">=</span> <span class="bu">getattr</span>(<span class="va">self</span>,  entry).data.drop(drop_cols_list, axis<span class="op">=</span><span class="dv">1</span>)</span>
<span id="cb14-305"><a href="#cb14-305" aria-hidden="true" tabindex="-1"></a>                    </span>
<span id="cb14-306"><a href="#cb14-306" aria-hidden="true" tabindex="-1"></a><span class="kw">class</span> g2f_2014(g2f_year):</span>
<span id="cb14-307"><a href="#cb14-307" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> standardize_all_transformed_names(<span class="va">self</span>):</span>
<span id="cb14-308"><a href="#cb14-308" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> entry <span class="kw">in</span> [<span class="st">'meta'</span>, <span class="st">'phno'</span>, <span class="co">#'geno', </span></span>
<span id="cb14-309"><a href="#cb14-309" aria-hidden="true" tabindex="-1"></a>                      <span class="st">'wthr'</span>, <span class="st">'soil'</span>, <span class="st">'mgmt'</span>]:</span>
<span id="cb14-310"><a href="#cb14-310" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> <span class="bu">type</span>(<span class="bu">getattr</span>(<span class="va">self</span>,  entry).data) <span class="op">==</span> <span class="bu">type</span>(<span class="va">None</span>):</span>
<span id="cb14-311"><a href="#cb14-311" aria-hidden="true" tabindex="-1"></a>                <span class="bu">print</span>(entry<span class="op">+</span><span class="st">" is not initialized and None type."</span>)</span>
<span id="cb14-312"><a href="#cb14-312" aria-hidden="true" tabindex="-1"></a>            <span class="cf">else</span>:</span>
<span id="cb14-313"><a href="#cb14-313" aria-hidden="true" tabindex="-1"></a>                rename_cols_dict <span class="op">=</span> {}</span>
<span id="cb14-314"><a href="#cb14-314" aria-hidden="true" tabindex="-1"></a>                drop_cols_list <span class="op">=</span> []</span>
<span id="cb14-315"><a href="#cb14-315" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-316"><a href="#cb14-316" aria-hidden="true" tabindex="-1"></a>                <span class="cf">if</span> entry <span class="op">==</span> <span class="st">"meta"</span>:</span>
<span id="cb14-317"><a href="#cb14-317" aria-hidden="true" tabindex="-1"></a>                    rename_cols_dict.update({</span>
<span id="cb14-318"><a href="#cb14-318" aria-hidden="true" tabindex="-1"></a>                        <span class="st">'Location_name'</span>: <span class="st">'Location_short'</span>, </span>
<span id="cb14-319"><a href="#cb14-319" aria-hidden="true" tabindex="-1"></a>                        <span class="st">'Experiment'</span>: <span class="st">'Location'</span>, </span>
<span id="cb14-320"><a href="#cb14-320" aria-hidden="true" tabindex="-1"></a>                        <span class="st">'Long'</span>: <span class="st">'Weather_station_longitude_(in_decimal_numbers_nOT_dMS)'</span>, </span>
<span id="cb14-321"><a href="#cb14-321" aria-hidden="true" tabindex="-1"></a>                        <span class="st">'Lat'</span>: <span class="st">'Weather_station_latitude_(in_decimal_numbers_nOT_dMS)'</span>, </span>
<span id="cb14-322"><a href="#cb14-322" aria-hidden="true" tabindex="-1"></a>                        <span class="st">'Plot_length_(center_to_center_in_feet)'</span>: <span class="st">'Plot_length_(center-alley_to_center-alley_in_feet)'</span>, </span>
<span id="cb14-323"><a href="#cb14-323" aria-hidden="true" tabindex="-1"></a>                        <span class="st">'Alley_length_(inches)'</span>: <span class="st">'Alley_length_(in_inches)'</span>, </span>
<span id="cb14-324"><a href="#cb14-324" aria-hidden="true" tabindex="-1"></a>                        <span class="st">'Row_spacing_(inches)'</span>: <span class="st">'Row_spacing_(in_inches)'</span>, </span>
<span id="cb14-325"><a href="#cb14-325" aria-hidden="true" tabindex="-1"></a>                        <span class="st">'Number_kernels_planted'</span>: <span class="st">'Number_kernels_planted_per_plot_(&gt;200_seed/pack_for_cone_planters)'</span>, </span>
<span id="cb14-326"><a href="#cb14-326" aria-hidden="true" tabindex="-1"></a>                        <span class="st">'Planter_type'</span>: <span class="st">'Type_of_planter_(fluted_cone;_belt_cone;_air_planter)'</span>, </span>
<span id="cb14-327"><a href="#cb14-327" aria-hidden="true" tabindex="-1"></a>                        <span class="st">'Harvest_date'</span>: <span class="st">'Date_plot_harvested_[MM/DD/YY]'</span>, </span>
<span id="cb14-328"><a href="#cb14-328" aria-hidden="true" tabindex="-1"></a>                        <span class="st">'Planting_date'</span>: <span class="st">'Date_plot_planted_[MM/DD/YY]'</span>,</span>
<span id="cb14-329"><a href="#cb14-329" aria-hidden="true" tabindex="-1"></a>                        <span class="st">'Folder'</span>: <span class="st">'State'</span>, </span>
<span id="cb14-330"><a href="#cb14-330" aria-hidden="true" tabindex="-1"></a>                        <span class="st">'Weather_station_serial_number'</span>: <span class="st">'Weather_station_serial_number_(Last_four_digits,_e.g._m2700s#####)'</span></span>
<span id="cb14-331"><a href="#cb14-331" aria-hidden="true" tabindex="-1"></a>                    })</span>
<span id="cb14-332"><a href="#cb14-332" aria-hidden="true" tabindex="-1"></a>                    drop_cols_list <span class="op">=</span> [<span class="st">'Traits'</span>, <span class="st">'Data_file_name'</span>, <span class="st">'Metadata_file_name'</span>, </span>
<span id="cb14-333"><a href="#cb14-333" aria-hidden="true" tabindex="-1"></a>                        <span class="st">'Additional_metadata'</span>, </span>
<span id="cb14-334"><a href="#cb14-334" aria-hidden="true" tabindex="-1"></a>                        <span class="st">'Weather-folder'</span>]</span>
<span id="cb14-335"><a href="#cb14-335" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-336"><a href="#cb14-336" aria-hidden="true" tabindex="-1"></a>                <span class="cf">if</span> entry <span class="op">==</span> <span class="st">"phno"</span>:</span>
<span id="cb14-337"><a href="#cb14-337" aria-hidden="true" tabindex="-1"></a>                    rename_cols_dict.update({</span>
<span id="cb14-338"><a href="#cb14-338" aria-hidden="true" tabindex="-1"></a>                        <span class="st">'LOCAL_cHECK_(Yes,_no[Blank])'</span>: <span class="st">'Local_check_(Yes,_no)'</span>, </span>
<span id="cb14-339"><a href="#cb14-339" aria-hidden="true" tabindex="-1"></a>                        <span class="st">'Alley_length'</span>: <span class="st">'Alley_length_(in_inches)'</span>, </span>
<span id="cb14-340"><a href="#cb14-340" aria-hidden="true" tabindex="-1"></a>                        <span class="st">'Row_spacing'</span>: <span class="st">'Row_spacing_(in_inches)'</span>, </span>
<span id="cb14-341"><a href="#cb14-341" aria-hidden="true" tabindex="-1"></a>                        <span class="st">'Date_planted'</span>: <span class="st">'Date_plot_planted_[MM/DD/YY]'</span>, </span>
<span id="cb14-342"><a href="#cb14-342" aria-hidden="true" tabindex="-1"></a>                        <span class="st">'Date_harvested'</span>: <span class="st">'Date_plot_harvested_[MM/DD/YY]'</span>, </span>
<span id="cb14-343"><a href="#cb14-343" aria-hidden="true" tabindex="-1"></a>                        <span class="st">'Anthesis_[date]'</span>: <span class="st">'Anthesis_[MM/DD/YY]'</span>, </span>
<span id="cb14-344"><a href="#cb14-344" aria-hidden="true" tabindex="-1"></a>                        <span class="st">'Silking_[date]'</span>: <span class="st">'Silking_[MM/DD/YY]'</span>, </span>
<span id="cb14-345"><a href="#cb14-345" aria-hidden="true" tabindex="-1"></a>                        <span class="st">'Pollen_dAP_[days]'</span>: <span class="st">'Anthesis_[days]'</span>, </span>
<span id="cb14-346"><a href="#cb14-346" aria-hidden="true" tabindex="-1"></a>                        <span class="st">'Silk_dAP_[days]'</span>: <span class="st">'Silking_[days]'</span>, </span>
<span id="cb14-347"><a href="#cb14-347" aria-hidden="true" tabindex="-1"></a>                        <span class="st">'Stand_count_[plants]'</span>: <span class="st">'Stand_count_[#_of_plants]'</span>, </span>
<span id="cb14-348"><a href="#cb14-348" aria-hidden="true" tabindex="-1"></a>                        <span class="st">'Test_weight_[lbs/bu]'</span>: <span class="st">'Test_weight_[lbs]'</span>, </span>
<span id="cb14-349"><a href="#cb14-349" aria-hidden="true" tabindex="-1"></a>                        <span class="st">'Grain_yield_[bu/A]'</span>: <span class="st">'Grain_yield_(bu/A)'</span>, </span>
<span id="cb14-350"><a href="#cb14-350" aria-hidden="true" tabindex="-1"></a>                        <span class="st">'Plot_discarded_[enter_"yes"_or_"blank"]'</span>: <span class="st">"Plot_discarded_[enter_'yes'_or_blank]"</span></span>
<span id="cb14-351"><a href="#cb14-351" aria-hidden="true" tabindex="-1"></a>                    })</span>
<span id="cb14-352"><a href="#cb14-352" aria-hidden="true" tabindex="-1"></a>                    drop_cols_list <span class="op">=</span> [<span class="st">'Year'</span>]</span>
<span id="cb14-353"><a href="#cb14-353" aria-hidden="true" tabindex="-1"></a>                <span class="cf">if</span> entry <span class="op">==</span> <span class="st">"wthr"</span>:</span>
<span id="cb14-354"><a href="#cb14-354" aria-hidden="true" tabindex="-1"></a>                    rename_cols_dict.update({</span>
<span id="cb14-355"><a href="#cb14-355" aria-hidden="true" tabindex="-1"></a>                        <span class="st">'Day_[Local]'</span>: <span class="st">'Day'</span>, </span>
<span id="cb14-356"><a href="#cb14-356" aria-hidden="true" tabindex="-1"></a>                        <span class="st">'Month_[Local]'</span>: <span class="st">'Month'</span>, </span>
<span id="cb14-357"><a href="#cb14-357" aria-hidden="true" tabindex="-1"></a>                        <span class="st">'Year_[Local]'</span>: <span class="st">'Year'</span>, </span>
<span id="cb14-358"><a href="#cb14-358" aria-hidden="true" tabindex="-1"></a>                        <span class="st">'Day_of_year_[Local]'</span>: <span class="st">'DOY'</span>, </span>
<span id="cb14-359"><a href="#cb14-359" aria-hidden="true" tabindex="-1"></a>                        <span class="st">'Time_[Local]'</span>: <span class="st">'Time'</span></span>
<span id="cb14-360"><a href="#cb14-360" aria-hidden="true" tabindex="-1"></a>                    })</span>
<span id="cb14-361"><a href="#cb14-361" aria-hidden="true" tabindex="-1"></a>                    drop_cols_list <span class="op">=</span> [<span class="st">'Record_number'</span>, <span class="st">'Datetime_[UTC]'</span>]</span>
<span id="cb14-362"><a href="#cb14-362" aria-hidden="true" tabindex="-1"></a>                <span class="cf">if</span> entry <span class="op">==</span> <span class="st">"soil"</span>:</span>
<span id="cb14-363"><a href="#cb14-363" aria-hidden="true" tabindex="-1"></a>                    rename_cols_dict.update({</span>
<span id="cb14-364"><a href="#cb14-364" aria-hidden="true" tabindex="-1"></a>                    })</span>
<span id="cb14-365"><a href="#cb14-365" aria-hidden="true" tabindex="-1"></a>                <span class="cf">if</span> entry <span class="op">==</span> <span class="st">"mgmt"</span>:</span>
<span id="cb14-366"><a href="#cb14-366" aria-hidden="true" tabindex="-1"></a>                    rename_cols_dict.update({</span>
<span id="cb14-367"><a href="#cb14-367" aria-hidden="true" tabindex="-1"></a>                    })</span>
<span id="cb14-368"><a href="#cb14-368" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-369"><a href="#cb14-369" aria-hidden="true" tabindex="-1"></a>                <span class="bu">getattr</span>(<span class="va">self</span>,  entry).data <span class="op">=</span> <span class="bu">getattr</span>(<span class="va">self</span>,  entry).data.rename(columns <span class="op">=</span> rename_cols_dict)</span>
<span id="cb14-370"><a href="#cb14-370" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-371"><a href="#cb14-371" aria-hidden="true" tabindex="-1"></a>                <span class="cf">if</span> drop_cols_list <span class="op">!=</span> []:</span>
<span id="cb14-372"><a href="#cb14-372" aria-hidden="true" tabindex="-1"></a>                    <span class="bu">getattr</span>(<span class="va">self</span>,  entry).data <span class="op">=</span> <span class="bu">getattr</span>(<span class="va">self</span>,  entry).data.drop(drop_cols_list, axis<span class="op">=</span><span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="co"># dat_2021.meta.data.columns.sort_values()</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="co"># dat_2015.meta.data.head()</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a>prlst2dct([])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>{
}</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="co"># dat_2021.meta.data.columns.sort_values()</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="co"># dat_2016.phno.data.head()</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Initialize all released datasets ----</span></span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a>dat_2021 <span class="op">=</span> g2f_2021(</span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true" tabindex="-1"></a>    meta_path <span class="op">=</span> <span class="st">'./data/raw/GenomesToFields_G2F_data_2021/z._2021_supplemental_info/g2f_2021_field_metadata.csv'</span>, </span>
<span id="cb21-4"><a href="#cb21-4" aria-hidden="true" tabindex="-1"></a>    phno_path <span class="op">=</span> <span class="st">'./data/raw/GenomesToFields_G2F_data_2021/a._2021_phenotypic_data/g2f_2021_phenotypic_clean_data.csv'</span>, <span class="co"># also contains 'g2f_2021_phenotypic_raw_data.csv' </span></span>
<span id="cb21-5"><a href="#cb21-5" aria-hidden="true" tabindex="-1"></a>    geno_path <span class="op">=</span> <span class="va">None</span>,  </span>
<span id="cb21-6"><a href="#cb21-6" aria-hidden="true" tabindex="-1"></a>    wthr_path <span class="op">=</span> <span class="st">'./data/raw/GenomesToFields_G2F_data_2021/b._2021_weather_data/g2f_2021_weather_cleaned.csv'</span>,</span>
<span id="cb21-7"><a href="#cb21-7" aria-hidden="true" tabindex="-1"></a>    soil_path <span class="op">=</span> <span class="st">'./data/raw/GenomesToFields_G2F_data_2021/c._2021_soil_data/g2f_2021_soil_data.csv'</span>,</span>
<span id="cb21-8"><a href="#cb21-8" aria-hidden="true" tabindex="-1"></a>    mgmt_path <span class="op">=</span> <span class="st">'./data/raw/GenomesToFields_G2F_data_2021/z._2021_supplemental_info/g2f_2021_agronomic_information.csv'</span>,</span>
<span id="cb21-9"><a href="#cb21-9" aria-hidden="true" tabindex="-1"></a>    year <span class="op">=</span> <span class="dv">2021</span></span>
<span id="cb21-10"><a href="#cb21-10" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb21-11"><a href="#cb21-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-12"><a href="#cb21-12" aria-hidden="true" tabindex="-1"></a>dat_2020 <span class="op">=</span> g2f_2020(</span>
<span id="cb21-13"><a href="#cb21-13" aria-hidden="true" tabindex="-1"></a>    meta_path <span class="op">=</span> <span class="st">'./data/raw/GenomesToFields_G2F_data_2020/z._2020_supplemental_info/g2f_2020_field_metadata.csv'</span>, </span>
<span id="cb21-14"><a href="#cb21-14" aria-hidden="true" tabindex="-1"></a>    phno_path <span class="op">=</span> <span class="st">'./data/raw/GenomesToFields_G2F_data_2020/a._2020_phenotypic_data/g2f_2020_phenotypic_clean_data.csv'</span>, <span class="co"># also contains 'g2f_2020_phenotypic_raw_data.csv' </span></span>
<span id="cb21-15"><a href="#cb21-15" aria-hidden="true" tabindex="-1"></a>    geno_path <span class="op">=</span> <span class="va">None</span>,  </span>
<span id="cb21-16"><a href="#cb21-16" aria-hidden="true" tabindex="-1"></a>    wthr_path <span class="op">=</span> <span class="st">'./data/raw/GenomesToFields_G2F_data_2020/b._2020_weather_data/2020_weather_cleaned.csv'</span>,</span>
<span id="cb21-17"><a href="#cb21-17" aria-hidden="true" tabindex="-1"></a>    soil_path <span class="op">=</span> <span class="st">'./data/raw/GenomesToFields_G2F_data_2020/c._2020_soil_data/g2f_2020_soil_data.csv'</span>,</span>
<span id="cb21-18"><a href="#cb21-18" aria-hidden="true" tabindex="-1"></a>    mgmt_path <span class="op">=</span> <span class="st">'./data/raw/GenomesToFields_G2F_data_2020/z._2020_supplemental_info/g2f_2020_agronomic_information.csv'</span>,</span>
<span id="cb21-19"><a href="#cb21-19" aria-hidden="true" tabindex="-1"></a>    year <span class="op">=</span> <span class="dv">2020</span></span>
<span id="cb21-20"><a href="#cb21-20" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb21-21"><a href="#cb21-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-22"><a href="#cb21-22" aria-hidden="true" tabindex="-1"></a>dat_2019 <span class="op">=</span> g2f_2019(</span>
<span id="cb21-23"><a href="#cb21-23" aria-hidden="true" tabindex="-1"></a>    meta_path <span class="op">=</span> <span class="st">'./data/raw/GenomesToFields_data_2019/z._2019_supplemental_info/g2f_2019_field_metadata.csv'</span>, </span>
<span id="cb21-24"><a href="#cb21-24" aria-hidden="true" tabindex="-1"></a>    phno_path <span class="op">=</span> <span class="st">'./data/raw/GenomesToFields_data_2019/a._2019_phenotypic_data/g2f_2019_phenotypic_clean_data.csv'</span>, </span>
<span id="cb21-25"><a href="#cb21-25" aria-hidden="true" tabindex="-1"></a>    geno_path <span class="op">=</span> <span class="va">None</span>,  </span>
<span id="cb21-26"><a href="#cb21-26" aria-hidden="true" tabindex="-1"></a>    wthr_path <span class="op">=</span> <span class="st">'./data/raw/GenomesToFields_data_2019/b._2019_weather_data/2019_weather_cleaned.csv'</span>,</span>
<span id="cb21-27"><a href="#cb21-27" aria-hidden="true" tabindex="-1"></a>    soil_path <span class="op">=</span> <span class="st">'./data/raw/GenomesToFields_data_2019/c._2019_soil_data/g2f_2019_soil_data.csv'</span>,</span>
<span id="cb21-28"><a href="#cb21-28" aria-hidden="true" tabindex="-1"></a>    mgmt_path <span class="op">=</span> <span class="st">'./data/raw/GenomesToFields_data_2019/z._2019_supplemental_info/g2f_2019_agronomic_information.csv'</span>,</span>
<span id="cb21-29"><a href="#cb21-29" aria-hidden="true" tabindex="-1"></a>    year <span class="op">=</span> <span class="dv">2019</span></span>
<span id="cb21-30"><a href="#cb21-30" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb21-31"><a href="#cb21-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-32"><a href="#cb21-32" aria-hidden="true" tabindex="-1"></a>dat_2018 <span class="op">=</span> g2f_2018(</span>
<span id="cb21-33"><a href="#cb21-33" aria-hidden="true" tabindex="-1"></a>    meta_path <span class="op">=</span> <span class="st">'./data/raw/GenomesToFields_G2F_Data_2018/e._2018_supplemental_info/g2f_2018_field_metadata.csv'</span>, </span>
<span id="cb21-34"><a href="#cb21-34" aria-hidden="true" tabindex="-1"></a>    phno_path <span class="op">=</span> <span class="st">'./data/raw/GenomesToFields_G2F_Data_2018/a._2018_hybrid_phenotypic_data/g2f_2018_hybrid_data_clean.csv'</span>, </span>
<span id="cb21-35"><a href="#cb21-35" aria-hidden="true" tabindex="-1"></a>    geno_path <span class="op">=</span> <span class="va">None</span>,  </span>
<span id="cb21-36"><a href="#cb21-36" aria-hidden="true" tabindex="-1"></a>    wthr_path <span class="op">=</span> <span class="st">'./data/raw/GenomesToFields_G2F_Data_2018/b._2018_weather_data/g2f_2018_weather_clean.csv'</span>,</span>
<span id="cb21-37"><a href="#cb21-37" aria-hidden="true" tabindex="-1"></a>    soil_path <span class="op">=</span> <span class="st">'./data/raw/GenomesToFields_G2F_Data_2018/c._2018_soil_data/g2f_2018_soil_data.csv'</span>,</span>
<span id="cb21-38"><a href="#cb21-38" aria-hidden="true" tabindex="-1"></a>    mgmt_path <span class="op">=</span> <span class="st">'./data/raw/GenomesToFields_G2F_Data_2018/e._2018_supplemental_info/g2f_2018_agronomic information.csv'</span>,</span>
<span id="cb21-39"><a href="#cb21-39" aria-hidden="true" tabindex="-1"></a>    year <span class="op">=</span> <span class="dv">2018</span></span>
<span id="cb21-40"><a href="#cb21-40" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb21-41"><a href="#cb21-41" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-42"><a href="#cb21-42" aria-hidden="true" tabindex="-1"></a>dat_2017 <span class="op">=</span> g2f_2017(</span>
<span id="cb21-43"><a href="#cb21-43" aria-hidden="true" tabindex="-1"></a>    meta_path <span class="op">=</span> <span class="st">'./data/raw/G2F_Planting_Season_2017_v1/z._2017_supplemental_info/g2f_2017_field_metadata.csv'</span>, </span>
<span id="cb21-44"><a href="#cb21-44" aria-hidden="true" tabindex="-1"></a>    phno_path <span class="op">=</span> <span class="st">'./data/raw/G2F_Planting_Season_2017_v1/a._2017_hybrid_phenotypic_data/g2f_2017_hybrid_data_clean.csv'</span>, </span>
<span id="cb21-45"><a href="#cb21-45" aria-hidden="true" tabindex="-1"></a>    geno_path <span class="op">=</span> <span class="va">None</span>,  </span>
<span id="cb21-46"><a href="#cb21-46" aria-hidden="true" tabindex="-1"></a>    wthr_path <span class="op">=</span> <span class="st">'./data/raw/G2F_Planting_Season_2017_v1/b._2017_weather_data/g2f_2017_weather_data.csv'</span>,</span>
<span id="cb21-47"><a href="#cb21-47" aria-hidden="true" tabindex="-1"></a>    soil_path <span class="op">=</span> <span class="st">'./data/raw/G2F_Planting_Season_2017_v1/c._2017_soil_data/g2f_2017_soil_data_clean.csv'</span>,</span>
<span id="cb21-48"><a href="#cb21-48" aria-hidden="true" tabindex="-1"></a>    mgmt_path <span class="op">=</span> <span class="st">'./data/raw/G2F_Planting_Season_2017_v1/z._2017_supplemental_info/g2f_2017_agronomic information.csv'</span>,</span>
<span id="cb21-49"><a href="#cb21-49" aria-hidden="true" tabindex="-1"></a>    year <span class="op">=</span> <span class="dv">2017</span></span>
<span id="cb21-50"><a href="#cb21-50" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb21-51"><a href="#cb21-51" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-52"><a href="#cb21-52" aria-hidden="true" tabindex="-1"></a>dat_2016 <span class="op">=</span> g2f_2016(</span>
<span id="cb21-53"><a href="#cb21-53" aria-hidden="true" tabindex="-1"></a>    meta_path <span class="op">=</span> <span class="st">'./data/raw/G2F_Planting_Season_2016_v2/z._2016_supplemental_info/g2f_2016_field_metadata.csv'</span>, </span>
<span id="cb21-54"><a href="#cb21-54" aria-hidden="true" tabindex="-1"></a>    phno_path <span class="op">=</span> <span class="st">'./data/raw/G2F_Planting_Season_2016_v2/a._2016_hybrid_phenotypic_data/g2f_2016_hybrid_data_clean.csv'</span>, </span>
<span id="cb21-55"><a href="#cb21-55" aria-hidden="true" tabindex="-1"></a>    geno_path <span class="op">=</span> <span class="va">None</span>,  </span>
<span id="cb21-56"><a href="#cb21-56" aria-hidden="true" tabindex="-1"></a>    wthr_path <span class="op">=</span> <span class="st">'./data/raw/G2F_Planting_Season_2016_v2/b._2016_weather_data/g2f_2016_weather_data.csv'</span>,</span>
<span id="cb21-57"><a href="#cb21-57" aria-hidden="true" tabindex="-1"></a>    soil_path <span class="op">=</span> <span class="st">'./data/raw/G2F_Planting_Season_2016_v2/c._2016_soil_data/g2f_2016_soil_data_clean.csv'</span>,</span>
<span id="cb21-58"><a href="#cb21-58" aria-hidden="true" tabindex="-1"></a>    mgmt_path <span class="op">=</span> <span class="st">'./data/raw/G2F_Planting_Season_2016_v2/z._2016_supplemental_info/g2f_2016_agronomic_information.csv'</span>,</span>
<span id="cb21-59"><a href="#cb21-59" aria-hidden="true" tabindex="-1"></a>    year <span class="op">=</span> <span class="dv">2016</span></span>
<span id="cb21-60"><a href="#cb21-60" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb21-61"><a href="#cb21-61" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-62"><a href="#cb21-62" aria-hidden="true" tabindex="-1"></a>dat_2015 <span class="op">=</span> g2f_2015(</span>
<span id="cb21-63"><a href="#cb21-63" aria-hidden="true" tabindex="-1"></a>              <span class="co"># print('Note! Many management factors are recorded in 2015!')</span></span>
<span id="cb21-64"><a href="#cb21-64" aria-hidden="true" tabindex="-1"></a>    meta_path <span class="op">=</span> <span class="st">'./data/raw/G2F_Planting_Season_2015_v2/z._2015_supplemental_info/g2f_2015_field_metadata.csv'</span>, </span>
<span id="cb21-65"><a href="#cb21-65" aria-hidden="true" tabindex="-1"></a>    phno_path <span class="op">=</span> <span class="st">'./data/raw/G2F_Planting_Season_2015_v2/a._2015_hybrid_phenotypic_data/g2f_2015_hybrid_data_clean.csv'</span>, </span>
<span id="cb21-66"><a href="#cb21-66" aria-hidden="true" tabindex="-1"></a>    geno_path <span class="op">=</span> <span class="va">None</span>,  </span>
<span id="cb21-67"><a href="#cb21-67" aria-hidden="true" tabindex="-1"></a>    wthr_path <span class="op">=</span> <span class="st">'./data/raw/G2F_Planting_Season_2015_v2/b._2015_weather_data/g2f_2015_weather.csv'</span>,</span>
<span id="cb21-68"><a href="#cb21-68" aria-hidden="true" tabindex="-1"></a>    soil_path <span class="op">=</span> <span class="st">'./data/raw/G2F_Planting_Season_2015_v2/d._2015_soil_data/g2f_2015_soil_data.csv'</span>,</span>
<span id="cb21-69"><a href="#cb21-69" aria-hidden="true" tabindex="-1"></a>              <span class="co"># There is data to be had but it's not formatted in a machine friendly way.</span></span>
<span id="cb21-70"><a href="#cb21-70" aria-hidden="true" tabindex="-1"></a>              <span class="co"># I've reformatted it to be easy to read in.</span></span>
<span id="cb21-71"><a href="#cb21-71" aria-hidden="true" tabindex="-1"></a>    mgmt_path <span class="op">=</span> <span class="st">'./data/Manual_old/g2f_2015_agronomic information.csv'</span>,</span>
<span id="cb21-72"><a href="#cb21-72" aria-hidden="true" tabindex="-1"></a>    year <span class="op">=</span> <span class="dv">2015</span></span>
<span id="cb21-73"><a href="#cb21-73" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb21-74"><a href="#cb21-74" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-75"><a href="#cb21-75" aria-hidden="true" tabindex="-1"></a>dat_2014 <span class="op">=</span> g2f_2014(</span>
<span id="cb21-76"><a href="#cb21-76" aria-hidden="true" tabindex="-1"></a>    meta_path <span class="op">=</span> <span class="st">'./data/raw/G2F_Planting_Season_2014_v4/z._2014_supplemental_info/g2f_2014_field_characteristics.csv'</span>, </span>
<span id="cb21-77"><a href="#cb21-77" aria-hidden="true" tabindex="-1"></a>    phno_path <span class="op">=</span> <span class="st">'./data/raw/G2F_Planting_Season_2014_v4/a._2014_hybrid_phenotypic_data/g2f_2014_hybrid_data_clean.csv'</span>, </span>
<span id="cb21-78"><a href="#cb21-78" aria-hidden="true" tabindex="-1"></a>    geno_path <span class="op">=</span> <span class="va">None</span>,  </span>
<span id="cb21-79"><a href="#cb21-79" aria-hidden="true" tabindex="-1"></a>    wthr_path <span class="op">=</span> <span class="st">'./data/raw/G2F_Planting_Season_2014_v4/b._2014_weather_data/g2f_2014_weather.csv'</span>,</span>
<span id="cb21-80"><a href="#cb21-80" aria-hidden="true" tabindex="-1"></a>              <span class="co"># no soil 2014, some info in metadata</span></span>
<span id="cb21-81"><a href="#cb21-81" aria-hidden="true" tabindex="-1"></a>    soil_path <span class="op">=</span> <span class="va">None</span>, </span>
<span id="cb21-82"><a href="#cb21-82" aria-hidden="true" tabindex="-1"></a>              <span class="co"># no agro 2014, some info in metadata</span></span>
<span id="cb21-83"><a href="#cb21-83" aria-hidden="true" tabindex="-1"></a>    mgmt_path <span class="op">=</span> <span class="va">None</span>,</span>
<span id="cb21-84"><a href="#cb21-84" aria-hidden="true" tabindex="-1"></a>    year <span class="op">=</span> <span class="dv">2014</span></span>
<span id="cb21-85"><a href="#cb21-85" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb21-86"><a href="#cb21-86" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-87"><a href="#cb21-87" aria-hidden="true" tabindex="-1"></a><span class="co"># # Placeholder for GENETICS data ----</span></span>
<span id="cb21-88"><a href="#cb21-88" aria-hidden="true" tabindex="-1"></a><span class="co"># import re</span></span>
<span id="cb21-89"><a href="#cb21-89" aria-hidden="true" tabindex="-1"></a><span class="co"># newDecoderNames={</span></span>
<span id="cb21-90"><a href="#cb21-90" aria-hidden="true" tabindex="-1"></a><span class="co">#          'Sample Names': 'Sample',</span></span>
<span id="cb21-91"><a href="#cb21-91" aria-hidden="true" tabindex="-1"></a><span class="co"># 'Inbred Genotype Names': 'InbredGenotype',</span></span>
<span id="cb21-92"><a href="#cb21-92" aria-hidden="true" tabindex="-1"></a><span class="co">#                'Family': 'Family'</span></span>
<span id="cb21-93"><a href="#cb21-93" aria-hidden="true" tabindex="-1"></a><span class="co"># }</span></span>
<span id="cb21-94"><a href="#cb21-94" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-95"><a href="#cb21-95" aria-hidden="true" tabindex="-1"></a><span class="co"># geno2018= pd.read_table(</span></span>
<span id="cb21-96"><a href="#cb21-96" aria-hidden="true" tabindex="-1"></a><span class="co">#     data_adapter_path+'../data/raw/GenomesToFields_G2F_Data_2018/d._2018_genotypic_data/G2F_PHG_minreads1_Mo44_PHW65_MoG_assemblies_14112019_filtered_plusParents_sampleDecoder.txt',</span></span>
<span id="cb21-97"><a href="#cb21-97" aria-hidden="true" tabindex="-1"></a><span class="co">#     delimiter= ' ', </span></span>
<span id="cb21-98"><a href="#cb21-98" aria-hidden="true" tabindex="-1"></a><span class="co">#     header=None, </span></span>
<span id="cb21-99"><a href="#cb21-99" aria-hidden="true" tabindex="-1"></a><span class="co">#     names= ['Sample Names', 'Inbred Genotype Names'])#.sort_values('Inbred Genotype Names')</span></span>
<span id="cb21-100"><a href="#cb21-100" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-101"><a href="#cb21-101" aria-hidden="true" tabindex="-1"></a><span class="co"># # Add to enable join to phenotype data</span></span>
<span id="cb21-102"><a href="#cb21-102" aria-hidden="true" tabindex="-1"></a><span class="co"># def clip_2018_family(i):</span></span>
<span id="cb21-103"><a href="#cb21-103" aria-hidden="true" tabindex="-1"></a><span class="co">#     # for i in range(geno2018.shape[0]):</span></span>
<span id="cb21-104"><a href="#cb21-104" aria-hidden="true" tabindex="-1"></a><span class="co">#     if(re.search('_', geno2018['Inbred Genotype Names'][i]) == None):</span></span>
<span id="cb21-105"><a href="#cb21-105" aria-hidden="true" tabindex="-1"></a><span class="co">#         newName = str(geno2018['Inbred Genotype Names'].str.split("_")[i][0])</span></span>
<span id="cb21-106"><a href="#cb21-106" aria-hidden="true" tabindex="-1"></a><span class="co">#     else:</span></span>
<span id="cb21-107"><a href="#cb21-107" aria-hidden="true" tabindex="-1"></a><span class="co">#         newName = str(geno2018['Inbred Genotype Names'].str.split("_")[i][0:1][0]</span></span>
<span id="cb21-108"><a href="#cb21-108" aria-hidden="true" tabindex="-1"></a><span class="co">#                      )+'_'+str(geno2018['Inbred Genotype Names'].str.split("_")[i][1:2][0])</span></span>
<span id="cb21-109"><a href="#cb21-109" aria-hidden="true" tabindex="-1"></a><span class="co">#     return(newName)</span></span>
<span id="cb21-110"><a href="#cb21-110" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb21-111"><a href="#cb21-111" aria-hidden="true" tabindex="-1"></a><span class="co"># geno2018['Family'] = [clip_2018_family(i) for i in range(len(geno2018[['Inbred Genotype Names']]))]</span></span>
<span id="cb21-112"><a href="#cb21-112" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-113"><a href="#cb21-113" aria-hidden="true" tabindex="-1"></a><span class="co"># # Data is in AGP format saved as a h5</span></span>
<span id="cb21-114"><a href="#cb21-114" aria-hidden="true" tabindex="-1"></a><span class="co"># geno2017= pd.read_excel(data_adapter_path+'../data/raw/G2F_Planting_Season_2017_v1/d._2017_genotypic_data/g2f_2017_gbs_hybrid_codes.xlsx')</span></span>
<span id="cb21-115"><a href="#cb21-115" aria-hidden="true" tabindex="-1"></a><span class="co"># geno2017['Year']= '2017'</span></span>
<span id="cb21-116"><a href="#cb21-116" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-117"><a href="#cb21-117" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-118"><a href="#cb21-118" aria-hidden="true" tabindex="-1"></a><span class="co"># </span><span class="al">TODO</span></span>
<span id="cb21-119"><a href="#cb21-119" aria-hidden="true" tabindex="-1"></a><span class="co"># dat_sets = [dat_2014, dat_2015, dat_2016, dat_2017, dat_2018, dat_2019, dat_2021]</span></span>
<span id="cb21-120"><a href="#cb21-120" aria-hidden="true" tabindex="-1"></a><span class="co"># for e in dat_sets:</span></span>
<span id="cb21-121"><a href="#cb21-121" aria-hidden="true" tabindex="-1"></a><span class="co">#     e.ready_csvs()</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>the big thing to check is that each table has the key columns below. With those we should be able to access each value and can turn to stardardization of terms. The key columns for the data are</p>
<table class="table">
<thead>
<tr class="header">
<th>meta</th>
<th>phno</th>
<th>geno</th>
<th>wthr</th>
<th>soil</th>
<th>mgmt</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Year</td>
<td>Year</td>
<td></td>
<td>Year</td>
<td>Year</td>
<td>Year</td>
</tr>
<tr class="even">
<td>Location</td>
<td>Location</td>
<td></td>
<td>Location</td>
<td>Location</td>
<td>Location</td>
</tr>
<tr class="odd">
<td></td>
<td>Pedigree</td>
<td></td>
<td></td>
<td></td>
<td></td>
</tr>
<tr class="even">
<td></td>
<td>Replication</td>
<td></td>
<td></td>
<td></td>
<td></td>
</tr>
<tr class="odd">
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td>Month</td>
</tr>
<tr class="even">
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td>Day</td>
</tr>
<tr class="odd">
<td></td>
<td></td>
<td></td>
<td>Date_Time</td>
<td></td>
<td></td>
</tr>
<tr class="even">
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td>Application</td>
</tr>
<tr class="odd">
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td>Product</td>
</tr>
</tbody>
</table>
</section>
<section id="prep-year-by-year" class="level1">
<h1>Prep year by year</h1>
<div class="cell">
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 2021</span></span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a>dat_2021.ready_csvs()</span>
<span id="cb22-3"><a href="#cb22-3" aria-hidden="true" tabindex="-1"></a>dat_2021.transform_all_names()</span>
<span id="cb22-4"><a href="#cb22-4" aria-hidden="true" tabindex="-1"></a>dat_2021.transform_all_names_check()</span>
<span id="cb22-5"><a href="#cb22-5" aria-hidden="true" tabindex="-1"></a>dat_2021.add_year_col_to_all()</span>
<span id="cb22-6"><a href="#cb22-6" aria-hidden="true" tabindex="-1"></a>dat_2021.rename_all_id_cols()</span>
<span id="cb22-7"><a href="#cb22-7" aria-hidden="true" tabindex="-1"></a>dat_2021.check_for_id_cols()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>geno is not initialized and None type.
geno is not initialized and None type.
meta ids renamed.
phno ids renamed.
geno is not initialized and None type.
wthr ids renamed.
soil ids renamed.
mgmt ids renamed.
geno is not initialized and None type.</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 2020</span></span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a>dat_2020.ready_csvs()</span>
<span id="cb24-3"><a href="#cb24-3" aria-hidden="true" tabindex="-1"></a>dat_2020.transform_all_names()</span>
<span id="cb24-4"><a href="#cb24-4" aria-hidden="true" tabindex="-1"></a>dat_2020.transform_all_names_check()</span>
<span id="cb24-5"><a href="#cb24-5" aria-hidden="true" tabindex="-1"></a>dat_2020.add_year_col_to_all()</span>
<span id="cb24-6"><a href="#cb24-6" aria-hidden="true" tabindex="-1"></a>dat_2020.rename_all_id_cols()</span>
<span id="cb24-7"><a href="#cb24-7" aria-hidden="true" tabindex="-1"></a>dat_2020.check_for_id_cols()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>geno is not initialized and None type.
geno is not initialized and None type.
meta ids renamed.
phno ids renamed.
geno is not initialized and None type.
wthr ids renamed.
soil ids renamed.
mgmt ids renamed.
geno is not initialized and None type.</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 2019</span></span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a>dat_2019.ready_csvs()</span>
<span id="cb26-3"><a href="#cb26-3" aria-hidden="true" tabindex="-1"></a>dat_2019.transform_all_names()</span>
<span id="cb26-4"><a href="#cb26-4" aria-hidden="true" tabindex="-1"></a>dat_2019.standardize_all_transformed_names()</span>
<span id="cb26-5"><a href="#cb26-5" aria-hidden="true" tabindex="-1"></a>dat_2019.transform_all_names_check()</span>
<span id="cb26-6"><a href="#cb26-6" aria-hidden="true" tabindex="-1"></a>dat_2019.add_year_col_to_all()</span>
<span id="cb26-7"><a href="#cb26-7" aria-hidden="true" tabindex="-1"></a>dat_2019.rename_all_id_cols()</span>
<span id="cb26-8"><a href="#cb26-8" aria-hidden="true" tabindex="-1"></a>dat_2019.check_for_id_cols()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>geno is not initialized and None type.
geno is not initialized and None type.
meta ids renamed.
phno ids renamed.
geno is not initialized and None type.
wthr ids renamed.
soil ids renamed.
mgmt ids renamed.
geno is not initialized and None type.</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a>dat_2018.ready_csvs()</span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a>dat_2018.transform_all_names()</span>
<span id="cb28-3"><a href="#cb28-3" aria-hidden="true" tabindex="-1"></a>dat_2018.standardize_all_transformed_names()</span>
<span id="cb28-4"><a href="#cb28-4" aria-hidden="true" tabindex="-1"></a>dat_2018.transform_all_names_check()</span>
<span id="cb28-5"><a href="#cb28-5" aria-hidden="true" tabindex="-1"></a>dat_2018.add_year_col_to_all()</span>
<span id="cb28-6"><a href="#cb28-6" aria-hidden="true" tabindex="-1"></a>dat_2018.rename_all_id_cols()</span>
<span id="cb28-7"><a href="#cb28-7" aria-hidden="true" tabindex="-1"></a>dat_2018.check_for_id_cols()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>geno is not initialized and None type.
geno is not initialized and None type.
meta ids renamed.
phno ids renamed.
geno is not initialized and None type.
wthr ids renamed.
soil ids renamed.
mgmt ids renamed.
geno is not initialized and None type.
wthr
Missing id columns: "Date_Time"</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a>dat_2017.ready_csvs()</span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a>dat_2017.transform_all_names()</span>
<span id="cb30-3"><a href="#cb30-3" aria-hidden="true" tabindex="-1"></a>dat_2017.standardize_all_transformed_names()</span>
<span id="cb30-4"><a href="#cb30-4" aria-hidden="true" tabindex="-1"></a>dat_2017.transform_all_names_check()</span>
<span id="cb30-5"><a href="#cb30-5" aria-hidden="true" tabindex="-1"></a>dat_2017.add_year_col_to_all()</span>
<span id="cb30-6"><a href="#cb30-6" aria-hidden="true" tabindex="-1"></a>dat_2017.rename_all_id_cols()</span>
<span id="cb30-7"><a href="#cb30-7" aria-hidden="true" tabindex="-1"></a>dat_2017.check_for_id_cols()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>geno is not initialized and None type.
geno is not initialized and None type.
meta ids renamed.
phno ids renamed.
geno is not initialized and None type.
wthr ids renamed.
soil ids renamed.
mgmt ids renamed.
geno is not initialized and None type.
wthr
Missing id columns: "Date_Time"</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a>dat_2016.ready_csvs()</span>
<span id="cb32-2"><a href="#cb32-2" aria-hidden="true" tabindex="-1"></a>dat_2016.transform_all_names()</span>
<span id="cb32-3"><a href="#cb32-3" aria-hidden="true" tabindex="-1"></a>dat_2016.standardize_all_transformed_names()</span>
<span id="cb32-4"><a href="#cb32-4" aria-hidden="true" tabindex="-1"></a>dat_2016.transform_all_names_check()</span>
<span id="cb32-5"><a href="#cb32-5" aria-hidden="true" tabindex="-1"></a>dat_2016.add_year_col_to_all()</span>
<span id="cb32-6"><a href="#cb32-6" aria-hidden="true" tabindex="-1"></a>dat_2016.rename_all_id_cols()</span>
<span id="cb32-7"><a href="#cb32-7" aria-hidden="true" tabindex="-1"></a>dat_2016.check_for_id_cols()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>geno is not initialized and None type.
geno is not initialized and None type.
meta ids renamed.
phno ids renamed.
geno is not initialized and None type.
wthr ids renamed.
soil ids renamed.
mgmt ids renamed.
geno is not initialized and None type.
wthr
Missing id columns: "Date_Time"
mgmt
Missing id columns: "Product"</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a>dat_2015.ready_csvs()</span>
<span id="cb34-2"><a href="#cb34-2" aria-hidden="true" tabindex="-1"></a>dat_2015.transform_all_names()</span>
<span id="cb34-3"><a href="#cb34-3" aria-hidden="true" tabindex="-1"></a>dat_2015.standardize_all_transformed_names()</span>
<span id="cb34-4"><a href="#cb34-4" aria-hidden="true" tabindex="-1"></a>dat_2015.transform_all_names_check()</span>
<span id="cb34-5"><a href="#cb34-5" aria-hidden="true" tabindex="-1"></a>dat_2015.add_year_col_to_all()</span>
<span id="cb34-6"><a href="#cb34-6" aria-hidden="true" tabindex="-1"></a>dat_2015.rename_all_id_cols()</span>
<span id="cb34-7"><a href="#cb34-7" aria-hidden="true" tabindex="-1"></a>dat_2015.check_for_id_cols()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>geno is not initialized and None type.
geno is not initialized and None type.
meta ids renamed.
phno ids renamed.
geno is not initialized and None type.
wthr ids renamed.
soil ids renamed.
mgmt ids renamed.
geno is not initialized and None type.
wthr
Missing id columns: "Location", "Date_Time"</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a>dat_2014.ready_csvs()</span>
<span id="cb36-2"><a href="#cb36-2" aria-hidden="true" tabindex="-1"></a>dat_2014.transform_all_names()</span>
<span id="cb36-3"><a href="#cb36-3" aria-hidden="true" tabindex="-1"></a>dat_2014.standardize_all_transformed_names()</span>
<span id="cb36-4"><a href="#cb36-4" aria-hidden="true" tabindex="-1"></a>dat_2014.transform_all_names_check()</span>
<span id="cb36-5"><a href="#cb36-5" aria-hidden="true" tabindex="-1"></a>dat_2014.add_year_col_to_all()</span>
<span id="cb36-6"><a href="#cb36-6" aria-hidden="true" tabindex="-1"></a>dat_2014.rename_all_id_cols()</span>
<span id="cb36-7"><a href="#cb36-7" aria-hidden="true" tabindex="-1"></a>dat_2014.check_for_id_cols()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>soil is not initialized and None type.
mgmt is not initialized and None type.
geno is not initialized and None type.
soil is not initialized and None type.
mgmt is not initialized and None type.
geno is not initialized and None type.
soil is not initialized and None type.
mgmt is not initialized and None type.
meta ids renamed.
phno ids renamed.
geno is not initialized and None type.
wthr ids renamed.
soil is not initialized and None type.
mgmt is not initialized and None type.
geno is not initialized and None type.
wthr
Missing id columns: "Date_Time"
soil is not initialized and None type.
mgmt is not initialized and None type.</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb38"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a><span class="co"># updating workflow</span></span>
<span id="cb38-2"><a href="#cb38-2" aria-hidden="true" tabindex="-1"></a><span class="co"># run to find unexpect columns (e.g. 'CO2_[ppm]') and if they are names with the correct convention</span></span>
<span id="cb38-3"><a href="#cb38-3" aria-hidden="true" tabindex="-1"></a><span class="co"># add them into the columns in transform_all_names_check()</span></span>
<span id="cb38-4"><a href="#cb38-4" aria-hidden="true" tabindex="-1"></a><span class="co"># if they are instead _NOT_ in the standardized pattern add </span></span>
<span id="cb38-5"><a href="#cb38-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Rerun to confirm it's okay</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb39"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a><span class="co"># The goal here is to define column names and contents that </span></span>
<span id="cb39-2"><a href="#cb39-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-3"><a href="#cb39-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-4"><a href="#cb39-4" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> check_contract(dataframe, contract, enforce <span class="op">=</span> <span class="va">False</span>):</span>
<span id="cb39-5"><a href="#cb39-5" aria-hidden="true" tabindex="-1"></a>    <span class="co">"""</span></span>
<span id="cb39-6"><a href="#cb39-6" aria-hidden="true" tabindex="-1"></a><span class="co">    This function will check a dataframe for agreement with a contract.</span></span>
<span id="cb39-7"><a href="#cb39-7" aria-hidden="true" tabindex="-1"></a><span class="co">    To pass it must contain all the columns specified and they must be of the right data type</span></span>
<span id="cb39-8"><a href="#cb39-8" aria-hidden="true" tabindex="-1"></a><span class="co">    If `enforce = True` then a dataframe containing only the columns in the contract will be returned (if it passed)</span></span>
<span id="cb39-9"><a href="#cb39-9" aria-hidden="true" tabindex="-1"></a><span class="co">    """</span></span>
<span id="cb39-10"><a href="#cb39-10" aria-hidden="true" tabindex="-1"></a>    contract_passed <span class="op">=</span> <span class="va">True</span></span>
<span id="cb39-11"><a href="#cb39-11" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb39-12"><a href="#cb39-12" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Get information on contract</span></span>
<span id="cb39-13"><a href="#cb39-13" aria-hidden="true" tabindex="-1"></a>    contract_df <span class="op">=</span>  pd.DataFrame(</span>
<span id="cb39-14"><a href="#cb39-14" aria-hidden="true" tabindex="-1"></a>        <span class="bu">zip</span>(contract.keys(), </span>
<span id="cb39-15"><a href="#cb39-15" aria-hidden="true" tabindex="-1"></a>            [<span class="va">True</span> <span class="cf">if</span> e <span class="kw">in</span> dataframe.columns <span class="cf">else</span> <span class="va">False</span> <span class="cf">for</span> e <span class="kw">in</span> contract.keys()],</span>
<span id="cb39-16"><a href="#cb39-16" aria-hidden="true" tabindex="-1"></a>            contract.values()           </span>
<span id="cb39-17"><a href="#cb39-17" aria-hidden="true" tabindex="-1"></a>           ), </span>
<span id="cb39-18"><a href="#cb39-18" aria-hidden="true" tabindex="-1"></a>        columns<span class="op">=</span> [<span class="st">"Contract"</span>, </span>
<span id="cb39-19"><a href="#cb39-19" aria-hidden="true" tabindex="-1"></a>                  <span class="st">"DataFrame"</span>,</span>
<span id="cb39-20"><a href="#cb39-20" aria-hidden="true" tabindex="-1"></a>                  <span class="st">"dtype"</span>])</span>
<span id="cb39-21"><a href="#cb39-21" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Check contract compliance</span></span>
<span id="cb39-22"><a href="#cb39-22" aria-hidden="true" tabindex="-1"></a>    contract_df.loc[:, <span class="st">"ColType"</span>] <span class="op">=</span> <span class="st">""</span></span>
<span id="cb39-23"><a href="#cb39-23" aria-hidden="true" tabindex="-1"></a>    contract_df.loc[:, <span class="st">"dtypeMatch"</span>] <span class="op">=</span> <span class="va">False</span></span>
<span id="cb39-24"><a href="#cb39-24" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb39-25"><a href="#cb39-25" aria-hidden="true" tabindex="-1"></a>    <span class="co"># This is an inefficient way to do this but it should be okay for this purpose</span></span>
<span id="cb39-26"><a href="#cb39-26" aria-hidden="true" tabindex="-1"></a>    check_cols <span class="op">=</span> contract_df.loc[contract_df.DataFrame, <span class="st">'Contract'</span>]</span>
<span id="cb39-27"><a href="#cb39-27" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> check <span class="kw">in</span> check_cols:</span>
<span id="cb39-28"><a href="#cb39-28" aria-hidden="true" tabindex="-1"></a>        val <span class="op">=</span> dataframe.loc[:, check].dtype</span>
<span id="cb39-29"><a href="#cb39-29" aria-hidden="true" tabindex="-1"></a>        contract_df.loc[contract_df.Contract <span class="op">==</span> check, <span class="st">'ColType'</span>] <span class="op">=</span> val</span>
<span id="cb39-30"><a href="#cb39-30" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb39-31"><a href="#cb39-31" aria-hidden="true" tabindex="-1"></a>    contract_df.loc[contract_df.dtype <span class="op">==</span> contract_df.ColType, <span class="st">"dtypeMatch"</span>] <span class="op">=</span> <span class="va">True</span></span>
<span id="cb39-32"><a href="#cb39-32" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb39-33"><a href="#cb39-33" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Calculate contract compliance stats</span></span>
<span id="cb39-34"><a href="#cb39-34" aria-hidden="true" tabindex="-1"></a>    passing_percent <span class="op">=</span> <span class="bu">float</span>(<span class="bu">sum</span>(contract_df.dtypeMatch)<span class="op">/</span>(contract_df.shape[<span class="dv">0</span>]))</span>
<span id="cb39-35"><a href="#cb39-35" aria-hidden="true" tabindex="-1"></a>    passing_status <span class="op">=</span> (passing_percent <span class="op">==</span> <span class="fl">1.0</span>)</span>
<span id="cb39-36"><a href="#cb39-36" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb39-37"><a href="#cb39-37" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> passing_status:</span>
<span id="cb39-38"><a href="#cb39-38" aria-hidden="true" tabindex="-1"></a>        contract_passed <span class="op">=</span> <span class="va">True</span></span>
<span id="cb39-39"><a href="#cb39-39" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="st">"Passed contract comparison"</span>)</span>
<span id="cb39-40"><a href="#cb39-40" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="kw">not</span> contract_passed:</span>
<span id="cb39-41"><a href="#cb39-41" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span>(contract_df)</span>
<span id="cb39-42"><a href="#cb39-42" aria-hidden="true" tabindex="-1"></a>        <span class="cf">else</span>:</span>
<span id="cb39-43"><a href="#cb39-43" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> <span class="kw">not</span> enforce:</span>
<span id="cb39-44"><a href="#cb39-44" aria-hidden="true" tabindex="-1"></a>                <span class="bu">print</span>(<span class="st">"Return dataframe with contract enforced by passing `enforce = True`"</span>)</span>
<span id="cb39-45"><a href="#cb39-45" aria-hidden="true" tabindex="-1"></a>            <span class="cf">else</span>:</span>
<span id="cb39-46"><a href="#cb39-46" aria-hidden="true" tabindex="-1"></a>                <span class="cf">return</span>(dataframe.loc[:, <span class="bu">list</span>(contract.keys())])</span>
<span id="cb39-47"><a href="#cb39-47" aria-hidden="true" tabindex="-1"></a>    <span class="cf">else</span>:</span>
<span id="cb39-48"><a href="#cb39-48" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="bu">str</span>(<span class="bu">sum</span>(contract_df.DataFrame))<span class="op">+</span><span class="st">"/"</span><span class="op">+</span><span class="bu">str</span>(contract_df.shape[<span class="dv">0</span>])<span class="op">+</span><span class="st">" Columns match."</span>)</span>
<span id="cb39-49"><a href="#cb39-49" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="bu">str</span>(<span class="bu">sum</span>(contract_df.dtypeMatch))<span class="op">+</span><span class="st">"/"</span><span class="op">+</span><span class="bu">str</span>(contract_df.shape[<span class="dv">0</span>])<span class="op">+</span><span class="st">" Types match."</span>) </span>
<span id="cb39-50"><a href="#cb39-50" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span>(contract_df)</span>
<span id="cb39-51"><a href="#cb39-51" aria-hidden="true" tabindex="-1"></a>    <span class="co">#TODO allow for enforcing contract</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb40"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a><span class="co"># # The first contract to check is easy.</span></span>
<span id="cb40-2"><a href="#cb40-2" aria-hidden="true" tabindex="-1"></a><span class="co"># # 1. Do the data types and columns in each of 2021's data objects match themselves?</span></span>
<span id="cb40-3"><a href="#cb40-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-4"><a href="#cb40-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-5"><a href="#cb40-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-6"><a href="#cb40-6" aria-hidden="true" tabindex="-1"></a><span class="co"># meta = dat_2021.meta.data</span></span>
<span id="cb40-7"><a href="#cb40-7" aria-hidden="true" tabindex="-1"></a><span class="co"># phno = dat_2021.phno.data</span></span>
<span id="cb40-8"><a href="#cb40-8" aria-hidden="true" tabindex="-1"></a><span class="co"># wthr = dat_2021.wthr.data</span></span>
<span id="cb40-9"><a href="#cb40-9" aria-hidden="true" tabindex="-1"></a><span class="co"># soil = dat_2021.soil.data</span></span>
<span id="cb40-10"><a href="#cb40-10" aria-hidden="true" tabindex="-1"></a><span class="co"># mgmt = dat_2021.mgmt.data</span></span>
<span id="cb40-11"><a href="#cb40-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-12"><a href="#cb40-12" aria-hidden="true" tabindex="-1"></a><span class="co"># # check_contract(dataframe = mgmt, contract = mgmt_contract, enforce = False)</span></span>
<span id="cb40-13"><a href="#cb40-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-14"><a href="#cb40-14" aria-hidden="true" tabindex="-1"></a><span class="co"># # 1. are there the right columns?</span></span>
<span id="cb40-15"><a href="#cb40-15" aria-hidden="true" tabindex="-1"></a><span class="co"># # [list(mgmt.columns)]</span></span>
<span id="cb40-16"><a href="#cb40-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-17"><a href="#cb40-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-18"><a href="#cb40-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-19"><a href="#cb40-19" aria-hidden="true" tabindex="-1"></a><span class="co"># # meta.Location = meta.Location.astype("string")</span></span>
<span id="cb40-20"><a href="#cb40-20" aria-hidden="true" tabindex="-1"></a><span class="co"># # # meta.Date = meta.Date.astype("datetime64[ns]")</span></span>
<span id="cb40-21"><a href="#cb40-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-22"><a href="#cb40-22" aria-hidden="true" tabindex="-1"></a><span class="co"># # print(list(phno.columns))</span></span>
<span id="cb40-23"><a href="#cb40-23" aria-hidden="true" tabindex="-1"></a><span class="co"># # meta.info()</span></span>
<span id="cb40-24"><a href="#cb40-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-25"><a href="#cb40-25" aria-hidden="true" tabindex="-1"></a><span class="co"># # methead.head()</span></span>
<span id="cb40-26"><a href="#cb40-26" aria-hidden="true" tabindex="-1"></a><span class="co"># # # meta.Date.astype('datetime64[ns]')</span></span>
<span id="cb40-27"><a href="#cb40-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-28"><a href="#cb40-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-29"><a href="#cb40-29" aria-hidden="true" tabindex="-1"></a><span class="co"># # # nans = pd.to_numeric(s, errors="coerce").isna()</span></span>
<span id="cb40-30"><a href="#cb40-30" aria-hidden="true" tabindex="-1"></a><span class="co"># # fail_dates = pd.to_datetime(mgmt.Date, errors='coerce').isna()</span></span>
<span id="cb40-31"><a href="#cb40-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-32"><a href="#cb40-32" aria-hidden="true" tabindex="-1"></a><span class="co"># # # set(meta.loc[fail_dates, "Date"])</span></span>
<span id="cb40-33"><a href="#cb40-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-34"><a href="#cb40-34" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-35"><a href="#cb40-35" aria-hidden="true" tabindex="-1"></a><span class="co"># # mgmt.loc[:, 'ImputationNotes'] = ''</span></span>
<span id="cb40-36"><a href="#cb40-36" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-37"><a href="#cb40-37" aria-hidden="true" tabindex="-1"></a><span class="co"># # '6/24/21 for all but plots in pass 2; 7/5/21 for pass 2',</span></span>
<span id="cb40-38"><a href="#cb40-38" aria-hidden="true" tabindex="-1"></a><span class="co"># #  'Before Planting',</span></span>
<span id="cb40-39"><a href="#cb40-39" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-40"><a href="#cb40-40" aria-hidden="true" tabindex="-1"></a><span class="co"># # 'Local_check_#1_pedigree', 'Local_check_#1_source', 'Local_check_#2_pedigree', 'Local_check_#2_source', 'Local_check_#3_pedigree', 'Local_check_#3_source', 'Local_check_#4_pedigree', 'Local_check_#4_source', 'Local_check_#5_pedigree', 'Local_check_#5_source', </span></span>
<span id="cb40-41"><a href="#cb40-41" aria-hidden="true" tabindex="-1"></a><span class="co"># # 'Issue/comment_#1', 'Issue/comment_#2', 'Issue/comment_#3', 'Issue/comment_#4', 'Issue/comment_#5', 'Issue/comment_#6', 'Issue/comment_#7', 'Issue/comment_#8', 'Issue/comment_#9', 'Issue/comment_#10',</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb41"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a><span class="co"># meta_contract = {</span></span>
<span id="cb41-2"><a href="#cb41-2" aria-hidden="true" tabindex="-1"></a><span class="co">#                                                   'Year': 'int',</span></span>
<span id="cb41-3"><a href="#cb41-3" aria-hidden="true" tabindex="-1"></a><span class="co">#                                               'Location': 'string',  </span></span>
<span id="cb41-4"><a href="#cb41-4" aria-hidden="true" tabindex="-1"></a><span class="co">#                                                   'City': 'string',</span></span>
<span id="cb41-5"><a href="#cb41-5" aria-hidden="true" tabindex="-1"></a><span class="co">#                                                   'Farm': 'string',</span></span>
<span id="cb41-6"><a href="#cb41-6" aria-hidden="true" tabindex="-1"></a><span class="co">#                                                  'Field': 'string',</span></span>
<span id="cb41-7"><a href="#cb41-7" aria-hidden="true" tabindex="-1"></a><span class="co">#                                              'Treatment': 'string',</span></span>
<span id="cb41-8"><a href="#cb41-8" aria-hidden="true" tabindex="-1"></a><span class="co">#                                                         #</span></span>
<span id="cb41-9"><a href="#cb41-9" aria-hidden="true" tabindex="-1"></a><span class="co">#                                          'Previous_crop': 'string',</span></span>
<span id="cb41-10"><a href="#cb41-10" aria-hidden="true" tabindex="-1"></a><span class="co">#                            'Pre-plant_tillage_method(s)': 'string',</span></span>
<span id="cb41-11"><a href="#cb41-11" aria-hidden="true" tabindex="-1"></a><span class="co">#                            'In-season_tillage_method(s)': 'string',</span></span>
<span id="cb41-12"><a href="#cb41-12" aria-hidden="true" tabindex="-1"></a><span class="co">#     'Plot_length_(center-alley_to_center-alley_in_feet)': 'string',</span></span>
<span id="cb41-13"><a href="#cb41-13" aria-hidden="true" tabindex="-1"></a><span class="co">#                               'Alley_length_(in_inches)': 'string',</span></span>
<span id="cb41-14"><a href="#cb41-14" aria-hidden="true" tabindex="-1"></a><span class="co">#                                'Row_spacing_(in_inches)': 'string',</span></span>
<span id="cb41-15"><a href="#cb41-15" aria-hidden="true" tabindex="-1"></a><span class="co">#  'Type_of_planter_(fluted_cone;_belt_cone;_air_planter)': 'string',</span></span>
<span id="cb41-16"><a href="#cb41-16" aria-hidden="true" tabindex="-1"></a><span class="co"># 'Number_kernels_planted_per_plot_(&gt;200_seed/pack_for_cone_planters)': 'string',</span></span>
<span id="cb41-17"><a href="#cb41-17" aria-hidden="true" tabindex="-1"></a><span class="co">#                            'System_determining_moisture': 'string',</span></span>
<span id="cb41-18"><a href="#cb41-18" aria-hidden="true" tabindex="-1"></a><span class="co">#                            'Pounds_needed_soil_moisture': 'string',</span></span>
<span id="cb41-19"><a href="#cb41-19" aria-hidden="true" tabindex="-1"></a><span class="co">#                                                         #</span></span>
<span id="cb41-20"><a href="#cb41-20" aria-hidden="true" tabindex="-1"></a><span class="co">#               'Latitude_of_field_corner_#1_(lower_left)': 'string',</span></span>
<span id="cb41-21"><a href="#cb41-21" aria-hidden="true" tabindex="-1"></a><span class="co">#              'Longitude_of_field_corner_#1_(lower_left)': 'string',</span></span>
<span id="cb41-22"><a href="#cb41-22" aria-hidden="true" tabindex="-1"></a><span class="co">#              'Latitude_of_field_corner_#2_(lower_right)': 'string',</span></span>
<span id="cb41-23"><a href="#cb41-23" aria-hidden="true" tabindex="-1"></a><span class="co">#             'Longitude_of_field_corner_#2_(lower_right)': 'string',</span></span>
<span id="cb41-24"><a href="#cb41-24" aria-hidden="true" tabindex="-1"></a><span class="co">#              'Latitude_of_field_corner_#3_(upper_right)': 'string',</span></span>
<span id="cb41-25"><a href="#cb41-25" aria-hidden="true" tabindex="-1"></a><span class="co">#             'Longitude_of_field_corner_#3_(upper_right)': 'string',</span></span>
<span id="cb41-26"><a href="#cb41-26" aria-hidden="true" tabindex="-1"></a><span class="co">#               'Latitude_of_field_corner_#4_(upper_left)': 'string',</span></span>
<span id="cb41-27"><a href="#cb41-27" aria-hidden="true" tabindex="-1"></a><span class="co">#              'Longitude_of_field_corner_#4_(upper_left)': 'string',</span></span>
<span id="cb41-28"><a href="#cb41-28" aria-hidden="true" tabindex="-1"></a><span class="co">#                                                         #</span></span>
<span id="cb41-29"><a href="#cb41-29" aria-hidden="true" tabindex="-1"></a><span class="co">#                                'Cardinal_heading_pass_1': 'string',</span></span>
<span id="cb41-30"><a href="#cb41-30" aria-hidden="true" tabindex="-1"></a><span class="co">#                                                         #</span></span>
<span id="cb41-31"><a href="#cb41-31" aria-hidden="true" tabindex="-1"></a><span class="co">#                                          'Local_check_#': 'int',</span></span>
<span id="cb41-32"><a href="#cb41-32" aria-hidden="true" tabindex="-1"></a><span class="co">#                                   'Local_check_pedigree': 'string',</span></span>
<span id="cb41-33"><a href="#cb41-33" aria-hidden="true" tabindex="-1"></a><span class="co">#                                     'Local_check_source': 'string',    </span></span>
<span id="cb41-34"><a href="#cb41-34" aria-hidden="true" tabindex="-1"></a><span class="co">#                                        'Issue/comment_#': 'int',</span></span>
<span id="cb41-35"><a href="#cb41-35" aria-hidden="true" tabindex="-1"></a><span class="co">#                                          'Issue/comment': 'string',</span></span>
<span id="cb41-36"><a href="#cb41-36" aria-hidden="true" tabindex="-1"></a><span class="co">#                                                         #    </span></span>
<span id="cb41-37"><a href="#cb41-37" aria-hidden="true" tabindex="-1"></a><span class="co"># 'Trial_ID_(Assigned_by_collaborator_for_internal_reference)': 'string',</span></span>
<span id="cb41-38"><a href="#cb41-38" aria-hidden="true" tabindex="-1"></a><span class="co">#        'Soil_taxonomic_ID_and_horizon_description,_if_known': 'string',</span></span>
<span id="cb41-39"><a href="#cb41-39" aria-hidden="true" tabindex="-1"></a><span class="co"># 'Weather_station_serial_number_(Last_four_digits,_e.g._m2700s#####)': 'string',</span></span>
<span id="cb41-40"><a href="#cb41-40" aria-hidden="true" tabindex="-1"></a><span class="co">#      'Weather_station_latitude_(in_decimal_numbers_nOT_dMS)': 'string',</span></span>
<span id="cb41-41"><a href="#cb41-41" aria-hidden="true" tabindex="-1"></a><span class="co">#     'Weather_station_longitude_(in_decimal_numbers_nOT_dMS)': 'string',</span></span>
<span id="cb41-42"><a href="#cb41-42" aria-hidden="true" tabindex="-1"></a><span class="co">#                                                         #   </span></span>
<span id="cb41-43"><a href="#cb41-43" aria-hidden="true" tabindex="-1"></a><span class="co">#                            'Date_weather_station_placed': 'datetime64[ns]',</span></span>
<span id="cb41-44"><a href="#cb41-44" aria-hidden="true" tabindex="-1"></a><span class="co">#                           'Date_weather_station_removed': 'datetime64[ns]',</span></span>
<span id="cb41-45"><a href="#cb41-45" aria-hidden="true" tabindex="-1"></a><span class="co">#                 'In-field_weather_station_serial_number': 'string',</span></span>
<span id="cb41-46"><a href="#cb41-46" aria-hidden="true" tabindex="-1"></a><span class="co">#         'In-field_weather_station_latitude_(in_decimal)': 'string',</span></span>
<span id="cb41-47"><a href="#cb41-47" aria-hidden="true" tabindex="-1"></a><span class="co">#        'In-field_weather_station_longitude_(in_decimal)': 'string',</span></span>
<span id="cb41-48"><a href="#cb41-48" aria-hidden="true" tabindex="-1"></a><span class="co">#                                                         #   </span></span>
<span id="cb41-49"><a href="#cb41-49" aria-hidden="true" tabindex="-1"></a><span class="co">#                                       'Imputation_notes': 'string'</span></span>
<span id="cb41-50"><a href="#cb41-50" aria-hidden="true" tabindex="-1"></a><span class="co"># }</span></span>
<span id="cb41-51"><a href="#cb41-51" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-52"><a href="#cb41-52" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-53"><a href="#cb41-53" aria-hidden="true" tabindex="-1"></a><span class="co"># # meta remove local checks and issues</span></span>
<span id="cb41-54"><a href="#cb41-54" aria-hidden="true" tabindex="-1"></a><span class="co"># cols_checks_and_issues_list = [</span></span>
<span id="cb41-55"><a href="#cb41-55" aria-hidden="true" tabindex="-1"></a><span class="co">#     'Local_check_#1_pedigree', 'Local_check_#1_source',</span></span>
<span id="cb41-56"><a href="#cb41-56" aria-hidden="true" tabindex="-1"></a><span class="co">#     'Local_check_#2_pedigree', 'Local_check_#2_source',</span></span>
<span id="cb41-57"><a href="#cb41-57" aria-hidden="true" tabindex="-1"></a><span class="co">#     'Local_check_#3_pedigree', 'Local_check_#3_source',</span></span>
<span id="cb41-58"><a href="#cb41-58" aria-hidden="true" tabindex="-1"></a><span class="co">#     'Local_check_#4_pedigree', 'Local_check_#4_source',</span></span>
<span id="cb41-59"><a href="#cb41-59" aria-hidden="true" tabindex="-1"></a><span class="co">#     'Local_check_#5_pedigree', 'Local_check_#5_source', </span></span>
<span id="cb41-60"><a href="#cb41-60" aria-hidden="true" tabindex="-1"></a><span class="co">#     'Issue/comment_#1', 'Issue/comment_#2', 'Issue/comment_#3', 'Issue/comment_#4', 'Issue/comment_#5',</span></span>
<span id="cb41-61"><a href="#cb41-61" aria-hidden="true" tabindex="-1"></a><span class="co">#     'Issue/comment_#6', 'Issue/comment_#7', 'Issue/comment_#8', 'Issue/comment_#9', 'Issue/comment_#10']</span></span>
<span id="cb41-62"><a href="#cb41-62" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-63"><a href="#cb41-63" aria-hidden="true" tabindex="-1"></a><span class="co"># temp = meta.loc[:, ['Location'] + cols_checks_and_issues_list ]</span></span>
<span id="cb41-64"><a href="#cb41-64" aria-hidden="true" tabindex="-1"></a><span class="co"># # check_contract(dataframe = meta, contract = meta_contract)</span></span>
<span id="cb41-65"><a href="#cb41-65" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-66"><a href="#cb41-66" aria-hidden="true" tabindex="-1"></a><span class="co"># temp1 = pd.melt(</span></span>
<span id="cb41-67"><a href="#cb41-67" aria-hidden="true" tabindex="-1"></a><span class="co">#     temp, </span></span>
<span id="cb41-68"><a href="#cb41-68" aria-hidden="true" tabindex="-1"></a><span class="co">#     id_vars=['Location'], </span></span>
<span id="cb41-69"><a href="#cb41-69" aria-hidden="true" tabindex="-1"></a><span class="co">#     value_vars=[</span></span>
<span id="cb41-70"><a href="#cb41-70" aria-hidden="true" tabindex="-1"></a><span class="co">#         'Local_check_#1_source',</span></span>
<span id="cb41-71"><a href="#cb41-71" aria-hidden="true" tabindex="-1"></a><span class="co">#         'Local_check_#2_source',</span></span>
<span id="cb41-72"><a href="#cb41-72" aria-hidden="true" tabindex="-1"></a><span class="co">#         'Local_check_#3_source',</span></span>
<span id="cb41-73"><a href="#cb41-73" aria-hidden="true" tabindex="-1"></a><span class="co">#         'Local_check_#4_source',</span></span>
<span id="cb41-74"><a href="#cb41-74" aria-hidden="true" tabindex="-1"></a><span class="co">#         'Local_check_#5_source'], </span></span>
<span id="cb41-75"><a href="#cb41-75" aria-hidden="true" tabindex="-1"></a><span class="co">#     ignore_index=False</span></span>
<span id="cb41-76"><a href="#cb41-76" aria-hidden="true" tabindex="-1"></a><span class="co"># ).rename(columns={</span></span>
<span id="cb41-77"><a href="#cb41-77" aria-hidden="true" tabindex="-1"></a><span class="co">#     'variable': 'Local_check_#',</span></span>
<span id="cb41-78"><a href="#cb41-78" aria-hidden="true" tabindex="-1"></a><span class="co">#     'value': 'Local_check_source'})</span></span>
<span id="cb41-79"><a href="#cb41-79" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-80"><a href="#cb41-80" aria-hidden="true" tabindex="-1"></a><span class="co"># temp2 = pd.melt(</span></span>
<span id="cb41-81"><a href="#cb41-81" aria-hidden="true" tabindex="-1"></a><span class="co">#     temp, </span></span>
<span id="cb41-82"><a href="#cb41-82" aria-hidden="true" tabindex="-1"></a><span class="co">#     id_vars=['Location'], </span></span>
<span id="cb41-83"><a href="#cb41-83" aria-hidden="true" tabindex="-1"></a><span class="co">#     value_vars=[</span></span>
<span id="cb41-84"><a href="#cb41-84" aria-hidden="true" tabindex="-1"></a><span class="co">#         'Local_check_#1_pedigree', </span></span>
<span id="cb41-85"><a href="#cb41-85" aria-hidden="true" tabindex="-1"></a><span class="co">#         'Local_check_#2_pedigree', </span></span>
<span id="cb41-86"><a href="#cb41-86" aria-hidden="true" tabindex="-1"></a><span class="co">#         'Local_check_#3_pedigree', </span></span>
<span id="cb41-87"><a href="#cb41-87" aria-hidden="true" tabindex="-1"></a><span class="co">#         'Local_check_#4_pedigree', </span></span>
<span id="cb41-88"><a href="#cb41-88" aria-hidden="true" tabindex="-1"></a><span class="co">#         'Local_check_#5_pedigree'], </span></span>
<span id="cb41-89"><a href="#cb41-89" aria-hidden="true" tabindex="-1"></a><span class="co">#     ignore_index=False</span></span>
<span id="cb41-90"><a href="#cb41-90" aria-hidden="true" tabindex="-1"></a><span class="co"># ).rename(columns={</span></span>
<span id="cb41-91"><a href="#cb41-91" aria-hidden="true" tabindex="-1"></a><span class="co">#     'variable': 'Local_check_#',</span></span>
<span id="cb41-92"><a href="#cb41-92" aria-hidden="true" tabindex="-1"></a><span class="co">#     'value': 'Local_check_pedigree'})</span></span>
<span id="cb41-93"><a href="#cb41-93" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-94"><a href="#cb41-94" aria-hidden="true" tabindex="-1"></a><span class="co"># temp3 = pd.melt(</span></span>
<span id="cb41-95"><a href="#cb41-95" aria-hidden="true" tabindex="-1"></a><span class="co">#     temp, </span></span>
<span id="cb41-96"><a href="#cb41-96" aria-hidden="true" tabindex="-1"></a><span class="co">#     id_vars=['Location'], </span></span>
<span id="cb41-97"><a href="#cb41-97" aria-hidden="true" tabindex="-1"></a><span class="co">#     value_vars=[</span></span>
<span id="cb41-98"><a href="#cb41-98" aria-hidden="true" tabindex="-1"></a><span class="co">#         'Issue/comment_#1', </span></span>
<span id="cb41-99"><a href="#cb41-99" aria-hidden="true" tabindex="-1"></a><span class="co">#         'Issue/comment_#2', </span></span>
<span id="cb41-100"><a href="#cb41-100" aria-hidden="true" tabindex="-1"></a><span class="co">#         'Issue/comment_#3', </span></span>
<span id="cb41-101"><a href="#cb41-101" aria-hidden="true" tabindex="-1"></a><span class="co">#         'Issue/comment_#4', </span></span>
<span id="cb41-102"><a href="#cb41-102" aria-hidden="true" tabindex="-1"></a><span class="co">#         'Issue/comment_#5', </span></span>
<span id="cb41-103"><a href="#cb41-103" aria-hidden="true" tabindex="-1"></a><span class="co">#         'Issue/comment_#6', </span></span>
<span id="cb41-104"><a href="#cb41-104" aria-hidden="true" tabindex="-1"></a><span class="co">#         'Issue/comment_#7', </span></span>
<span id="cb41-105"><a href="#cb41-105" aria-hidden="true" tabindex="-1"></a><span class="co">#         'Issue/comment_#8', </span></span>
<span id="cb41-106"><a href="#cb41-106" aria-hidden="true" tabindex="-1"></a><span class="co">#         'Issue/comment_#9', </span></span>
<span id="cb41-107"><a href="#cb41-107" aria-hidden="true" tabindex="-1"></a><span class="co">#         'Issue/comment_#10'], </span></span>
<span id="cb41-108"><a href="#cb41-108" aria-hidden="true" tabindex="-1"></a><span class="co">#     ignore_index=False</span></span>
<span id="cb41-109"><a href="#cb41-109" aria-hidden="true" tabindex="-1"></a><span class="co"># ).rename(columns={</span></span>
<span id="cb41-110"><a href="#cb41-110" aria-hidden="true" tabindex="-1"></a><span class="co">#     'variable': 'Issue/comment_#',</span></span>
<span id="cb41-111"><a href="#cb41-111" aria-hidden="true" tabindex="-1"></a><span class="co">#     'value': 'Issue/comment'})</span></span>
<span id="cb41-112"><a href="#cb41-112" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-113"><a href="#cb41-113" aria-hidden="true" tabindex="-1"></a><span class="co"># temp1.loc[:, 'Local_check_#'] = [re.findall('#[0-9]+', e)[0].replace('#', '') for e in list(temp1.loc[:, 'Local_check_#'])]</span></span>
<span id="cb41-114"><a href="#cb41-114" aria-hidden="true" tabindex="-1"></a><span class="co"># temp2.loc[:, 'Local_check_#'] = [re.findall('#[0-9]+', e)[0].replace('#', '') for e in list(temp2.loc[:, 'Local_check_#'])]</span></span>
<span id="cb41-115"><a href="#cb41-115" aria-hidden="true" tabindex="-1"></a><span class="co"># temp3.loc[:, 'Issue/comment_#'] = [re.findall('#[0-9]+', e)[0].replace('#', '') for e in list(temp3.loc[:, 'Issue/comment_#'])]</span></span>
<span id="cb41-116"><a href="#cb41-116" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-117"><a href="#cb41-117" aria-hidden="true" tabindex="-1"></a><span class="co"># temp_check = temp1.merge(temp2, how = 'outer')</span></span>
<span id="cb41-118"><a href="#cb41-118" aria-hidden="true" tabindex="-1"></a><span class="co"># mask = (temp_check.Local_check_source.isna() &amp; temp_check.Local_check_pedigree.isna())</span></span>
<span id="cb41-119"><a href="#cb41-119" aria-hidden="true" tabindex="-1"></a><span class="co"># temp_check = temp_check.loc[~mask, :]</span></span>
<span id="cb41-120"><a href="#cb41-120" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-121"><a href="#cb41-121" aria-hidden="true" tabindex="-1"></a><span class="co"># temp_issue = temp3.loc[temp3['Issue/comment'].notna(), :]</span></span>
<span id="cb41-122"><a href="#cb41-122" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-123"><a href="#cb41-123" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-124"><a href="#cb41-124" aria-hidden="true" tabindex="-1"></a><span class="co"># # drop cols in cols_checks_and_issues_list and merge in long </span></span>
<span id="cb41-125"><a href="#cb41-125" aria-hidden="true" tabindex="-1"></a><span class="co"># meta = meta.drop(columns=cols_checks_and_issues_list).merge(temp_check, how = 'outer').merge(temp_issue, how = 'outer')</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb42"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a><span class="co"># pd.to_timedelta()</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb43"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true" tabindex="-1"></a><span class="co"># for key in meta_contract.keys():</span></span>
<span id="cb43-2"><a href="#cb43-2" aria-hidden="true" tabindex="-1"></a><span class="co">#     print(key, meta_contract[key])</span></span>
<span id="cb43-3"><a href="#cb43-3" aria-hidden="true" tabindex="-1"></a><span class="co"># #     'datetime64[ns]'</span></span>
<span id="cb43-4"><a href="#cb43-4" aria-hidden="true" tabindex="-1"></a><span class="co"># #     pd.to_numeric(meta.loc[:, key], errors="coerce").isna()</span></span>
<span id="cb43-5"><a href="#cb43-5" aria-hidden="true" tabindex="-1"></a><span class="co">#     meta.loc[:, key]  #astype(meta_contract[key], coerce = True)</span></span>
<span id="cb43-6"><a href="#cb43-6" aria-hidden="true" tabindex="-1"></a><span class="co"># #     meta.loc[:, key] = meta.loc[:, key].astype(meta_contract[key])</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb44"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a><span class="co"># check_contract(dataframe = meta, contract = meta_contract, enforce = False)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb45"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb45-1"><a href="#cb45-1" aria-hidden="true" tabindex="-1"></a><span class="co"># phno_contract = {</span></span>
<span id="cb45-2"><a href="#cb45-2" aria-hidden="true" tabindex="-1"></a><span class="co">#                               'Year': 'int',</span></span>
<span id="cb45-3"><a href="#cb45-3" aria-hidden="true" tabindex="-1"></a><span class="co">#                           'Location': 'string',</span></span>
<span id="cb45-4"><a href="#cb45-4" aria-hidden="true" tabindex="-1"></a><span class="co">#                                     #</span></span>
<span id="cb45-5"><a href="#cb45-5" aria-hidden="true" tabindex="-1"></a><span class="co">#                              'State': 'string',</span></span>
<span id="cb45-6"><a href="#cb45-6" aria-hidden="true" tabindex="-1"></a><span class="co">#                               'City': 'string',</span></span>
<span id="cb45-7"><a href="#cb45-7" aria-hidden="true" tabindex="-1"></a><span class="co">#                                     #</span></span>
<span id="cb45-8"><a href="#cb45-8" aria-hidden="true" tabindex="-1"></a><span class="co">#                         'Experiment': 'string',    </span></span>
<span id="cb45-9"><a href="#cb45-9" aria-hidden="true" tabindex="-1"></a><span class="co">#                                     #</span></span>
<span id="cb45-10"><a href="#cb45-10" aria-hidden="true" tabindex="-1"></a><span class="co"># 'Plot_length_(center-center_in_feet)': 'string',</span></span>
<span id="cb45-11"><a href="#cb45-11" aria-hidden="true" tabindex="-1"></a><span class="co">#                    'Plot_area_(ft2)': 'string',</span></span>
<span id="cb45-12"><a href="#cb45-12" aria-hidden="true" tabindex="-1"></a><span class="co">#           'Alley_length_(in_inches)': 'string',</span></span>
<span id="cb45-13"><a href="#cb45-13" aria-hidden="true" tabindex="-1"></a><span class="co">#            'Row_spacing_(in_inches)': 'string',</span></span>
<span id="cb45-14"><a href="#cb45-14" aria-hidden="true" tabindex="-1"></a><span class="co">#                      'Rows_per_plot': 'string',</span></span>
<span id="cb45-15"><a href="#cb45-15" aria-hidden="true" tabindex="-1"></a><span class="co">#                    '#_seed_per_plot': 'string',</span></span>
<span id="cb45-16"><a href="#cb45-16" aria-hidden="true" tabindex="-1"></a><span class="co">#                                     #</span></span>
<span id="cb45-17"><a href="#cb45-17" aria-hidden="true" tabindex="-1"></a><span class="co">#                             'Source': 'string',</span></span>
<span id="cb45-18"><a href="#cb45-18" aria-hidden="true" tabindex="-1"></a><span class="co">#                           'Pedigree': 'string',</span></span>
<span id="cb45-19"><a href="#cb45-19" aria-hidden="true" tabindex="-1"></a><span class="co">#                             'Family': 'string',</span></span>
<span id="cb45-20"><a href="#cb45-20" aria-hidden="true" tabindex="-1"></a><span class="co">#                             'Tester': 'string',</span></span>
<span id="cb45-21"><a href="#cb45-21" aria-hidden="true" tabindex="-1"></a><span class="co">#                                     #</span></span>
<span id="cb45-22"><a href="#cb45-22" aria-hidden="true" tabindex="-1"></a><span class="co">#                        'Replication': 'string',</span></span>
<span id="cb45-23"><a href="#cb45-23" aria-hidden="true" tabindex="-1"></a><span class="co">#                              'Block': 'string',</span></span>
<span id="cb45-24"><a href="#cb45-24" aria-hidden="true" tabindex="-1"></a><span class="co">#                               'Plot': 'string',</span></span>
<span id="cb45-25"><a href="#cb45-25" aria-hidden="true" tabindex="-1"></a><span class="co">#                            'Plot_ID': 'string',</span></span>
<span id="cb45-26"><a href="#cb45-26" aria-hidden="true" tabindex="-1"></a><span class="co">#                              'Range': 'string',</span></span>
<span id="cb45-27"><a href="#cb45-27" aria-hidden="true" tabindex="-1"></a><span class="co">#                               'Pass': 'string',</span></span>
<span id="cb45-28"><a href="#cb45-28" aria-hidden="true" tabindex="-1"></a><span class="co">#                                     #</span></span>
<span id="cb45-29"><a href="#cb45-29" aria-hidden="true" tabindex="-1"></a><span class="co">#       'Date_plot_planted_[MM/DD/YY]': 'datetime64[ns]',</span></span>
<span id="cb45-30"><a href="#cb45-30" aria-hidden="true" tabindex="-1"></a><span class="co">#     'Date_plot_harvested_[MM/DD/YY]': 'datetime64[ns]',</span></span>
<span id="cb45-31"><a href="#cb45-31" aria-hidden="true" tabindex="-1"></a><span class="co">#                'Anthesis_[MM/DD/YY]': 'datetime64[ns]',</span></span>
<span id="cb45-32"><a href="#cb45-32" aria-hidden="true" tabindex="-1"></a><span class="co">#                 'Silking_[MM/DD/YY]': 'datetime64[ns]',</span></span>
<span id="cb45-33"><a href="#cb45-33" aria-hidden="true" tabindex="-1"></a><span class="co">#                    'Anthesis_[days]': 'string',</span></span>
<span id="cb45-34"><a href="#cb45-34" aria-hidden="true" tabindex="-1"></a><span class="co">#                     'Silking_[days]': 'string',</span></span>
<span id="cb45-35"><a href="#cb45-35" aria-hidden="true" tabindex="-1"></a><span class="co">#                                     #</span></span>
<span id="cb45-36"><a href="#cb45-36" aria-hidden="true" tabindex="-1"></a><span class="co">#                  'Plant_height_[cm]': 'string',</span></span>
<span id="cb45-37"><a href="#cb45-37" aria-hidden="true" tabindex="-1"></a><span class="co">#                    'Ear_height_[cm]': 'string',</span></span>
<span id="cb45-38"><a href="#cb45-38" aria-hidden="true" tabindex="-1"></a><span class="co">#          'Stand_count_[#_of_plants]': 'string',</span></span>
<span id="cb45-39"><a href="#cb45-39" aria-hidden="true" tabindex="-1"></a><span class="co">#         'Root_lodging_[#_of_plants]': 'string',</span></span>
<span id="cb45-40"><a href="#cb45-40" aria-hidden="true" tabindex="-1"></a><span class="co">#        'Stalk_lodging_[#_of_plants]': 'string',</span></span>
<span id="cb45-41"><a href="#cb45-41" aria-hidden="true" tabindex="-1"></a><span class="co">#                                     #</span></span>
<span id="cb45-42"><a href="#cb45-42" aria-hidden="true" tabindex="-1"></a><span class="co">#                 'Grain_moisture_[%]': 'string',</span></span>
<span id="cb45-43"><a href="#cb45-43" aria-hidden="true" tabindex="-1"></a><span class="co">#                  'Test_weight_[lbs]': 'string',</span></span>
<span id="cb45-44"><a href="#cb45-44" aria-hidden="true" tabindex="-1"></a><span class="co">#                  'Plot_weight_[lbs]': 'string',</span></span>
<span id="cb45-45"><a href="#cb45-45" aria-hidden="true" tabindex="-1"></a><span class="co">#                 'Grain_yield_(bu/A)': 'string',</span></span>
<span id="cb45-46"><a href="#cb45-46" aria-hidden="true" tabindex="-1"></a><span class="co">#                                     #</span></span>
<span id="cb45-47"><a href="#cb45-47" aria-hidden="true" tabindex="-1"></a><span class="co">#     "Plot_discarded_[enter_'yes'_or_blank]": 'string',</span></span>
<span id="cb45-48"><a href="#cb45-48" aria-hidden="true" tabindex="-1"></a><span class="co">#                           'Comments': 'string',</span></span>
<span id="cb45-49"><a href="#cb45-49" aria-hidden="true" tabindex="-1"></a><span class="co">#                             'Filler': 'string',</span></span>
<span id="cb45-50"><a href="#cb45-50" aria-hidden="true" tabindex="-1"></a><span class="co">#                 'Snap_[#_of_plants]': 'string',</span></span>
<span id="cb45-51"><a href="#cb45-51" aria-hidden="true" tabindex="-1"></a><span class="co">#                                     #</span></span>
<span id="cb45-52"><a href="#cb45-52" aria-hidden="true" tabindex="-1"></a><span class="co">#                   'Imputation_notes': 'string'</span></span>
<span id="cb45-53"><a href="#cb45-53" aria-hidden="true" tabindex="-1"></a><span class="co">#     }</span></span>
<span id="cb45-54"><a href="#cb45-54" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-55"><a href="#cb45-55" aria-hidden="true" tabindex="-1"></a><span class="co"># wthr_contract = {</span></span>
<span id="cb45-56"><a href="#cb45-56" aria-hidden="true" tabindex="-1"></a><span class="co">#                         'Year': 'int',</span></span>
<span id="cb45-57"><a href="#cb45-57" aria-hidden="true" tabindex="-1"></a><span class="co">#                     'Location': 'string',</span></span>
<span id="cb45-58"><a href="#cb45-58" aria-hidden="true" tabindex="-1"></a><span class="co">#                               #</span></span>
<span id="cb45-59"><a href="#cb45-59" aria-hidden="true" tabindex="-1"></a><span class="co">#                   'Station_ID': 'string',</span></span>
<span id="cb45-60"><a href="#cb45-60" aria-hidden="true" tabindex="-1"></a><span class="co">#                  'NWS_network': 'string',</span></span>
<span id="cb45-61"><a href="#cb45-61" aria-hidden="true" tabindex="-1"></a><span class="co">#                  'NWS_station': 'string',</span></span>
<span id="cb45-62"><a href="#cb45-62" aria-hidden="true" tabindex="-1"></a><span class="co">#                    'Date_Time': 'datetime64[ns]',</span></span>
<span id="cb45-63"><a href="#cb45-63" aria-hidden="true" tabindex="-1"></a><span class="co">#                        'Month': 'string',</span></span>
<span id="cb45-64"><a href="#cb45-64" aria-hidden="true" tabindex="-1"></a><span class="co">#                          'Day': 'string',</span></span>
<span id="cb45-65"><a href="#cb45-65" aria-hidden="true" tabindex="-1"></a><span class="co">#                         'Time': 'string',</span></span>
<span id="cb45-66"><a href="#cb45-66" aria-hidden="true" tabindex="-1"></a><span class="co">#              'Temperature_[C]': 'string',</span></span>
<span id="cb45-67"><a href="#cb45-67" aria-hidden="true" tabindex="-1"></a><span class="co">#                'Dew_point_[C]': 'string',</span></span>
<span id="cb45-68"><a href="#cb45-68" aria-hidden="true" tabindex="-1"></a><span class="co">#        'Relative_humidity_[%]': 'string',</span></span>
<span id="cb45-69"><a href="#cb45-69" aria-hidden="true" tabindex="-1"></a><span class="co">#       'Solar_radiation_[W/m2]': 'string',</span></span>
<span id="cb45-70"><a href="#cb45-70" aria-hidden="true" tabindex="-1"></a><span class="co">#                'Rainfall_[mm]': 'string',</span></span>
<span id="cb45-71"><a href="#cb45-71" aria-hidden="true" tabindex="-1"></a><span class="co">#             'Wind_speed_[m/s]': 'string',</span></span>
<span id="cb45-72"><a href="#cb45-72" aria-hidden="true" tabindex="-1"></a><span class="co">#     'Wind_direction_[degrees]': 'string',</span></span>
<span id="cb45-73"><a href="#cb45-73" aria-hidden="true" tabindex="-1"></a><span class="co">#                               #</span></span>
<span id="cb45-74"><a href="#cb45-74" aria-hidden="true" tabindex="-1"></a><span class="co">#              'Wind_gust_[m/s]': 'string',</span></span>
<span id="cb45-75"><a href="#cb45-75" aria-hidden="true" tabindex="-1"></a><span class="co">#         'Soil_temperature_[C]': 'string',</span></span>
<span id="cb45-76"><a href="#cb45-76" aria-hidden="true" tabindex="-1"></a><span class="co">#         'Soil_moisture_[%VWC]': 'string',</span></span>
<span id="cb45-77"><a href="#cb45-77" aria-hidden="true" tabindex="-1"></a><span class="co">#              'Soil_eC_[mS/cm]': 'string',</span></span>
<span id="cb45-78"><a href="#cb45-78" aria-hidden="true" tabindex="-1"></a><span class="co">#            'UV_light_[uM/m2s]': 'string',</span></span>
<span id="cb45-79"><a href="#cb45-79" aria-hidden="true" tabindex="-1"></a><span class="co">#                 'PAR_[uM/m2s]': 'string',</span></span>
<span id="cb45-80"><a href="#cb45-80" aria-hidden="true" tabindex="-1"></a><span class="co">#                               #</span></span>
<span id="cb45-81"><a href="#cb45-81" aria-hidden="true" tabindex="-1"></a><span class="co">#             'Imputation_notes': 'string'</span></span>
<span id="cb45-82"><a href="#cb45-82" aria-hidden="true" tabindex="-1"></a><span class="co">#     }</span></span>
<span id="cb45-83"><a href="#cb45-83" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-84"><a href="#cb45-84" aria-hidden="true" tabindex="-1"></a><span class="co"># soil_contract = {</span></span>
<span id="cb45-85"><a href="#cb45-85" aria-hidden="true" tabindex="-1"></a><span class="co">#                           'Year': 'int',</span></span>
<span id="cb45-86"><a href="#cb45-86" aria-hidden="true" tabindex="-1"></a><span class="co">#                       'Location': 'string',</span></span>
<span id="cb45-87"><a href="#cb45-87" aria-hidden="true" tabindex="-1"></a><span class="co">#                                 #</span></span>
<span id="cb45-88"><a href="#cb45-88" aria-hidden="true" tabindex="-1"></a><span class="co">#                  'Date_received': 'string',</span></span>
<span id="cb45-89"><a href="#cb45-89" aria-hidden="true" tabindex="-1"></a><span class="co">#                  'Date_reported': 'string',</span></span>
<span id="cb45-90"><a href="#cb45-90" aria-hidden="true" tabindex="-1"></a><span class="co">#                                 #</span></span>
<span id="cb45-91"><a href="#cb45-91" aria-hidden="true" tabindex="-1"></a><span class="co">#                         'Grower': 'string',</span></span>
<span id="cb45-92"><a href="#cb45-92" aria-hidden="true" tabindex="-1"></a><span class="co">#                                 #</span></span>
<span id="cb45-93"><a href="#cb45-93" aria-hidden="true" tabindex="-1"></a><span class="co">#                        'E_depth': 'string',</span></span>
<span id="cb45-94"><a href="#cb45-94" aria-hidden="true" tabindex="-1"></a><span class="co">#                    '1:1_soil_pH': 'string',</span></span>
<span id="cb45-95"><a href="#cb45-95" aria-hidden="true" tabindex="-1"></a><span class="co">#                 'WDRF_buffer_pH': 'string',</span></span>
<span id="cb45-96"><a href="#cb45-96" aria-hidden="true" tabindex="-1"></a><span class="co">#            '1:1_S_salts_mmho/cm': 'string',</span></span>
<span id="cb45-97"><a href="#cb45-97" aria-hidden="true" tabindex="-1"></a><span class="co">#                     'Texture_no': 'string',</span></span>
<span id="cb45-98"><a href="#cb45-98" aria-hidden="true" tabindex="-1"></a><span class="co">#            'Organic_matter_LOI%': 'string',</span></span>
<span id="cb45-99"><a href="#cb45-99" aria-hidden="true" tabindex="-1"></a><span class="co">#                'Nitrate-N_ppm_N': 'string',</span></span>
<span id="cb45-100"><a href="#cb45-100" aria-hidden="true" tabindex="-1"></a><span class="co">#                        'Lbs_N/A': 'string',</span></span>
<span id="cb45-101"><a href="#cb45-101" aria-hidden="true" tabindex="-1"></a><span class="co">#                'Potassium_ppm_K': 'string',</span></span>
<span id="cb45-102"><a href="#cb45-102" aria-hidden="true" tabindex="-1"></a><span class="co">#                'Sulfate-S_ppm_S': 'string',</span></span>
<span id="cb45-103"><a href="#cb45-103" aria-hidden="true" tabindex="-1"></a><span class="co">#                 'Calcium_ppm_Ca': 'string',</span></span>
<span id="cb45-104"><a href="#cb45-104" aria-hidden="true" tabindex="-1"></a><span class="co">#               'Magnesium_ppm_Mg': 'string',</span></span>
<span id="cb45-105"><a href="#cb45-105" aria-hidden="true" tabindex="-1"></a><span class="co">#                  'Sodium_ppm_Na': 'string',</span></span>
<span id="cb45-106"><a href="#cb45-106" aria-hidden="true" tabindex="-1"></a><span class="co">#     'CEC/Sum_of_cations_me/100g': 'string',</span></span>
<span id="cb45-107"><a href="#cb45-107" aria-hidden="true" tabindex="-1"></a><span class="co">#                         '%H_sat': 'string',</span></span>
<span id="cb45-108"><a href="#cb45-108" aria-hidden="true" tabindex="-1"></a><span class="co">#                         '%K_sat': 'string',</span></span>
<span id="cb45-109"><a href="#cb45-109" aria-hidden="true" tabindex="-1"></a><span class="co">#                        '%Ca_sat': 'string',</span></span>
<span id="cb45-110"><a href="#cb45-110" aria-hidden="true" tabindex="-1"></a><span class="co">#                        '%Mg_sat': 'string',</span></span>
<span id="cb45-111"><a href="#cb45-111" aria-hidden="true" tabindex="-1"></a><span class="co">#                        '%Na_sat': 'string',</span></span>
<span id="cb45-112"><a href="#cb45-112" aria-hidden="true" tabindex="-1"></a><span class="co">#            'Mehlich_P-III_ppm_P': 'string',</span></span>
<span id="cb45-113"><a href="#cb45-113" aria-hidden="true" tabindex="-1"></a><span class="co">#                          '%Sand': 'string',</span></span>
<span id="cb45-114"><a href="#cb45-114" aria-hidden="true" tabindex="-1"></a><span class="co">#                          '%Silt': 'string',</span></span>
<span id="cb45-115"><a href="#cb45-115" aria-hidden="true" tabindex="-1"></a><span class="co">#                          '%Clay': 'string',</span></span>
<span id="cb45-116"><a href="#cb45-116" aria-hidden="true" tabindex="-1"></a><span class="co">#                        'Texture': 'string',</span></span>
<span id="cb45-117"><a href="#cb45-117" aria-hidden="true" tabindex="-1"></a><span class="co">#                       'Comments': 'string',</span></span>
<span id="cb45-118"><a href="#cb45-118" aria-hidden="true" tabindex="-1"></a><span class="co">#                                 #</span></span>
<span id="cb45-119"><a href="#cb45-119" aria-hidden="true" tabindex="-1"></a><span class="co">#               'Imputation_notes': 'string'</span></span>
<span id="cb45-120"><a href="#cb45-120" aria-hidden="true" tabindex="-1"></a><span class="co">#     }</span></span>
<span id="cb45-121"><a href="#cb45-121" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-122"><a href="#cb45-122" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-123"><a href="#cb45-123" aria-hidden="true" tabindex="-1"></a><span class="co"># mgmt_contract = {</span></span>
<span id="cb45-124"><a href="#cb45-124" aria-hidden="true" tabindex="-1"></a><span class="co">#                 'Year': 'int',</span></span>
<span id="cb45-125"><a href="#cb45-125" aria-hidden="true" tabindex="-1"></a><span class="co">#             'Location': 'string', </span></span>
<span id="cb45-126"><a href="#cb45-126" aria-hidden="true" tabindex="-1"></a><span class="co">#                       #</span></span>
<span id="cb45-127"><a href="#cb45-127" aria-hidden="true" tabindex="-1"></a><span class="co">#          'Application': 'string', </span></span>
<span id="cb45-128"><a href="#cb45-128" aria-hidden="true" tabindex="-1"></a><span class="co">#              'Product': 'string', </span></span>
<span id="cb45-129"><a href="#cb45-129" aria-hidden="true" tabindex="-1"></a><span class="co">#                 'Date': 'datetime64[ns]', </span></span>
<span id="cb45-130"><a href="#cb45-130" aria-hidden="true" tabindex="-1"></a><span class="co">#        'Quantity/acre': 'float', </span></span>
<span id="cb45-131"><a href="#cb45-131" aria-hidden="true" tabindex="-1"></a><span class="co">#                 'Unit': 'string', </span></span>
<span id="cb45-132"><a href="#cb45-132" aria-hidden="true" tabindex="-1"></a><span class="co">#                       #</span></span>
<span id="cb45-133"><a href="#cb45-133" aria-hidden="true" tabindex="-1"></a><span class="co">#     'Imputation_notes':'string'</span></span>
<span id="cb45-134"><a href="#cb45-134" aria-hidden="true" tabindex="-1"></a><span class="co">#     }</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb46"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb46-1"><a href="#cb46-1" aria-hidden="true" tabindex="-1"></a><span class="co"># import great_expectations as ge</span></span>
<span id="cb46-2"><a href="#cb46-2" aria-hidden="true" tabindex="-1"></a><span class="co"># context = ge.get_context()</span></span>
<span id="cb46-3"><a href="#cb46-3" aria-hidden="true" tabindex="-1"></a><span class="co"># my_df = ge.from_pandas(dat_2021.mgmt.data)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb47"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb47-1"><a href="#cb47-1" aria-hidden="true" tabindex="-1"></a><span class="co"># my_df.head()</span></span>
<span id="cb47-2"><a href="#cb47-2" aria-hidden="true" tabindex="-1"></a><span class="co"># # my_df.Location.value_counts()</span></span>
<span id="cb47-3"><a href="#cb47-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-4"><a href="#cb47-4" aria-hidden="true" tabindex="-1"></a><span class="co"># # my_df.expect_column_to_exist("Location")</span></span>
<span id="cb47-5"><a href="#cb47-5" aria-hidden="true" tabindex="-1"></a><span class="co"># my_df.Date.expect</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb48"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb48-1"><a href="#cb48-1" aria-hidden="true" tabindex="-1"></a><span class="co"># check_contract()</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb49"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb49-1"><a href="#cb49-1" aria-hidden="true" tabindex="-1"></a><span class="co"># check_contract(dataframe = df, contract = df_contract, enforce = False)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="prepare-and-write-minimally-altered-g2f-database" class="level1">
<h1>Prepare and write minimally altered G2F database</h1>
<div class="cell">
<div class="sourceCode cell-code" id="cb50"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb50-1"><a href="#cb50-1" aria-hidden="true" tabindex="-1"></a><span class="co"># # contract for compataility with dataframes that _precede_ Y, G, W, S ---</span></span>
<span id="cb50-2"><a href="#cb50-2" aria-hidden="true" tabindex="-1"></a><span class="co"># # NOT the most efficient way to get what we want.</span></span>
<span id="cb50-3"><a href="#cb50-3" aria-hidden="true" tabindex="-1"></a><span class="co"># # These are the column names and datatypes we want to enforce to ensure compatability with previous model</span></span>
<span id="cb50-4"><a href="#cb50-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-5"><a href="#cb50-5" aria-hidden="true" tabindex="-1"></a><span class="co"># # metadata</span></span>
<span id="cb50-6"><a href="#cb50-6" aria-hidden="true" tabindex="-1"></a><span class="co"># # &lt;class 'pandas.core.frame.DataFrame'&gt;</span></span>
<span id="cb50-7"><a href="#cb50-7" aria-hidden="true" tabindex="-1"></a><span class="co"># # RangeIndex: 296 entries, 0 to 295</span></span>
<span id="cb50-8"><a href="#cb50-8" aria-hidden="true" tabindex="-1"></a><span class="co"># # Data columns (total 10 columns):</span></span>
<span id="cb50-9"><a href="#cb50-9" aria-hidden="true" tabindex="-1"></a><span class="co"># #  #   Column           Non-Null Count  Dtype  </span></span>
<span id="cb50-10"><a href="#cb50-10" aria-hidden="true" tabindex="-1"></a><span class="co"># # ---  ------           --------------  -----  </span></span>
<span id="cb50-11"><a href="#cb50-11" aria-hidden="true" tabindex="-1"></a><span class="co"># #  0   ExperimentCode   296 non-null    object </span></span>
<span id="cb50-12"><a href="#cb50-12" aria-hidden="true" tabindex="-1"></a><span class="co"># #  1   Year             296 non-null    object </span></span>
<span id="cb50-13"><a href="#cb50-13" aria-hidden="true" tabindex="-1"></a><span class="co"># #  2   PreviousCrop     215 non-null    object </span></span>
<span id="cb50-14"><a href="#cb50-14" aria-hidden="true" tabindex="-1"></a><span class="co"># #  3   PreplantTillage  119 non-null    object </span></span>
<span id="cb50-15"><a href="#cb50-15" aria-hidden="true" tabindex="-1"></a><span class="co"># #  4   InseasonTillage  119 non-null    object </span></span>
<span id="cb50-16"><a href="#cb50-16" aria-hidden="true" tabindex="-1"></a><span class="co"># #  5   MoistureSystem   173 non-null    object </span></span>
<span id="cb50-17"><a href="#cb50-17" aria-hidden="true" tabindex="-1"></a><span class="co"># #  6   MoistureNeeded   173 non-null    object </span></span>
<span id="cb50-18"><a href="#cb50-18" aria-hidden="true" tabindex="-1"></a><span class="co"># #  7   ExpLon           296 non-null    float64</span></span>
<span id="cb50-19"><a href="#cb50-19" aria-hidden="true" tabindex="-1"></a><span class="co"># #  8   ExpLat           296 non-null    float64</span></span>
<span id="cb50-20"><a href="#cb50-20" aria-hidden="true" tabindex="-1"></a><span class="co"># #  9   Location         42 non-null     object </span></span>
<span id="cb50-21"><a href="#cb50-21" aria-hidden="true" tabindex="-1"></a><span class="co"># # dtypes: float64(2), object(8)</span></span>
<span id="cb50-22"><a href="#cb50-22" aria-hidden="true" tabindex="-1"></a><span class="co"># # memory usage: 23.2+ KB</span></span>
<span id="cb50-23"><a href="#cb50-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-24"><a href="#cb50-24" aria-hidden="true" tabindex="-1"></a><span class="co"># meta_contract = {</span></span>
<span id="cb50-25"><a href="#cb50-25" aria-hidden="true" tabindex="-1"></a><span class="co">#     'ExperimentCode': 'O', </span></span>
<span id="cb50-26"><a href="#cb50-26" aria-hidden="true" tabindex="-1"></a><span class="co">#     'Year': 'O', </span></span>
<span id="cb50-27"><a href="#cb50-27" aria-hidden="true" tabindex="-1"></a><span class="co">#     'PreviousCrop': 'O', </span></span>
<span id="cb50-28"><a href="#cb50-28" aria-hidden="true" tabindex="-1"></a><span class="co">#     'PreplantTillage': 'O', </span></span>
<span id="cb50-29"><a href="#cb50-29" aria-hidden="true" tabindex="-1"></a><span class="co">#     'InseasonTillage': 'O', </span></span>
<span id="cb50-30"><a href="#cb50-30" aria-hidden="true" tabindex="-1"></a><span class="co">#     'MoistureSystem': 'O', </span></span>
<span id="cb50-31"><a href="#cb50-31" aria-hidden="true" tabindex="-1"></a><span class="co">#     'MoistureNeeded': 'O', </span></span>
<span id="cb50-32"><a href="#cb50-32" aria-hidden="true" tabindex="-1"></a><span class="co">#     'ExpLon': 'float64', </span></span>
<span id="cb50-33"><a href="#cb50-33" aria-hidden="true" tabindex="-1"></a><span class="co">#     'ExpLat': 'float64', </span></span>
<span id="cb50-34"><a href="#cb50-34" aria-hidden="true" tabindex="-1"></a><span class="co">#     'Location': 'O'</span></span>
<span id="cb50-35"><a href="#cb50-35" aria-hidden="true" tabindex="-1"></a><span class="co"># }</span></span>
<span id="cb50-36"><a href="#cb50-36" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-37"><a href="#cb50-37" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-38"><a href="#cb50-38" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-39"><a href="#cb50-39" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb50-40"><a href="#cb50-40" aria-hidden="true" tabindex="-1"></a><span class="co"># # phenotype</span></span>
<span id="cb50-41"><a href="#cb50-41" aria-hidden="true" tabindex="-1"></a><span class="co"># # &lt;class 'pandas.core.frame.DataFrame'&gt;</span></span>
<span id="cb50-42"><a href="#cb50-42" aria-hidden="true" tabindex="-1"></a><span class="co"># # RangeIndex: 98996 entries, 0 to 98995</span></span>
<span id="cb50-43"><a href="#cb50-43" aria-hidden="true" tabindex="-1"></a><span class="co"># # Data columns (total 19 columns):</span></span>
<span id="cb50-44"><a href="#cb50-44" aria-hidden="true" tabindex="-1"></a><span class="co"># #  #   Column                Non-Null Count  Dtype         </span></span>
<span id="cb50-45"><a href="#cb50-45" aria-hidden="true" tabindex="-1"></a><span class="co"># # ---  ------                --------------  -----         </span></span>
<span id="cb50-46"><a href="#cb50-46" aria-hidden="true" tabindex="-1"></a><span class="co"># #  0   Pedigree              98996 non-null  object        </span></span>
<span id="cb50-47"><a href="#cb50-47" aria-hidden="true" tabindex="-1"></a><span class="co"># #  1   F                     98996 non-null  object        </span></span>
<span id="cb50-48"><a href="#cb50-48" aria-hidden="true" tabindex="-1"></a><span class="co"># #  2   M                     98996 non-null  object        </span></span>
<span id="cb50-49"><a href="#cb50-49" aria-hidden="true" tabindex="-1"></a><span class="co"># #  3   ExperimentCode        98996 non-null  object        </span></span>
<span id="cb50-50"><a href="#cb50-50" aria-hidden="true" tabindex="-1"></a><span class="co"># #  4   Year                  98996 non-null  object        </span></span>
<span id="cb50-51"><a href="#cb50-51" aria-hidden="true" tabindex="-1"></a><span class="co"># #  5   DatePlanted           98996 non-null  datetime64[ns]</span></span>
<span id="cb50-52"><a href="#cb50-52" aria-hidden="true" tabindex="-1"></a><span class="co"># #  6   DateHarvested         98497 non-null  datetime64[ns]</span></span>
<span id="cb50-53"><a href="#cb50-53" aria-hidden="true" tabindex="-1"></a><span class="co"># #  7   DaysToPollen          98996 non-null  object        </span></span>
<span id="cb50-54"><a href="#cb50-54" aria-hidden="true" tabindex="-1"></a><span class="co"># #  8   DaysToSilk            98996 non-null  object        </span></span>
<span id="cb50-55"><a href="#cb50-55" aria-hidden="true" tabindex="-1"></a><span class="co"># #  9   Height                98996 non-null  object        </span></span>
<span id="cb50-56"><a href="#cb50-56" aria-hidden="true" tabindex="-1"></a><span class="co"># #  10  EarHeight             98996 non-null  object        </span></span>
<span id="cb50-57"><a href="#cb50-57" aria-hidden="true" tabindex="-1"></a><span class="co"># #  11  StandCount            98996 non-null  object        </span></span>
<span id="cb50-58"><a href="#cb50-58" aria-hidden="true" tabindex="-1"></a><span class="co"># #  12  RootLodging           98996 non-null  object        </span></span>
<span id="cb50-59"><a href="#cb50-59" aria-hidden="true" tabindex="-1"></a><span class="co"># #  13  StalkLodging          98996 non-null  object        </span></span>
<span id="cb50-60"><a href="#cb50-60" aria-hidden="true" tabindex="-1"></a><span class="co"># #  14  PercentGrainMoisture  98996 non-null  object        </span></span>
<span id="cb50-61"><a href="#cb50-61" aria-hidden="true" tabindex="-1"></a><span class="co"># #  15  TestWeight            98996 non-null  object        </span></span>
<span id="cb50-62"><a href="#cb50-62" aria-hidden="true" tabindex="-1"></a><span class="co"># #  16  PlotWeight            98996 non-null  object        </span></span>
<span id="cb50-63"><a href="#cb50-63" aria-hidden="true" tabindex="-1"></a><span class="co"># #  17  GrainYield            98996 non-null  object        </span></span>
<span id="cb50-64"><a href="#cb50-64" aria-hidden="true" tabindex="-1"></a><span class="co"># #  18  PercentStand          24002 non-null  object        </span></span>
<span id="cb50-65"><a href="#cb50-65" aria-hidden="true" tabindex="-1"></a><span class="co"># # dtypes: datetime64[ns](2), object(17)</span></span>
<span id="cb50-66"><a href="#cb50-66" aria-hidden="true" tabindex="-1"></a><span class="co"># # memory usage: 14.4+ MB</span></span>
<span id="cb50-67"><a href="#cb50-67" aria-hidden="true" tabindex="-1"></a><span class="co"># phno_contract = {'Pedigree': 'O', </span></span>
<span id="cb50-68"><a href="#cb50-68" aria-hidden="true" tabindex="-1"></a><span class="co">#                  'F': 'O', 'M': </span></span>
<span id="cb50-69"><a href="#cb50-69" aria-hidden="true" tabindex="-1"></a><span class="co">#                  'O', </span></span>
<span id="cb50-70"><a href="#cb50-70" aria-hidden="true" tabindex="-1"></a><span class="co">#                  'ExperimentCode': 'O', </span></span>
<span id="cb50-71"><a href="#cb50-71" aria-hidden="true" tabindex="-1"></a><span class="co">#                  'Year': 'O', </span></span>
<span id="cb50-72"><a href="#cb50-72" aria-hidden="true" tabindex="-1"></a><span class="co">#                  'DatePlanted': 'datetime64[ns]', </span></span>
<span id="cb50-73"><a href="#cb50-73" aria-hidden="true" tabindex="-1"></a><span class="co">#                  'DateHarvested': 'datetime64[ns]', </span></span>
<span id="cb50-74"><a href="#cb50-74" aria-hidden="true" tabindex="-1"></a><span class="co">#                  'DaysToPollen': 'O', </span></span>
<span id="cb50-75"><a href="#cb50-75" aria-hidden="true" tabindex="-1"></a><span class="co">#                  'DaysToSilk': 'O', </span></span>
<span id="cb50-76"><a href="#cb50-76" aria-hidden="true" tabindex="-1"></a><span class="co">#                  'Height': 'O', </span></span>
<span id="cb50-77"><a href="#cb50-77" aria-hidden="true" tabindex="-1"></a><span class="co">#                  'EarHeight': 'O', </span></span>
<span id="cb50-78"><a href="#cb50-78" aria-hidden="true" tabindex="-1"></a><span class="co">#                  'StandCount': 'O', </span></span>
<span id="cb50-79"><a href="#cb50-79" aria-hidden="true" tabindex="-1"></a><span class="co">#                  'RootLodging': 'O', </span></span>
<span id="cb50-80"><a href="#cb50-80" aria-hidden="true" tabindex="-1"></a><span class="co">#                  'StalkLodging': 'O', </span></span>
<span id="cb50-81"><a href="#cb50-81" aria-hidden="true" tabindex="-1"></a><span class="co">#                  'PercentGrainMoisture': 'O', </span></span>
<span id="cb50-82"><a href="#cb50-82" aria-hidden="true" tabindex="-1"></a><span class="co">#                  'TestWeight': 'O', </span></span>
<span id="cb50-83"><a href="#cb50-83" aria-hidden="true" tabindex="-1"></a><span class="co">#                  'PlotWeight': 'O', </span></span>
<span id="cb50-84"><a href="#cb50-84" aria-hidden="true" tabindex="-1"></a><span class="co">#                  'GrainYield': 'O', </span></span>
<span id="cb50-85"><a href="#cb50-85" aria-hidden="true" tabindex="-1"></a><span class="co">#                  'PercentStand': 'O'}</span></span>
<span id="cb50-86"><a href="#cb50-86" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-87"><a href="#cb50-87" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-88"><a href="#cb50-88" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-89"><a href="#cb50-89" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-90"><a href="#cb50-90" aria-hidden="true" tabindex="-1"></a><span class="co"># # weather (+ managment)</span></span>
<span id="cb50-91"><a href="#cb50-91" aria-hidden="true" tabindex="-1"></a><span class="co"># # &lt;class 'pandas.core.frame.DataFrame'&gt;</span></span>
<span id="cb50-92"><a href="#cb50-92" aria-hidden="true" tabindex="-1"></a><span class="co"># # RangeIndex: 300191 entries, 0 to 300190</span></span>
<span id="cb50-93"><a href="#cb50-93" aria-hidden="true" tabindex="-1"></a><span class="co"># # Data columns (total 22 columns):</span></span>
<span id="cb50-94"><a href="#cb50-94" aria-hidden="true" tabindex="-1"></a><span class="co"># #  #   Column                Non-Null Count   Dtype         </span></span>
<span id="cb50-95"><a href="#cb50-95" aria-hidden="true" tabindex="-1"></a><span class="co"># # ---  ------                --------------   -----         </span></span>
<span id="cb50-96"><a href="#cb50-96" aria-hidden="true" tabindex="-1"></a><span class="co"># #  0   ExperimentCode        300064 non-null  object        </span></span>
<span id="cb50-97"><a href="#cb50-97" aria-hidden="true" tabindex="-1"></a><span class="co"># #  1   Year                  300191 non-null  object        </span></span>
<span id="cb50-98"><a href="#cb50-98" aria-hidden="true" tabindex="-1"></a><span class="co"># #  2   Date                  300191 non-null  datetime64[ns]</span></span>
<span id="cb50-99"><a href="#cb50-99" aria-hidden="true" tabindex="-1"></a><span class="co"># #  3   N                     300191 non-null  float64       </span></span>
<span id="cb50-100"><a href="#cb50-100" aria-hidden="true" tabindex="-1"></a><span class="co"># #  4   P                     300191 non-null  float64       </span></span>
<span id="cb50-101"><a href="#cb50-101" aria-hidden="true" tabindex="-1"></a><span class="co"># #  5   K                     300191 non-null  float64       </span></span>
<span id="cb50-102"><a href="#cb50-102" aria-hidden="true" tabindex="-1"></a><span class="co"># #  6   TempMin               300191 non-null  float64       </span></span>
<span id="cb50-103"><a href="#cb50-103" aria-hidden="true" tabindex="-1"></a><span class="co"># #  7   TempMean              300191 non-null  float64       </span></span>
<span id="cb50-104"><a href="#cb50-104" aria-hidden="true" tabindex="-1"></a><span class="co"># #  8   TempMax               300191 non-null  float64       </span></span>
<span id="cb50-105"><a href="#cb50-105" aria-hidden="true" tabindex="-1"></a><span class="co"># #  9   DewPointMean          300191 non-null  float64       </span></span>
<span id="cb50-106"><a href="#cb50-106" aria-hidden="true" tabindex="-1"></a><span class="co"># #  10  RelativeHumidityMean  300191 non-null  float64       </span></span>
<span id="cb50-107"><a href="#cb50-107" aria-hidden="true" tabindex="-1"></a><span class="co"># #  11  SolarRadiationMean    300191 non-null  float64       </span></span>
<span id="cb50-108"><a href="#cb50-108" aria-hidden="true" tabindex="-1"></a><span class="co"># #  12  WindSpeedMax          300191 non-null  float64       </span></span>
<span id="cb50-109"><a href="#cb50-109" aria-hidden="true" tabindex="-1"></a><span class="co"># #  13  WindDirectionMean     300191 non-null  float64       </span></span>
<span id="cb50-110"><a href="#cb50-110" aria-hidden="true" tabindex="-1"></a><span class="co"># #  14  WindGustMax           300191 non-null  float64       </span></span>
<span id="cb50-111"><a href="#cb50-111" aria-hidden="true" tabindex="-1"></a><span class="co"># #  15  SoilTempMean          300191 non-null  float64       </span></span>
<span id="cb50-112"><a href="#cb50-112" aria-hidden="true" tabindex="-1"></a><span class="co"># #  16  SoilMoistureMean      300191 non-null  float64       </span></span>
<span id="cb50-113"><a href="#cb50-113" aria-hidden="true" tabindex="-1"></a><span class="co"># #  17  UVLMean               300191 non-null  float64       </span></span>
<span id="cb50-114"><a href="#cb50-114" aria-hidden="true" tabindex="-1"></a><span class="co"># #  18  PARMean               300191 non-null  float64       </span></span>
<span id="cb50-115"><a href="#cb50-115" aria-hidden="true" tabindex="-1"></a><span class="co"># #  19  PhotoperiodMean       300191 non-null  float64       </span></span>
<span id="cb50-116"><a href="#cb50-116" aria-hidden="true" tabindex="-1"></a><span class="co"># #  20  VaporPresEst          300191 non-null  float64       </span></span>
<span id="cb50-117"><a href="#cb50-117" aria-hidden="true" tabindex="-1"></a><span class="co"># #  21  WaterTotalInmm        300191 non-null  float64       </span></span>
<span id="cb50-118"><a href="#cb50-118" aria-hidden="true" tabindex="-1"></a><span class="co"># # dtypes: datetime64[ns](1), float64(19), object(2)</span></span>
<span id="cb50-119"><a href="#cb50-119" aria-hidden="true" tabindex="-1"></a><span class="co"># # memory usage: 50.4+ MB</span></span>
<span id="cb50-120"><a href="#cb50-120" aria-hidden="true" tabindex="-1"></a><span class="co"># wthr_contract = {'ExperimentCode': 'O', </span></span>
<span id="cb50-121"><a href="#cb50-121" aria-hidden="true" tabindex="-1"></a><span class="co">#                  'Year': 'O', </span></span>
<span id="cb50-122"><a href="#cb50-122" aria-hidden="true" tabindex="-1"></a><span class="co">#                  'Date': 'datetime64[ns]', </span></span>
<span id="cb50-123"><a href="#cb50-123" aria-hidden="true" tabindex="-1"></a><span class="co">#                  'N': 'float64', </span></span>
<span id="cb50-124"><a href="#cb50-124" aria-hidden="true" tabindex="-1"></a><span class="co">#                  'P': 'float64', </span></span>
<span id="cb50-125"><a href="#cb50-125" aria-hidden="true" tabindex="-1"></a><span class="co">#                  'K': 'float64', </span></span>
<span id="cb50-126"><a href="#cb50-126" aria-hidden="true" tabindex="-1"></a><span class="co">#                  'TempMin': 'float64', </span></span>
<span id="cb50-127"><a href="#cb50-127" aria-hidden="true" tabindex="-1"></a><span class="co">#                  'TempMean': 'float64', </span></span>
<span id="cb50-128"><a href="#cb50-128" aria-hidden="true" tabindex="-1"></a><span class="co">#                  'TempMax': 'float64', </span></span>
<span id="cb50-129"><a href="#cb50-129" aria-hidden="true" tabindex="-1"></a><span class="co">#                  'DewPointMean': 'float64', </span></span>
<span id="cb50-130"><a href="#cb50-130" aria-hidden="true" tabindex="-1"></a><span class="co">#                  'RelativeHumidityMean': 'float64', </span></span>
<span id="cb50-131"><a href="#cb50-131" aria-hidden="true" tabindex="-1"></a><span class="co">#                  'SolarRadiationMean': 'float64', </span></span>
<span id="cb50-132"><a href="#cb50-132" aria-hidden="true" tabindex="-1"></a><span class="co">#                  'WindSpeedMax': 'float64', </span></span>
<span id="cb50-133"><a href="#cb50-133" aria-hidden="true" tabindex="-1"></a><span class="co">#                  'WindDirectionMean': 'float64', </span></span>
<span id="cb50-134"><a href="#cb50-134" aria-hidden="true" tabindex="-1"></a><span class="co">#                  'WindGustMax': 'float64', </span></span>
<span id="cb50-135"><a href="#cb50-135" aria-hidden="true" tabindex="-1"></a><span class="co">#                  'SoilTempMean': 'float64', </span></span>
<span id="cb50-136"><a href="#cb50-136" aria-hidden="true" tabindex="-1"></a><span class="co">#                  'SoilMoistureMean': 'float64', </span></span>
<span id="cb50-137"><a href="#cb50-137" aria-hidden="true" tabindex="-1"></a><span class="co">#                  'UVLMean': 'float64', </span></span>
<span id="cb50-138"><a href="#cb50-138" aria-hidden="true" tabindex="-1"></a><span class="co">#                  'PARMean': 'float64', </span></span>
<span id="cb50-139"><a href="#cb50-139" aria-hidden="true" tabindex="-1"></a><span class="co">#                  'PhotoperiodMean': 'float64', </span></span>
<span id="cb50-140"><a href="#cb50-140" aria-hidden="true" tabindex="-1"></a><span class="co">#                  'VaporPresEst': 'float64', </span></span>
<span id="cb50-141"><a href="#cb50-141" aria-hidden="true" tabindex="-1"></a><span class="co">#                  'WaterTotalInmm': 'float64'}</span></span>
<span id="cb50-142"><a href="#cb50-142" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-143"><a href="#cb50-143" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-144"><a href="#cb50-144" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-145"><a href="#cb50-145" aria-hidden="true" tabindex="-1"></a><span class="co"># # soil</span></span>
<span id="cb50-146"><a href="#cb50-146" aria-hidden="true" tabindex="-1"></a><span class="co"># # &lt;class 'pandas.core.frame.DataFrame'&gt;</span></span>
<span id="cb50-147"><a href="#cb50-147" aria-hidden="true" tabindex="-1"></a><span class="co"># # RangeIndex: 274 entries, 0 to 273</span></span>
<span id="cb50-148"><a href="#cb50-148" aria-hidden="true" tabindex="-1"></a><span class="co"># # Data columns (total 23 columns):</span></span>
<span id="cb50-149"><a href="#cb50-149" aria-hidden="true" tabindex="-1"></a><span class="co"># #  #   Column                  Non-Null Count  Dtype  </span></span>
<span id="cb50-150"><a href="#cb50-150" aria-hidden="true" tabindex="-1"></a><span class="co"># # ---  ------                  --------------  -----  </span></span>
<span id="cb50-151"><a href="#cb50-151" aria-hidden="true" tabindex="-1"></a><span class="co"># #  0   ExperimentCode          274 non-null    object </span></span>
<span id="cb50-152"><a href="#cb50-152" aria-hidden="true" tabindex="-1"></a><span class="co"># #  1   Year                    274 non-null    object </span></span>
<span id="cb50-153"><a href="#cb50-153" aria-hidden="true" tabindex="-1"></a><span class="co"># #  2   SoilpH                  274 non-null    float64</span></span>
<span id="cb50-154"><a href="#cb50-154" aria-hidden="true" tabindex="-1"></a><span class="co"># #  3   WDRFpH                  274 non-null    float64</span></span>
<span id="cb50-155"><a href="#cb50-155" aria-hidden="true" tabindex="-1"></a><span class="co"># #  4   SSalts                  274 non-null    float64</span></span>
<span id="cb50-156"><a href="#cb50-156" aria-hidden="true" tabindex="-1"></a><span class="co"># #  5   PercentOrganic          274 non-null    float64</span></span>
<span id="cb50-157"><a href="#cb50-157" aria-hidden="true" tabindex="-1"></a><span class="co"># #  6   ppmNitrateN             274 non-null    float64</span></span>
<span id="cb50-158"><a href="#cb50-158" aria-hidden="true" tabindex="-1"></a><span class="co"># #  7   NitrogenPerAcre         274 non-null    float64</span></span>
<span id="cb50-159"><a href="#cb50-159" aria-hidden="true" tabindex="-1"></a><span class="co"># #  8   ppmK                    274 non-null    float64</span></span>
<span id="cb50-160"><a href="#cb50-160" aria-hidden="true" tabindex="-1"></a><span class="co"># #  9   ppmSulfateS             274 non-null    float64</span></span>
<span id="cb50-161"><a href="#cb50-161" aria-hidden="true" tabindex="-1"></a><span class="co"># #  10  ppmCa                   274 non-null    float64</span></span>
<span id="cb50-162"><a href="#cb50-162" aria-hidden="true" tabindex="-1"></a><span class="co"># #  11  ppmMg                   274 non-null    float64</span></span>
<span id="cb50-163"><a href="#cb50-163" aria-hidden="true" tabindex="-1"></a><span class="co"># #  12  ppmNa                   274 non-null    float64</span></span>
<span id="cb50-164"><a href="#cb50-164" aria-hidden="true" tabindex="-1"></a><span class="co"># #  13  CationExchangeCapacity  274 non-null    float64</span></span>
<span id="cb50-165"><a href="#cb50-165" aria-hidden="true" tabindex="-1"></a><span class="co"># #  14  PercentH                274 non-null    float64</span></span>
<span id="cb50-166"><a href="#cb50-166" aria-hidden="true" tabindex="-1"></a><span class="co"># #  15  PercentK                274 non-null    float64</span></span>
<span id="cb50-167"><a href="#cb50-167" aria-hidden="true" tabindex="-1"></a><span class="co"># #  16  PercentCa               274 non-null    float64</span></span>
<span id="cb50-168"><a href="#cb50-168" aria-hidden="true" tabindex="-1"></a><span class="co"># #  17  PercentMg               274 non-null    float64</span></span>
<span id="cb50-169"><a href="#cb50-169" aria-hidden="true" tabindex="-1"></a><span class="co"># #  18  PercentNa               274 non-null    float64</span></span>
<span id="cb50-170"><a href="#cb50-170" aria-hidden="true" tabindex="-1"></a><span class="co"># #  19  ppmP                    274 non-null    float64</span></span>
<span id="cb50-171"><a href="#cb50-171" aria-hidden="true" tabindex="-1"></a><span class="co"># #  20  PercentSand             274 non-null    float64</span></span>
<span id="cb50-172"><a href="#cb50-172" aria-hidden="true" tabindex="-1"></a><span class="co"># #  21  PercentSilt             274 non-null    float64</span></span>
<span id="cb50-173"><a href="#cb50-173" aria-hidden="true" tabindex="-1"></a><span class="co"># #  22  PercentClay             274 non-null    float64</span></span>
<span id="cb50-174"><a href="#cb50-174" aria-hidden="true" tabindex="-1"></a><span class="co"># # dtypes: float64(21), object(2)</span></span>
<span id="cb50-175"><a href="#cb50-175" aria-hidden="true" tabindex="-1"></a><span class="co"># # memory usage: 49.4+ KB</span></span>
<span id="cb50-176"><a href="#cb50-176" aria-hidden="true" tabindex="-1"></a><span class="co"># soil_contract = {'ExperimentCode': 'O', </span></span>
<span id="cb50-177"><a href="#cb50-177" aria-hidden="true" tabindex="-1"></a><span class="co">#                  'Year': 'O', </span></span>
<span id="cb50-178"><a href="#cb50-178" aria-hidden="true" tabindex="-1"></a><span class="co">#                  'SoilpH': 'float64', </span></span>
<span id="cb50-179"><a href="#cb50-179" aria-hidden="true" tabindex="-1"></a><span class="co">#                  'WDRFpH': 'float64', </span></span>
<span id="cb50-180"><a href="#cb50-180" aria-hidden="true" tabindex="-1"></a><span class="co">#                  'SSalts': 'float64', </span></span>
<span id="cb50-181"><a href="#cb50-181" aria-hidden="true" tabindex="-1"></a><span class="co">#                  'PercentOrganic': 'float64', </span></span>
<span id="cb50-182"><a href="#cb50-182" aria-hidden="true" tabindex="-1"></a><span class="co">#                  'ppmNitrateN': 'float64', </span></span>
<span id="cb50-183"><a href="#cb50-183" aria-hidden="true" tabindex="-1"></a><span class="co">#                  'NitrogenPerAcre': 'float64', </span></span>
<span id="cb50-184"><a href="#cb50-184" aria-hidden="true" tabindex="-1"></a><span class="co">#                  'ppmK': 'float64', </span></span>
<span id="cb50-185"><a href="#cb50-185" aria-hidden="true" tabindex="-1"></a><span class="co">#                  'ppmSulfateS': 'float64', </span></span>
<span id="cb50-186"><a href="#cb50-186" aria-hidden="true" tabindex="-1"></a><span class="co">#                  'ppmCa': 'float64', </span></span>
<span id="cb50-187"><a href="#cb50-187" aria-hidden="true" tabindex="-1"></a><span class="co">#                  'ppmMg': 'float64', </span></span>
<span id="cb50-188"><a href="#cb50-188" aria-hidden="true" tabindex="-1"></a><span class="co">#                  'ppmNa': 'float64', </span></span>
<span id="cb50-189"><a href="#cb50-189" aria-hidden="true" tabindex="-1"></a><span class="co">#                  'CationExchangeCapacity': 'float64', </span></span>
<span id="cb50-190"><a href="#cb50-190" aria-hidden="true" tabindex="-1"></a><span class="co">#                  'PercentH': 'float64', </span></span>
<span id="cb50-191"><a href="#cb50-191" aria-hidden="true" tabindex="-1"></a><span class="co">#                  'PercentK': 'float64', </span></span>
<span id="cb50-192"><a href="#cb50-192" aria-hidden="true" tabindex="-1"></a><span class="co">#                  'PercentCa': 'float64', </span></span>
<span id="cb50-193"><a href="#cb50-193" aria-hidden="true" tabindex="-1"></a><span class="co">#                  'PercentMg': 'float64', </span></span>
<span id="cb50-194"><a href="#cb50-194" aria-hidden="true" tabindex="-1"></a><span class="co">#                  'PercentNa': 'float64', </span></span>
<span id="cb50-195"><a href="#cb50-195" aria-hidden="true" tabindex="-1"></a><span class="co">#                  'ppmP': 'float64', </span></span>
<span id="cb50-196"><a href="#cb50-196" aria-hidden="true" tabindex="-1"></a><span class="co">#                  'PercentSand': 'float64', </span></span>
<span id="cb50-197"><a href="#cb50-197" aria-hidden="true" tabindex="-1"></a><span class="co">#                  'PercentSilt': 'float64', </span></span>
<span id="cb50-198"><a href="#cb50-198" aria-hidden="true" tabindex="-1"></a><span class="co">#                  'PercentClay': 'float64'}</span></span>
<span id="cb50-199"><a href="#cb50-199" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-200"><a href="#cb50-200" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-201"><a href="#cb50-201" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-202"><a href="#cb50-202" aria-hidden="true" tabindex="-1"></a><span class="co"># # phenotypeGBS</span></span>
<span id="cb50-203"><a href="#cb50-203" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-204"><a href="#cb50-204" aria-hidden="true" tabindex="-1"></a><span class="co"># def check_contract(dataframe, contract, enforce = False):</span></span>
<span id="cb50-205"><a href="#cb50-205" aria-hidden="true" tabindex="-1"></a><span class="co">#     """</span></span>
<span id="cb50-206"><a href="#cb50-206" aria-hidden="true" tabindex="-1"></a><span class="co">#     This function will check a dataframe for agreement with a contract.</span></span>
<span id="cb50-207"><a href="#cb50-207" aria-hidden="true" tabindex="-1"></a><span class="co">#     To pass it must contain all the columns specified and they must be of the right data type</span></span>
<span id="cb50-208"><a href="#cb50-208" aria-hidden="true" tabindex="-1"></a><span class="co">#     If `enforce = True` then a dataframe containing only the columns in the contract will be returned (if it passed)</span></span>
<span id="cb50-209"><a href="#cb50-209" aria-hidden="true" tabindex="-1"></a><span class="co">#     """</span></span>
<span id="cb50-210"><a href="#cb50-210" aria-hidden="true" tabindex="-1"></a><span class="co">#     contract_passed = True</span></span>
<span id="cb50-211"><a href="#cb50-211" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb50-212"><a href="#cb50-212" aria-hidden="true" tabindex="-1"></a><span class="co">#     # Get information on contract</span></span>
<span id="cb50-213"><a href="#cb50-213" aria-hidden="true" tabindex="-1"></a><span class="co">#     contract_df =  pd.DataFrame(</span></span>
<span id="cb50-214"><a href="#cb50-214" aria-hidden="true" tabindex="-1"></a><span class="co">#         zip(contract.keys(), </span></span>
<span id="cb50-215"><a href="#cb50-215" aria-hidden="true" tabindex="-1"></a><span class="co">#             [True if e in dataframe.columns else False for e in contract.keys()],</span></span>
<span id="cb50-216"><a href="#cb50-216" aria-hidden="true" tabindex="-1"></a><span class="co">#             contract.values()           </span></span>
<span id="cb50-217"><a href="#cb50-217" aria-hidden="true" tabindex="-1"></a><span class="co">#            ), </span></span>
<span id="cb50-218"><a href="#cb50-218" aria-hidden="true" tabindex="-1"></a><span class="co">#         columns= ["Contract", </span></span>
<span id="cb50-219"><a href="#cb50-219" aria-hidden="true" tabindex="-1"></a><span class="co">#                   "DataFrame",</span></span>
<span id="cb50-220"><a href="#cb50-220" aria-hidden="true" tabindex="-1"></a><span class="co">#                   "dtype"])</span></span>
<span id="cb50-221"><a href="#cb50-221" aria-hidden="true" tabindex="-1"></a><span class="co">#     # Check contract compliance</span></span>
<span id="cb50-222"><a href="#cb50-222" aria-hidden="true" tabindex="-1"></a><span class="co">#     contract_df.loc[:, "ColType"] = ""</span></span>
<span id="cb50-223"><a href="#cb50-223" aria-hidden="true" tabindex="-1"></a><span class="co">#     contract_df.loc[:, "dtypeMatch"] = False</span></span>
<span id="cb50-224"><a href="#cb50-224" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb50-225"><a href="#cb50-225" aria-hidden="true" tabindex="-1"></a><span class="co">#     # This is an inefficient way to do this but it should be okay for this purpose</span></span>
<span id="cb50-226"><a href="#cb50-226" aria-hidden="true" tabindex="-1"></a><span class="co">#     check_cols = contract_df.loc[contract_df.DataFrame, 'Contract']</span></span>
<span id="cb50-227"><a href="#cb50-227" aria-hidden="true" tabindex="-1"></a><span class="co">#     for check in check_cols:</span></span>
<span id="cb50-228"><a href="#cb50-228" aria-hidden="true" tabindex="-1"></a><span class="co">#         val = dataframe.loc[:, check].dtype</span></span>
<span id="cb50-229"><a href="#cb50-229" aria-hidden="true" tabindex="-1"></a><span class="co">#         contract_df.loc[contract_df.Contract == check, 'ColType'] = val</span></span>
<span id="cb50-230"><a href="#cb50-230" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb50-231"><a href="#cb50-231" aria-hidden="true" tabindex="-1"></a><span class="co">#     contract_df.loc[contract_df.dtype == contract_df.ColType, "dtypeMatch"] = True</span></span>
<span id="cb50-232"><a href="#cb50-232" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb50-233"><a href="#cb50-233" aria-hidden="true" tabindex="-1"></a><span class="co">#     # Calculate contract compliance stats</span></span>
<span id="cb50-234"><a href="#cb50-234" aria-hidden="true" tabindex="-1"></a><span class="co">#     passing_percent = float(sum(contract_df.dtypeMatch)/(contract_df.shape[0]))</span></span>
<span id="cb50-235"><a href="#cb50-235" aria-hidden="true" tabindex="-1"></a><span class="co">#     passing_status = (passing_percent == 1.0)</span></span>
<span id="cb50-236"><a href="#cb50-236" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb50-237"><a href="#cb50-237" aria-hidden="true" tabindex="-1"></a><span class="co">#     if passing_status:</span></span>
<span id="cb50-238"><a href="#cb50-238" aria-hidden="true" tabindex="-1"></a><span class="co">#         contract_passed = True</span></span>
<span id="cb50-239"><a href="#cb50-239" aria-hidden="true" tabindex="-1"></a><span class="co">#         print("Passed contract comparison")</span></span>
<span id="cb50-240"><a href="#cb50-240" aria-hidden="true" tabindex="-1"></a><span class="co">#         if not contract_passed:</span></span>
<span id="cb50-241"><a href="#cb50-241" aria-hidden="true" tabindex="-1"></a><span class="co">#             return(contract_df)</span></span>
<span id="cb50-242"><a href="#cb50-242" aria-hidden="true" tabindex="-1"></a><span class="co">#         else:</span></span>
<span id="cb50-243"><a href="#cb50-243" aria-hidden="true" tabindex="-1"></a><span class="co">#             if not enforce:</span></span>
<span id="cb50-244"><a href="#cb50-244" aria-hidden="true" tabindex="-1"></a><span class="co">#                 print("Return dataframe with contract enforced by passing `enforce = True`")</span></span>
<span id="cb50-245"><a href="#cb50-245" aria-hidden="true" tabindex="-1"></a><span class="co">#             else:</span></span>
<span id="cb50-246"><a href="#cb50-246" aria-hidden="true" tabindex="-1"></a><span class="co">#                 return(dataframe.loc[:, list(contract.keys())])</span></span>
<span id="cb50-247"><a href="#cb50-247" aria-hidden="true" tabindex="-1"></a><span class="co">#     else:</span></span>
<span id="cb50-248"><a href="#cb50-248" aria-hidden="true" tabindex="-1"></a><span class="co">#         print(str(sum(contract_df.DataFrame))+"/"+str(contract_df.shape[0])+" Columns match.")</span></span>
<span id="cb50-249"><a href="#cb50-249" aria-hidden="true" tabindex="-1"></a><span class="co">#         print(str(sum(contract_df.dtypeMatch))+"/"+str(contract_df.shape[0])+" Types match.") </span></span>
<span id="cb50-250"><a href="#cb50-250" aria-hidden="true" tabindex="-1"></a><span class="co">#         return(contract_df)</span></span>
<span id="cb50-251"><a href="#cb50-251" aria-hidden="true" tabindex="-1"></a><span class="co">#     #TODO allow for enforcing contract</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb51"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb51-1"><a href="#cb51-1" aria-hidden="true" tabindex="-1"></a><span class="co"># meta = dat_2021.meta.data</span></span>
<span id="cb51-2"><a href="#cb51-2" aria-hidden="true" tabindex="-1"></a><span class="co"># phno = dat_2021.phno.data</span></span>
<span id="cb51-3"><a href="#cb51-3" aria-hidden="true" tabindex="-1"></a><span class="co"># wthr = dat_2021.wthr.data</span></span>
<span id="cb51-4"><a href="#cb51-4" aria-hidden="true" tabindex="-1"></a><span class="co"># soil = dat_2021.soil.data</span></span>
<span id="cb51-5"><a href="#cb51-5" aria-hidden="true" tabindex="-1"></a><span class="co"># mgmt = dat_2021.mgmt.data</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb52"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb52-1"><a href="#cb52-1" aria-hidden="true" tabindex="-1"></a><span class="co"># dat_2021.rename_id_cols("meta")</span></span>
<span id="cb52-2"><a href="#cb52-2" aria-hidden="true" tabindex="-1"></a><span class="co"># dat_2021.rename_id_cols("phno")</span></span>
<span id="cb52-3"><a href="#cb52-3" aria-hidden="true" tabindex="-1"></a><span class="co"># dat_2021.rename_id_cols("wthr")</span></span>
<span id="cb52-4"><a href="#cb52-4" aria-hidden="true" tabindex="-1"></a><span class="co"># dat_2021.rename_id_cols("soil")</span></span>
<span id="cb52-5"><a href="#cb52-5" aria-hidden="true" tabindex="-1"></a><span class="co"># dat_2021.rename_id_cols("mgmt")</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb53"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb53-1"><a href="#cb53-1" aria-hidden="true" tabindex="-1"></a><span class="co"># dat_2020.ready_csvs()</span></span>
<span id="cb53-2"><a href="#cb53-2" aria-hidden="true" tabindex="-1"></a><span class="co"># dat_2020.transform_all_names()</span></span>
<span id="cb53-3"><a href="#cb53-3" aria-hidden="true" tabindex="-1"></a><span class="co"># dat_2020.transform_all_names_check()</span></span>
<span id="cb53-4"><a href="#cb53-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-5"><a href="#cb53-5" aria-hidden="true" tabindex="-1"></a><span class="co">#weather</span></span>
<span id="cb53-6"><a href="#cb53-6" aria-hidden="true" tabindex="-1"></a><span class="co"># 'CO2_[ppm]'</span></span>
<span id="cb53-7"><a href="#cb53-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-8"><a href="#cb53-8" aria-hidden="true" tabindex="-1"></a><span class="co"># dat_2019.ready_csvs()</span></span>
<span id="cb53-9"><a href="#cb53-9" aria-hidden="true" tabindex="-1"></a><span class="co"># dat_2019.transform_all_names()</span></span>
<span id="cb53-10"><a href="#cb53-10" aria-hidden="true" tabindex="-1"></a><span class="co"># dat_2019.transform_all_names_check()</span></span>
<span id="cb53-11"><a href="#cb53-11" aria-hidden="true" tabindex="-1"></a><span class="co">#phno </span></span>
<span id="cb53-12"><a href="#cb53-12" aria-hidden="true" tabindex="-1"></a><span class="co"># ['Kernels/Packet', "Filler_[enter_'filler'_or_blank]", 'Possible_subs', 'Confirmed_subs', 'Single_plant_biomass_in_july(g)', 'Single_plant_biomass_in_august(g)', 'RootPullingForce(kgf)_july', 'RootPullingForce(kgf)_august']</span></span>
<span id="cb53-13"><a href="#cb53-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-14"><a href="#cb53-14" aria-hidden="true" tabindex="-1"></a><span class="co"># </span><span class="al">TODO</span><span class="co"> check other years</span></span>
<span id="cb53-15"><a href="#cb53-15" aria-hidden="true" tabindex="-1"></a><span class="co"># dat_2018.ready_csvs()</span></span>
<span id="cb53-16"><a href="#cb53-16" aria-hidden="true" tabindex="-1"></a><span class="co"># dat_2018.transform_all_names()</span></span>
<span id="cb53-17"><a href="#cb53-17" aria-hidden="true" tabindex="-1"></a><span class="co"># dat_2018.transform_all_names_check()</span></span>
<span id="cb53-18"><a href="#cb53-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-19"><a href="#cb53-19" aria-hidden="true" tabindex="-1"></a><span class="co"># dat_2017.ready_csvs()</span></span>
<span id="cb53-20"><a href="#cb53-20" aria-hidden="true" tabindex="-1"></a><span class="co"># dat_2017.transform_all_names()</span></span>
<span id="cb53-21"><a href="#cb53-21" aria-hidden="true" tabindex="-1"></a><span class="co"># dat_2017.transform_all_names_check()</span></span>
<span id="cb53-22"><a href="#cb53-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-23"><a href="#cb53-23" aria-hidden="true" tabindex="-1"></a><span class="co"># dat_2016.ready_csvs()</span></span>
<span id="cb53-24"><a href="#cb53-24" aria-hidden="true" tabindex="-1"></a><span class="co"># dat_2016.transform_all_names()</span></span>
<span id="cb53-25"><a href="#cb53-25" aria-hidden="true" tabindex="-1"></a><span class="co"># dat_2016.transform_all_names_check()</span></span>
<span id="cb53-26"><a href="#cb53-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-27"><a href="#cb53-27" aria-hidden="true" tabindex="-1"></a><span class="co"># dat_2015.ready_csvs()</span></span>
<span id="cb53-28"><a href="#cb53-28" aria-hidden="true" tabindex="-1"></a><span class="co"># dat_2015.transform_all_names()</span></span>
<span id="cb53-29"><a href="#cb53-29" aria-hidden="true" tabindex="-1"></a><span class="co"># dat_2015.transform_all_names_check()</span></span>
<span id="cb53-30"><a href="#cb53-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-31"><a href="#cb53-31" aria-hidden="true" tabindex="-1"></a><span class="co"># dat_2014.ready_csvs()</span></span>
<span id="cb53-32"><a href="#cb53-32" aria-hidden="true" tabindex="-1"></a><span class="co"># dat_2014.transform_all_names()</span></span>
<span id="cb53-33"><a href="#cb53-33" aria-hidden="true" tabindex="-1"></a><span class="co"># dat_2014.transform_all_names_check()</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb54"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb54-1"><a href="#cb54-1" aria-hidden="true" tabindex="-1"></a><span class="co"># mgmt.rename({</span></span>
<span id="cb54-2"><a href="#cb54-2" aria-hidden="true" tabindex="-1"></a><span class="co">#     #'Location': '', </span></span>
<span id="cb54-3"><a href="#cb54-3" aria-hidden="true" tabindex="-1"></a><span class="co">#     'Application_or_treatment': 'Application', </span></span>
<span id="cb54-4"><a href="#cb54-4" aria-hidden="true" tabindex="-1"></a><span class="co">#     'Product_or_nutrient_applied': 'Product',  </span></span>
<span id="cb54-5"><a href="#cb54-5" aria-hidden="true" tabindex="-1"></a><span class="co">#     'Date_of_application': 'Date', </span></span>
<span id="cb54-6"><a href="#cb54-6" aria-hidden="true" tabindex="-1"></a><span class="co">#     'Quantity_per_acre': 'Quantity/acre', </span></span>
<span id="cb54-7"><a href="#cb54-7" aria-hidden="true" tabindex="-1"></a><span class="co">#     'Application_unit': 'Unit'</span></span>
<span id="cb54-8"><a href="#cb54-8" aria-hidden="true" tabindex="-1"></a><span class="co"># })</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb55"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb55-1"><a href="#cb55-1" aria-hidden="true" tabindex="-1"></a><span class="co"># dat_2021.soil.data.head(1)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb56"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb56-1"><a href="#cb56-1" aria-hidden="true" tabindex="-1"></a><span class="co"># # focus on one year and get that organized</span></span>
<span id="cb56-2"><a href="#cb56-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-3"><a href="#cb56-3" aria-hidden="true" tabindex="-1"></a><span class="co"># # todo add as method in the class</span></span>
<span id="cb56-4"><a href="#cb56-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-5"><a href="#cb56-5" aria-hidden="true" tabindex="-1"></a><span class="co"># dat_2021.meta.data.rename(columns=dict(zip(</span></span>
<span id="cb56-6"><a href="#cb56-6" aria-hidden="true" tabindex="-1"></a><span class="co">#     list(dat_2021.meta.data.columns),</span></span>
<span id="cb56-7"><a href="#cb56-7" aria-hidden="true" tabindex="-1"></a><span class="co">#     transform_name(input = list(dat_2021.meta.data.columns)))))</span></span>
<span id="cb56-8"><a href="#cb56-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-9"><a href="#cb56-9" aria-hidden="true" tabindex="-1"></a><span class="co"># dat_2021.soil.data.rename(columns=dict(zip(</span></span>
<span id="cb56-10"><a href="#cb56-10" aria-hidden="true" tabindex="-1"></a><span class="co">#     list(dat_2021.soil.data.columns),</span></span>
<span id="cb56-11"><a href="#cb56-11" aria-hidden="true" tabindex="-1"></a><span class="co">#     transform_name(input = list(dat_2021.soil.data.columns)))))</span></span>
<span id="cb56-12"><a href="#cb56-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-13"><a href="#cb56-13" aria-hidden="true" tabindex="-1"></a><span class="co"># dat_2021.soil.data.rename(columns=dict(zip(</span></span>
<span id="cb56-14"><a href="#cb56-14" aria-hidden="true" tabindex="-1"></a><span class="co">#     list(dat_2021.soil.data.columns),</span></span>
<span id="cb56-15"><a href="#cb56-15" aria-hidden="true" tabindex="-1"></a><span class="co">#     transform_name(input = list(dat_2021.soil.data.columns)))))</span></span>
<span id="cb56-16"><a href="#cb56-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-17"><a href="#cb56-17" aria-hidden="true" tabindex="-1"></a><span class="co"># dat_2021.soil.data.rename(columns=dict(zip(</span></span>
<span id="cb56-18"><a href="#cb56-18" aria-hidden="true" tabindex="-1"></a><span class="co">#     list(dat_2021.soil.data.columns),</span></span>
<span id="cb56-19"><a href="#cb56-19" aria-hidden="true" tabindex="-1"></a><span class="co">#     transform_name(input = list(dat_2021.soil.data.columns)))))</span></span>
<span id="cb56-20"><a href="#cb56-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-21"><a href="#cb56-21" aria-hidden="true" tabindex="-1"></a><span class="co"># dat_2021.soil.data.rename(columns=dict(zip(</span></span>
<span id="cb56-22"><a href="#cb56-22" aria-hidden="true" tabindex="-1"></a><span class="co">#     list(dat_2021.soil.data.columns),</span></span>
<span id="cb56-23"><a href="#cb56-23" aria-hidden="true" tabindex="-1"></a><span class="co">#     transform_name(input = list(dat_2021.soil.data.columns)))))</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb57"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb57-1"><a href="#cb57-1" aria-hidden="true" tabindex="-1"></a><span class="co"># # Keep it simple: </span></span>
<span id="cb57-2"><a href="#cb57-2" aria-hidden="true" tabindex="-1"></a><span class="co"># # Start by getting the minimum data that we want from 2021 in the past format.</span></span>
<span id="cb57-3"><a href="#cb57-3" aria-hidden="true" tabindex="-1"></a><span class="co"># # After we can use these minimum columns, think about expanding to other columns</span></span>
<span id="cb57-4"><a href="#cb57-4" aria-hidden="true" tabindex="-1"></a><span class="co"># meta = dat_2021.meta.data</span></span>
<span id="cb57-5"><a href="#cb57-5" aria-hidden="true" tabindex="-1"></a><span class="co"># phno = dat_2021.phno.data</span></span>
<span id="cb57-6"><a href="#cb57-6" aria-hidden="true" tabindex="-1"></a><span class="co"># wthr = dat_2021.wthr.data</span></span>
<span id="cb57-7"><a href="#cb57-7" aria-hidden="true" tabindex="-1"></a><span class="co"># soil = dat_2021.soil.data</span></span>
<span id="cb57-8"><a href="#cb57-8" aria-hidden="true" tabindex="-1"></a><span class="co"># mgmt = dat_2021.mgmt.data</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb58"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb58-1"><a href="#cb58-1" aria-hidden="true" tabindex="-1"></a><span class="co"># # meta</span></span>
<span id="cb58-2"><a href="#cb58-2" aria-hidden="true" tabindex="-1"></a><span class="co"># df = meta</span></span>
<span id="cb58-3"><a href="#cb58-3" aria-hidden="true" tabindex="-1"></a><span class="co"># df_contract = meta_contract</span></span>
<span id="cb58-4"><a href="#cb58-4" aria-hidden="true" tabindex="-1"></a><span class="co"># cols_from_to_dict = {</span></span>
<span id="cb58-5"><a href="#cb58-5" aria-hidden="true" tabindex="-1"></a><span class="co">#     # From                                                        To</span></span>
<span id="cb58-6"><a href="#cb58-6" aria-hidden="true" tabindex="-1"></a><span class="co">#     'Location':                                                   'ExperimentCode',</span></span>
<span id="cb58-7"><a href="#cb58-7" aria-hidden="true" tabindex="-1"></a><span class="co">#     'Previous_crop':                                              'PreviousCrop',</span></span>
<span id="cb58-8"><a href="#cb58-8" aria-hidden="true" tabindex="-1"></a><span class="co">#     'Pre-plant_tillage_method(s)':                                'PreplantTillage',</span></span>
<span id="cb58-9"><a href="#cb58-9" aria-hidden="true" tabindex="-1"></a><span class="co">#     'In-season_tillage_method(s)':                                'InseasonTillage',</span></span>
<span id="cb58-10"><a href="#cb58-10" aria-hidden="true" tabindex="-1"></a><span class="co">#     'System_determining_moisture':                                'MoistureSystem',</span></span>
<span id="cb58-11"><a href="#cb58-11" aria-hidden="true" tabindex="-1"></a><span class="co">#     'Pounds_needed_soil_moisture':                                'MoistureNeeded',</span></span>
<span id="cb58-12"><a href="#cb58-12" aria-hidden="true" tabindex="-1"></a><span class="co">#     'Longitude_of_field_corner_#1_(lower_left)':                  'ExpLon', #FIXME</span></span>
<span id="cb58-13"><a href="#cb58-13" aria-hidden="true" tabindex="-1"></a><span class="co">#     'Latitude_of_field_corner_#1_(lower_left)':                   'ExpLat', #FIXME</span></span>
<span id="cb58-14"><a href="#cb58-14" aria-hidden="true" tabindex="-1"></a><span class="co">#     'Trial_ID_(Assigned_by_collaborator_for_internal_reference)': 'Location' #Confirm</span></span>
<span id="cb58-15"><a href="#cb58-15" aria-hidden="true" tabindex="-1"></a><span class="co">#                            }</span></span>
<span id="cb58-16"><a href="#cb58-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-17"><a href="#cb58-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-18"><a href="#cb58-18" aria-hidden="true" tabindex="-1"></a><span class="co"># # phno</span></span>
<span id="cb58-19"><a href="#cb58-19" aria-hidden="true" tabindex="-1"></a><span class="co"># df = phno</span></span>
<span id="cb58-20"><a href="#cb58-20" aria-hidden="true" tabindex="-1"></a><span class="co"># df_contract = phno_contract</span></span>
<span id="cb58-21"><a href="#cb58-21" aria-hidden="true" tabindex="-1"></a><span class="co"># cols_from_to_dict = {</span></span>
<span id="cb58-22"><a href="#cb58-22" aria-hidden="true" tabindex="-1"></a><span class="co">#     # From                                                        To</span></span>
<span id="cb58-23"><a href="#cb58-23" aria-hidden="true" tabindex="-1"></a><span class="co"># #     'XXXXXXXXX': 'Pedigree', </span></span>
<span id="cb58-24"><a href="#cb58-24" aria-hidden="true" tabindex="-1"></a><span class="co">#     'XXXXXXXXX': 'F', </span></span>
<span id="cb58-25"><a href="#cb58-25" aria-hidden="true" tabindex="-1"></a><span class="co">#     'XXXXXXXXX': 'M', </span></span>
<span id="cb58-26"><a href="#cb58-26" aria-hidden="true" tabindex="-1"></a><span class="co">#     'XXXXXXXXX': 'ExperimentCode', </span></span>
<span id="cb58-27"><a href="#cb58-27" aria-hidden="true" tabindex="-1"></a><span class="co"># #     'XXXXXXXXX': 'Year', </span></span>
<span id="cb58-28"><a href="#cb58-28" aria-hidden="true" tabindex="-1"></a><span class="co">#     'Date_plot_planted_[MM/DD/YY]': 'DatePlanted', </span></span>
<span id="cb58-29"><a href="#cb58-29" aria-hidden="true" tabindex="-1"></a><span class="co">#     'Date_plot_harvested_[MM/DD/YY]': 'DateHarvested', </span></span>
<span id="cb58-30"><a href="#cb58-30" aria-hidden="true" tabindex="-1"></a><span class="co">#     'Anthesis_[days]': 'DaysToPollen', </span></span>
<span id="cb58-31"><a href="#cb58-31" aria-hidden="true" tabindex="-1"></a><span class="co">#     'Silking_[days]': 'DaysToSilk', </span></span>
<span id="cb58-32"><a href="#cb58-32" aria-hidden="true" tabindex="-1"></a><span class="co">#     'Plant_height_[cm]': 'Height', </span></span>
<span id="cb58-33"><a href="#cb58-33" aria-hidden="true" tabindex="-1"></a><span class="co">#     'Ear_height_[cm]': 'EarHeight', </span></span>
<span id="cb58-34"><a href="#cb58-34" aria-hidden="true" tabindex="-1"></a><span class="co">#     'Stand_count_[#_of_plants]': 'StandCount', </span></span>
<span id="cb58-35"><a href="#cb58-35" aria-hidden="true" tabindex="-1"></a><span class="co">#     'Root_lodging_[#_of_plants]': 'RootLodging', </span></span>
<span id="cb58-36"><a href="#cb58-36" aria-hidden="true" tabindex="-1"></a><span class="co">#     'Stalk_lodging_[#_of_plants]': 'StalkLodging', </span></span>
<span id="cb58-37"><a href="#cb58-37" aria-hidden="true" tabindex="-1"></a><span class="co">#     'Grain_moisture_[%]': 'PercentGrainMoisture', </span></span>
<span id="cb58-38"><a href="#cb58-38" aria-hidden="true" tabindex="-1"></a><span class="co">#     'Test_weight_[lbs]': 'TestWeight', </span></span>
<span id="cb58-39"><a href="#cb58-39" aria-hidden="true" tabindex="-1"></a><span class="co">#     'Plot_weight_[lbs]': 'PlotWeight', </span></span>
<span id="cb58-40"><a href="#cb58-40" aria-hidden="true" tabindex="-1"></a><span class="co">#     'Grain_yield_(bu/A)': 'GrainYield', </span></span>
<span id="cb58-41"><a href="#cb58-41" aria-hidden="true" tabindex="-1"></a><span class="co">#     'XXXXXXXXX': 'PercentStand'</span></span>
<span id="cb58-42"><a href="#cb58-42" aria-hidden="true" tabindex="-1"></a><span class="co">#                            }</span></span>
<span id="cb58-43"><a href="#cb58-43" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-44"><a href="#cb58-44" aria-hidden="true" tabindex="-1"></a><span class="co"># ['Year',</span></span>
<span id="cb58-45"><a href="#cb58-45" aria-hidden="true" tabindex="-1"></a><span class="co">#  'Location',</span></span>
<span id="cb58-46"><a href="#cb58-46" aria-hidden="true" tabindex="-1"></a><span class="co">#  'State',</span></span>
<span id="cb58-47"><a href="#cb58-47" aria-hidden="true" tabindex="-1"></a><span class="co">#  'City',</span></span>
<span id="cb58-48"><a href="#cb58-48" aria-hidden="true" tabindex="-1"></a><span class="co">#  'Plot_length_(center-center_in_feet)',</span></span>
<span id="cb58-49"><a href="#cb58-49" aria-hidden="true" tabindex="-1"></a><span class="co">#  'Plot_area_(ft2)',</span></span>
<span id="cb58-50"><a href="#cb58-50" aria-hidden="true" tabindex="-1"></a><span class="co">#  'Alley_length_(in_inches)',</span></span>
<span id="cb58-51"><a href="#cb58-51" aria-hidden="true" tabindex="-1"></a><span class="co">#  'Row_spacing_(in_inches)',</span></span>
<span id="cb58-52"><a href="#cb58-52" aria-hidden="true" tabindex="-1"></a><span class="co">#  'Rows_per_plot',</span></span>
<span id="cb58-53"><a href="#cb58-53" aria-hidden="true" tabindex="-1"></a><span class="co">#  '#_seed_per_plot',</span></span>
<span id="cb58-54"><a href="#cb58-54" aria-hidden="true" tabindex="-1"></a><span class="co">#  'Experiment',</span></span>
<span id="cb58-55"><a href="#cb58-55" aria-hidden="true" tabindex="-1"></a><span class="co">#  'Source',</span></span>
<span id="cb58-56"><a href="#cb58-56" aria-hidden="true" tabindex="-1"></a><span class="co">#  'Pedigree',</span></span>
<span id="cb58-57"><a href="#cb58-57" aria-hidden="true" tabindex="-1"></a><span class="co">#  'Family',</span></span>
<span id="cb58-58"><a href="#cb58-58" aria-hidden="true" tabindex="-1"></a><span class="co">#  'Tester',</span></span>
<span id="cb58-59"><a href="#cb58-59" aria-hidden="true" tabindex="-1"></a><span class="co">#  'Replication',</span></span>
<span id="cb58-60"><a href="#cb58-60" aria-hidden="true" tabindex="-1"></a><span class="co">#  'Block',</span></span>
<span id="cb58-61"><a href="#cb58-61" aria-hidden="true" tabindex="-1"></a><span class="co">#  'Plot',</span></span>
<span id="cb58-62"><a href="#cb58-62" aria-hidden="true" tabindex="-1"></a><span class="co">#  'Plot_ID',</span></span>
<span id="cb58-63"><a href="#cb58-63" aria-hidden="true" tabindex="-1"></a><span class="co">#  'Range',</span></span>
<span id="cb58-64"><a href="#cb58-64" aria-hidden="true" tabindex="-1"></a><span class="co">#  'Pass',</span></span>
<span id="cb58-65"><a href="#cb58-65" aria-hidden="true" tabindex="-1"></a><span class="co">#  '',</span></span>
<span id="cb58-66"><a href="#cb58-66" aria-hidden="true" tabindex="-1"></a><span class="co">#  '',</span></span>
<span id="cb58-67"><a href="#cb58-67" aria-hidden="true" tabindex="-1"></a><span class="co">#  'Anthesis_[MM/DD/YY]',</span></span>
<span id="cb58-68"><a href="#cb58-68" aria-hidden="true" tabindex="-1"></a><span class="co">#  'Silking_[MM/DD/YY]',</span></span>
<span id="cb58-69"><a href="#cb58-69" aria-hidden="true" tabindex="-1"></a><span class="co">#  '',</span></span>
<span id="cb58-70"><a href="#cb58-70" aria-hidden="true" tabindex="-1"></a><span class="co">#  '',</span></span>
<span id="cb58-71"><a href="#cb58-71" aria-hidden="true" tabindex="-1"></a><span class="co">#  '',</span></span>
<span id="cb58-72"><a href="#cb58-72" aria-hidden="true" tabindex="-1"></a><span class="co">#  '',</span></span>
<span id="cb58-73"><a href="#cb58-73" aria-hidden="true" tabindex="-1"></a><span class="co">#  '',</span></span>
<span id="cb58-74"><a href="#cb58-74" aria-hidden="true" tabindex="-1"></a><span class="co">#  '',</span></span>
<span id="cb58-75"><a href="#cb58-75" aria-hidden="true" tabindex="-1"></a><span class="co">#  '',</span></span>
<span id="cb58-76"><a href="#cb58-76" aria-hidden="true" tabindex="-1"></a><span class="co">#  '',</span></span>
<span id="cb58-77"><a href="#cb58-77" aria-hidden="true" tabindex="-1"></a><span class="co">#  '',</span></span>
<span id="cb58-78"><a href="#cb58-78" aria-hidden="true" tabindex="-1"></a><span class="co">#  '',</span></span>
<span id="cb58-79"><a href="#cb58-79" aria-hidden="true" tabindex="-1"></a><span class="co">#  '',</span></span>
<span id="cb58-80"><a href="#cb58-80" aria-hidden="true" tabindex="-1"></a><span class="co">#  "Plot_discarded_[enter_'yes'_or_blank]",</span></span>
<span id="cb58-81"><a href="#cb58-81" aria-hidden="true" tabindex="-1"></a><span class="co">#  'Comments',</span></span>
<span id="cb58-82"><a href="#cb58-82" aria-hidden="true" tabindex="-1"></a><span class="co">#  'Filler',</span></span>
<span id="cb58-83"><a href="#cb58-83" aria-hidden="true" tabindex="-1"></a><span class="co">#  'Snap_[#_of_plants]']</span></span>
<span id="cb58-84"><a href="#cb58-84" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-85"><a href="#cb58-85" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-86"><a href="#cb58-86" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-87"><a href="#cb58-87" aria-hidden="true" tabindex="-1"></a><span class="co"># # soil</span></span>
<span id="cb58-88"><a href="#cb58-88" aria-hidden="true" tabindex="-1"></a><span class="co"># # df = phno</span></span>
<span id="cb58-89"><a href="#cb58-89" aria-hidden="true" tabindex="-1"></a><span class="co"># # df_contract = soil_contract</span></span>
<span id="cb58-90"><a href="#cb58-90" aria-hidden="true" tabindex="-1"></a><span class="co"># # cols_from_to_dict = {</span></span>
<span id="cb58-91"><a href="#cb58-91" aria-hidden="true" tabindex="-1"></a><span class="co"># #                            }</span></span>
<span id="cb58-92"><a href="#cb58-92" aria-hidden="true" tabindex="-1"></a><span class="co"># # wthr # mgmt</span></span>
<span id="cb58-93"><a href="#cb58-93" aria-hidden="true" tabindex="-1"></a><span class="co"># # df = phno</span></span>
<span id="cb58-94"><a href="#cb58-94" aria-hidden="true" tabindex="-1"></a><span class="co"># # df_contract = wthr_contract</span></span>
<span id="cb58-95"><a href="#cb58-95" aria-hidden="true" tabindex="-1"></a><span class="co"># # cols_from_to_dict = {</span></span>
<span id="cb58-96"><a href="#cb58-96" aria-hidden="true" tabindex="-1"></a><span class="co"># #                            }</span></span>
<span id="cb58-97"><a href="#cb58-97" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-98"><a href="#cb58-98" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-99"><a href="#cb58-99" aria-hidden="true" tabindex="-1"></a><span class="co"># # pull columns that are needed from different datasets</span></span>
<span id="cb58-100"><a href="#cb58-100" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-101"><a href="#cb58-101" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-102"><a href="#cb58-102" aria-hidden="true" tabindex="-1"></a><span class="co"># # set the names</span></span>
<span id="cb58-103"><a href="#cb58-103" aria-hidden="true" tabindex="-1"></a><span class="co"># df = df.rename(columns=cols_from_to_dict)</span></span>
<span id="cb58-104"><a href="#cb58-104" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-105"><a href="#cb58-105" aria-hidden="true" tabindex="-1"></a><span class="co"># # use the contract to update the dtypes</span></span>
<span id="cb58-106"><a href="#cb58-106" aria-hidden="true" tabindex="-1"></a><span class="co"># for key in df_contract.keys():</span></span>
<span id="cb58-107"><a href="#cb58-107" aria-hidden="true" tabindex="-1"></a><span class="co">#     if key in list(df.columns):</span></span>
<span id="cb58-108"><a href="#cb58-108" aria-hidden="true" tabindex="-1"></a><span class="co">#         df.loc[:, key] = df.loc[:, key].astype(df_contract[key])</span></span>
<span id="cb58-109"><a href="#cb58-109" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-110"><a href="#cb58-110" aria-hidden="true" tabindex="-1"></a><span class="co"># list(df.columns)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb59"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb59-1"><a href="#cb59-1" aria-hidden="true" tabindex="-1"></a><span class="co"># check_contract(dataframe = df, contract = df_contract, enforce = False)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb60"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb60-1"><a href="#cb60-1" aria-hidden="true" tabindex="-1"></a><span class="co"># check_contract(dataframe = meta, contract = meta_contract, enforce = True)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb61"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb61-1"><a href="#cb61-1" aria-hidden="true" tabindex="-1"></a><span class="co"># def quick_df(lst, nom): return pd.DataFrame(zip([nom for i in range(len(lst))], lst), columns = ['Source', 'Column'])</span></span>
<span id="cb61-2"><a href="#cb61-2" aria-hidden="true" tabindex="-1"></a><span class="co"># meta_2021</span></span>
<span id="cb61-3"><a href="#cb61-3" aria-hidden="true" tabindex="-1"></a><span class="co"># phno_2021</span></span>
<span id="cb61-4"><a href="#cb61-4" aria-hidden="true" tabindex="-1"></a><span class="co"># wthr_2021</span></span>
<span id="cb61-5"><a href="#cb61-5" aria-hidden="true" tabindex="-1"></a><span class="co"># soil_2021</span></span>
<span id="cb61-6"><a href="#cb61-6" aria-hidden="true" tabindex="-1"></a><span class="co"># mgmt_2021</span></span>
<span id="cb61-7"><a href="#cb61-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-8"><a href="#cb61-8" aria-hidden="true" tabindex="-1"></a><span class="co"># quick_df(lst = meta_2021, nom = 'meta')</span></span>
<span id="cb61-9"><a href="#cb61-9" aria-hidden="true" tabindex="-1"></a><span class="co"># # quick_df(lst = phno_2021, nom = 'phno')</span></span>
<span id="cb61-10"><a href="#cb61-10" aria-hidden="true" tabindex="-1"></a><span class="co"># # quick_df(lst = wthr_2021, nom = 'wthr')</span></span>
<span id="cb61-11"><a href="#cb61-11" aria-hidden="true" tabindex="-1"></a><span class="co"># # quick_df(lst = soil_2021, nom = 'soil')</span></span>
<span id="cb61-12"><a href="#cb61-12" aria-hidden="true" tabindex="-1"></a><span class="co"># # quick_df(lst = mgmt_2021, nom = 'mgmt')</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb62"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb62-1"><a href="#cb62-1" aria-hidden="true" tabindex="-1"></a><span class="co"># cols_meta = [list(e.meta.data.columns) for e in dat_sets]</span></span>
<span id="cb62-2"><a href="#cb62-2" aria-hidden="true" tabindex="-1"></a><span class="co"># cols_phno = [list(e.phno.data.columns) for e in dat_sets]</span></span>
<span id="cb62-3"><a href="#cb62-3" aria-hidden="true" tabindex="-1"></a><span class="co"># cols_wthr = [list(e.wthr.data.columns) for e in dat_sets]</span></span>
<span id="cb62-4"><a href="#cb62-4" aria-hidden="true" tabindex="-1"></a><span class="co"># cols_soil = [list(e.soil.data.columns) if type(e.soil.data) != type(None) else list() for e in dat_sets]</span></span>
<span id="cb62-5"><a href="#cb62-5" aria-hidden="true" tabindex="-1"></a><span class="co"># cols_mgmt = [list(e.mgmt.data.columns) if type(e.mgmt.data) != type(None) else list() for e in dat_sets]</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb63"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb63-1"><a href="#cb63-1" aria-hidden="true" tabindex="-1"></a><span class="co"># # get list of list with years for one of the above column name lists</span></span>
<span id="cb63-2"><a href="#cb63-2" aria-hidden="true" tabindex="-1"></a><span class="co"># def get_year_lol(l = cols_mgmt):</span></span>
<span id="cb63-3"><a href="#cb63-3" aria-hidden="true" tabindex="-1"></a><span class="co">#     lol = [[[2014, 2015, 2016, 2017, 2018, 2019, 2020, 2021][j] for i in range(len(l[j]))] for j in range(len(l))]</span></span>
<span id="cb63-4"><a href="#cb63-4" aria-hidden="true" tabindex="-1"></a><span class="co">#     return(lol)</span></span>
<span id="cb63-5"><a href="#cb63-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-6"><a href="#cb63-6" aria-hidden="true" tabindex="-1"></a><span class="co"># def flatten_lol(lol): return [item for listWithin in lol for item in listWithin]</span></span>
<span id="cb63-7"><a href="#cb63-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-8"><a href="#cb63-8" aria-hidden="true" tabindex="-1"></a><span class="co"># def cols_list_to_df(in_cols_lol = cols_soil,</span></span>
<span id="cb63-9"><a href="#cb63-9" aria-hidden="true" tabindex="-1"></a><span class="co">#                     data_type = 'soil'):</span></span>
<span id="cb63-10"><a href="#cb63-10" aria-hidden="true" tabindex="-1"></a><span class="co">#     year_list = flatten_lol(get_year_lol(in_cols_lol))</span></span>
<span id="cb63-11"><a href="#cb63-11" aria-hidden="true" tabindex="-1"></a><span class="co">#     cols_list = flatten_lol(in_cols_lol)</span></span>
<span id="cb63-12"><a href="#cb63-12" aria-hidden="true" tabindex="-1"></a><span class="co">#     name_list = [data_type for e in cols_list]</span></span>
<span id="cb63-13"><a href="#cb63-13" aria-hidden="true" tabindex="-1"></a><span class="co">#     dat = pd.DataFrame(</span></span>
<span id="cb63-14"><a href="#cb63-14" aria-hidden="true" tabindex="-1"></a><span class="co">#         zip(name_list,</span></span>
<span id="cb63-15"><a href="#cb63-15" aria-hidden="true" tabindex="-1"></a><span class="co">#             year_list,</span></span>
<span id="cb63-16"><a href="#cb63-16" aria-hidden="true" tabindex="-1"></a><span class="co">#             cols_list</span></span>
<span id="cb63-17"><a href="#cb63-17" aria-hidden="true" tabindex="-1"></a><span class="co">#            ),</span></span>
<span id="cb63-18"><a href="#cb63-18" aria-hidden="true" tabindex="-1"></a><span class="co">#         columns=["Type", "Year", "Col"]</span></span>
<span id="cb63-19"><a href="#cb63-19" aria-hidden="true" tabindex="-1"></a><span class="co">#     )</span></span>
<span id="cb63-20"><a href="#cb63-20" aria-hidden="true" tabindex="-1"></a><span class="co">#     return dat</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb64"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb64-1"><a href="#cb64-1" aria-hidden="true" tabindex="-1"></a><span class="co"># # pd.DataFrame({year : list(dat_obj.soil.data.columns)})</span></span>
<span id="cb64-2"><a href="#cb64-2" aria-hidden="true" tabindex="-1"></a><span class="co"># dat_obj = dat_2021</span></span>
<span id="cb64-3"><a href="#cb64-3" aria-hidden="true" tabindex="-1"></a><span class="co"># year = "2021"</span></span>
<span id="cb64-4"><a href="#cb64-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-5"><a href="#cb64-5" aria-hidden="true" tabindex="-1"></a><span class="co"># list(dat_obj.soil.data.columns)</span></span>
<span id="cb64-6"><a href="#cb64-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-7"><a href="#cb64-7" aria-hidden="true" tabindex="-1"></a><span class="co"># active_attr = dat_obj._get_active_attr()</span></span>
<span id="cb64-8"><a href="#cb64-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-9"><a href="#cb64-9" aria-hidden="true" tabindex="-1"></a><span class="co"># #findme was working on collecting all the columns so they can be easily compared</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb65"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb65-1"><a href="#cb65-1" aria-hidden="true" tabindex="-1"></a><span class="co"># dat = cols_list_to_df(in_cols_lol = cols_soil, data_type = 'soil')</span></span>
<span id="cb65-2"><a href="#cb65-2" aria-hidden="true" tabindex="-1"></a><span class="co"># # out of the box correspondance</span></span>
<span id="cb65-3"><a href="#cb65-3" aria-hidden="true" tabindex="-1"></a><span class="co"># # dat.pivot(index='Col', columns='Year')</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb66"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb66-1"><a href="#cb66-1" aria-hidden="true" tabindex="-1"></a><span class="co"># making Y</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb67"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb67-1"><a href="#cb67-1" aria-hidden="true" tabindex="-1"></a><span class="co"># # making W</span></span>
<span id="cb67-2"><a href="#cb67-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-3"><a href="#cb67-3" aria-hidden="true" tabindex="-1"></a><span class="co"># # filter down input datasets</span></span>
<span id="cb67-4"><a href="#cb67-4" aria-hidden="true" tabindex="-1"></a><span class="co"># wthr.loc[:, [</span></span>
<span id="cb67-5"><a href="#cb67-5" aria-hidden="true" tabindex="-1"></a><span class="co">#     'Location', 'Date_Time', </span></span>
<span id="cb67-6"><a href="#cb67-6" aria-hidden="true" tabindex="-1"></a><span class="co">#     #NPK,</span></span>
<span id="cb67-7"><a href="#cb67-7" aria-hidden="true" tabindex="-1"></a><span class="co">#     # Temp MIN/mean/max</span></span>
<span id="cb67-8"><a href="#cb67-8" aria-hidden="true" tabindex="-1"></a><span class="co">#     'Temperature_[C]', </span></span>
<span id="cb67-9"><a href="#cb67-9" aria-hidden="true" tabindex="-1"></a><span class="co">#     'Dew_point_[C]',</span></span>
<span id="cb67-10"><a href="#cb67-10" aria-hidden="true" tabindex="-1"></a><span class="co">#     'Relative_humidity_[%]', </span></span>
<span id="cb67-11"><a href="#cb67-11" aria-hidden="true" tabindex="-1"></a><span class="co">#     'Solar_radiation_[W/m2]', </span></span>
<span id="cb67-12"><a href="#cb67-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-13"><a href="#cb67-13" aria-hidden="true" tabindex="-1"></a><span class="co">#     'Rainfall_[mm]',</span></span>
<span id="cb67-14"><a href="#cb67-14" aria-hidden="true" tabindex="-1"></a><span class="co">#     'Wind_speed_[m/s]', 'Wind_direction_[degrees]', 'Wind_gust_[m/s]',</span></span>
<span id="cb67-15"><a href="#cb67-15" aria-hidden="true" tabindex="-1"></a><span class="co">#     #temp mean</span></span>
<span id="cb67-16"><a href="#cb67-16" aria-hidden="true" tabindex="-1"></a><span class="co">#     'Soil_temperature_[C]', 'Soil_moisture_[%VWC]', </span></span>
<span id="cb67-17"><a href="#cb67-17" aria-hidden="true" tabindex="-1"></a><span class="co">#     #'Soil_eC_[mS/cm]',</span></span>
<span id="cb67-18"><a href="#cb67-18" aria-hidden="true" tabindex="-1"></a><span class="co">#     'UV_light_[uM/m2s]', </span></span>
<span id="cb67-19"><a href="#cb67-19" aria-hidden="true" tabindex="-1"></a><span class="co">#     'PAR_[uM/m2s]'</span></span>
<span id="cb67-20"><a href="#cb67-20" aria-hidden="true" tabindex="-1"></a><span class="co">#     # other</span></span>
<span id="cb67-21"><a href="#cb67-21" aria-hidden="true" tabindex="-1"></a><span class="co">#             ]]</span></span>
<span id="cb67-22"><a href="#cb67-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-23"><a href="#cb67-23" aria-hidden="true" tabindex="-1"></a><span class="co"># #TODO DAYMET</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb68"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb68-1"><a href="#cb68-1" aria-hidden="true" tabindex="-1"></a><span class="co"># # update names ----</span></span>
<span id="cb68-2"><a href="#cb68-2" aria-hidden="true" tabindex="-1"></a><span class="co"># dat_2018.rename_all_columns(</span></span>
<span id="cb68-3"><a href="#cb68-3" aria-hidden="true" tabindex="-1"></a><span class="co">#     colNamePath='./data/manual/UpdateColNames.csv',</span></span>
<span id="cb68-4"><a href="#cb68-4" aria-hidden="true" tabindex="-1"></a><span class="co">#     logfileName='2018_meta')</span></span>
<span id="cb68-5"><a href="#cb68-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-6"><a href="#cb68-6" aria-hidden="true" tabindex="-1"></a><span class="co"># # regroup columns ----</span></span>
<span id="cb68-7"><a href="#cb68-7" aria-hidden="true" tabindex="-1"></a><span class="co"># # for 2016 and on</span></span>
<span id="cb68-8"><a href="#cb68-8" aria-hidden="true" tabindex="-1"></a><span class="co"># out = dat_2018.sort_cols_in_dfs(colGroupingsPath = './data/manual/UpdateColGroupings.csv')</span></span>
<span id="cb68-9"><a href="#cb68-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-10"><a href="#cb68-10" aria-hidden="true" tabindex="-1"></a><span class="co"># # </span><span class="al">TODO</span></span>
<span id="cb68-11"><a href="#cb68-11" aria-hidden="true" tabindex="-1"></a><span class="co"># # for 2014, 2015 this df should be used</span></span>
<span id="cb68-12"><a href="#cb68-12" aria-hidden="true" tabindex="-1"></a><span class="co"># # pd.read_csv(data_adapter_path+'../data/external/UpdateColGroupings.csv').drop(columns = ['Genotype', 'GenotypeType'])</span></span>
<span id="cb68-13"><a href="#cb68-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-14"><a href="#cb68-14" aria-hidden="true" tabindex="-1"></a><span class="co"># # Try to fix experiment codes --</span></span>
<span id="cb68-15"><a href="#cb68-15" aria-hidden="true" tabindex="-1"></a><span class="co"># for dfKey in list(out.keys()):</span></span>
<span id="cb68-16"><a href="#cb68-16" aria-hidden="true" tabindex="-1"></a><span class="co">#     df = out[dfKey]</span></span>
<span id="cb68-17"><a href="#cb68-17" aria-hidden="true" tabindex="-1"></a><span class="co">#     if 'ExperimentCode' in list(df):</span></span>
<span id="cb68-18"><a href="#cb68-18" aria-hidden="true" tabindex="-1"></a><span class="co">#         for key in list(replaceExperimentCodes.keys()):</span></span>
<span id="cb68-19"><a href="#cb68-19" aria-hidden="true" tabindex="-1"></a><span class="co">#             df.loc[df.ExperimentCode == key, 'ExperimentCode'] = replaceExperimentCodes[key]</span></span>
<span id="cb68-20"><a href="#cb68-20" aria-hidden="true" tabindex="-1"></a><span class="co">#     out[dfKey] = df</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb69"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb69-1"><a href="#cb69-1" aria-hidden="true" tabindex="-1"></a><span class="co">#TODO I was working on converting prep_data() below to be method</span></span>
<span id="cb69-2"><a href="#cb69-2" aria-hidden="true" tabindex="-1"></a><span class="co">#I had just gotten to "# separate to make these easier to work with ----"</span></span>
<span id="cb69-3"><a href="#cb69-3" aria-hidden="true" tabindex="-1"></a><span class="co">#After checking the previous cell sould be merged into the class too.</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>


</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    target: function(trigger) {
      return trigger.previousElementSibling;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    setTimeout(function() {
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const cites = ref.parentNode.getAttribute('data-cites').split(' ');
    tippyHover(ref, function() {
      var popup = window.document.createElement('div');
      cites.forEach(function(cite) {
        var citeDiv = window.document.createElement('div');
        citeDiv.classList.add('hanging-indent');
        citeDiv.classList.add('csl-entry');
        var biblioDiv = window.document.getElementById('ref-' + cite);
        if (biblioDiv) {
          citeDiv.innerHTML = biblioDiv.innerHTML;
        }
        popup.appendChild(citeDiv);
      });
      return popup.innerHTML;
    });
  }
});
</script>
</div> <!-- /content -->



</body></html>